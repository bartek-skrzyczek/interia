!function(a,b,c,d){"Inpl"in a||(a.Inpl={}),"widgets"in a.Inpl||(a.Inpl.widgets={}),Inpl.widgets.manager=new function(){var e,f=!1,g=null,h="http",i={};i.CookieExpiry=172800,i.IntervalRequest=300,i.IntervalCookie=30,i.FirstRequest=5,i.maxCount4refresh=10,i.LastRequestTime=!1,i.LastValue=0,i.AutoRefresh=!1,i.UpdateTitle=!1,i.showIncentive=!1,i.Title=null;var j={};j.widgetUlClass="widgets",j.widgetClass="widget",j.widgetOffClass="widgetOff",j.widgetOnClass="widgetOn",j.iconContainerClass="widgetIconContainer",j.iconClass="widgetIcon",j.closeClass="widgetClose",j.headlineClass="widgetHeadline",j.contentClass="widgetContent",j.iframeClass="widgetIframe",j.linksClass="widgetLinks",j.configUriQueryParams=["serviceUrl","scheme","id","name","shortName","description","width","height","windowHeight","eventsName","author","authorEmail","authorHref"];var k={};k.position={baseTop:32,frameAdditionalOffset:36,bottomAdditionalOffset:30,iconOffset:53};var l,m={},n=null,o=!1,p=(c.browser.msie&&parseInt(c.browser.version,10),function(){x(y),q.initialTitle=b.title,l=c("<div />"),c(b).bind("widgetShow",function(a,b){S(b)}),c(b).bind("widgetRegister",function(a,b){z(b)}),c("body").click(function(){T()})}),q={dingCounterValue:null,dingCounterDisplay:null,initialTitle:null},r=function(){q.dingCounterValue=0,q.dingCounterDisplay=null},s=function(a,b,d,e){var f=a.find("."+j.widgetUlClass);0===f.length&&(f=c('<ul class="'+j.widgetUlClass+'"></ul>').appendTo(a));var g,h="",i="",k="";h+=j.widgetClass,h+=d.advertisement?" adv":"",i+=j.iconClass,i+=d.customIconClass?" "+d.customIconClass:"",k+=d.advertisement?"background-image: url('"+d.icon+"'); ":"",g=c('<li id="'+d.id+'"><div class="'+h+" "+j.widgetOffClass+'"><div class="'+j.iconContainerClass+'"><a class="'+i+'" style="'+k+'" href="'+d.authorHref+'" target="_blank"></a></div></div></li>'),g.appendTo(f),g.click(function(a){a.stopPropagation()}),z({url:b,config:d,links:e,configUriQuery:B(d)})},t=function(a,b){var c=Inpl.Ad.get(b);if(c){if(!(c.url&&/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?\//.test(c.url)&&c.config.icon&&c.config.authorHref&&c.config.id))return;c.config.advertisement=!0,s(a,c.url,c.config,c.links||null)}},u=function(b,d,e,f){configUriQuery=B(e),g=e.originDomain,h=e.scheme;var i,k="",l="",m="",n="";k+=j.widgetClass,k+=e.advertisement?" adv":"",l+=j.iconClass,l+=e.customIconClass?" "+e.customIconClass:"",m+=e.customIconClass?" "+e.customIconClass:"",n+=e.advertisement?"background-image: url('"+e.icon+"'); ":"",i=c('<div class="'+k+" "+j.widgetOffClass+'"><div class="'+j.iconContainerClass+'"></div></div>'),b.contents().length>1&&(b.contents().remove().each(function(a){c(this).addClass(l).attr("style",(c(this).attr("style")?c(this).attr("style")+" ":"")+n).appendTo(i.find("."+j.iconContainerClass))}),b.addClass(m).attr("id",e.id),i.appendTo(b),b.click(function(a){a.stopPropagation()}),z({url:d,config:e,links:f,configUriQuery:configUriQuery})),a.addEventListener&&a.addEventListener("message",v,!1)},v=function(a){g=(h?h:"http")+"://"+g.replace(/http(s)?|:|%3A|\%2F\%2F|\/\//gi,""),a&&"object"==typeof a&&a.origin===g&&(e=JSON.parse(a.data),e.height&&W(e.id,e.height))},w={observers:{any:[]},addObserver:function(a,b){b=b||"any",void 0===w.observers[b]&&(w.observers[b]=[]),w.observers[b].push(a)},notify:function(a,b){w.walkObservers("notify",a,b)},removeObserver:function(a,b){w.walkObservers("removeObserver",a,b)},walkObservers:function(a,b,c){var d,e=c||"any",f=w.observers[e],g=f.length;for(d=0;d<g;d+=1)"notify"===a?f[d](b):f[d]===b&&f.splice(d,1)}},x=function(a){var b;for(b in w)w.hasOwnProperty(b)&&"function"==typeof w[b]&&(a[b]=w[b]);a.observers={any:[]}},y={setValue:function(a){w.notify(a)}},z=function(a){var e=null;a.config.content&&a.config.content.src&&(e=a.url+a.config.content.src);var f;a.config.count&&a.config.count.absoluteUri?f=a.config.count.absoluteUri:a.config.count&&(f=a.url+a.config.count.uri),m[a.config.id]={url:a.url,iframeSrc:e,countUrl:a.config.count===d?null:f,instantiated:!1,config:a.config,links:a.links,configUriQuery:a.configUriQuery,mock:a.config.mock===d?{enabled:!1}:a.config.mock},A(a.config.id),a.config.count!==d&&("function"==typeof a.config.count.whetherCountRequestFn?a.config.count.whetherCountRequestFn()&&("Ding"===a.config.shortName?(a.config.count&&a.config.count.showIncentive===!0&&(i.showIncentive=!0),a.config.count&&a.config.count.autoRefresh===!0&&(i.AutoRefresh=!0),a.config.count&&a.config.count.updateTitle===!0&&(Inpl.widgets.manager.addDingObserver(M),i.UpdateTitle=!0),D(a.config.id)):C(a.config.id)):C(a.config.id)),a.config.eventsName&&c(b).bind(a.config.eventsName,function(a,b){switch(b.action){case"widgetClose":T();break;case"widgetIframeHeight":W(b.id,b.height)}})},A=function(a){var b=c("#"+a);b.delegate("."+j.iconClass,"click",function(a){var b=c(this).parents("."+j.widgetClass).parent().attr("id");m[b].config.standaloneIcon||(a.stopPropagation(),a.preventDefault(),R(b))}),b.delegate("."+j.closeClass,"click",function(b){m[a].config.gemiusClickCloseWidget!==d&&"function"==typeof gemius_hit&&gemius_hit(m[a].config.gemiusClickCloseWidget),b.stopPropagation(),b.preventDefault(),T()})},B=function(a){var b,c,d=[];for(b=0,c=j.configUriQueryParams.length;b<c;b++)a[j.configUriQueryParams[b]]&&d.push(encodeURIComponent(j.configUriQueryParams[b])+"="+encodeURIComponent(a[j.configUriQueryParams[b]]));return d.join("&")},C=function(a,b,d){var e=(Math.round((new Date).getTime()/1e3),m[a]);c.ajax({type:"GET",url:e.countUrl,dataType:"jsonp",jsonpCallback:e.config.count.jsonpCallback,success:function(b){b&&(c("#"+a).addClass("active"),K(a,b.data,d))},error:function(){c("#"+a).removeClass("active")}})},D=function(a){i.FirstRequest<i.IntervalCookie&&i.IntervalCookie<i.IntervalRequest&&i.IntervalRequest<i.CookieExpiry?(G("Counter Configuration OK"),E(a)):G("Ding Counter Configuration corrupted - see documentation ")},E=function(a){if(G("getDingCounter("+a+")"),G(i),Inpl.Auid.dingHasSubscribtion()){var b=Inpl.Auid.getDingCounterTime();if(b){if(Inpl.Auid.getTimestamp()-b<i.CookieExpiry){var d=Inpl.Auid.getDingCounterValue();(0===d||d>0)&&(c("#"+a).addClass("active"),i.LastValue!=d&&(K(a,d,!0),X(a)),i.LastValue=d)}}F()&&(i.LastRequestTime?(G("dingCounterFromRequest() - not delayed"),H(a)):(G("dingCounterFromRequest() - delayed in sec."+i.FirstRequest),setTimeout(function(){H(a)},1e3*i.FirstRequest))),G("-repeat getDingCounter - in sec. "+i.IntervalCookie),setTimeout(function(){E(a)},1e3*i.IntervalCookie)}else G(NaN),i.showIncentive===!0&&(c("#"+a).addClass("active"),G("displayIncentive"),J(a)),G("-repeat getDingCounter - in sec. "+i.IntervalRequest),setTimeout(function(){E(a)},1e3*i.IntervalRequest)},F=function(){return!i.LastRequestTime||!!(i.AutoRefresh&&i.LastRequestTime+(i.IntervalRequest-i.IntervalCookie)<Inpl.Auid.getTimestamp()&&i.LastValue<=i.maxCount4refresh)},G=function(a){},H=function(a){G("dingCounterFromRequest("+a+")");var b=m[a];i.LastRequestTime=Inpl.Auid.getTimestamp(),c.ajax({type:"GET",url:b.countUrl,dataType:"jsonp",jsonpCallback:b.config.count.jsonpCallback,success:function(b){b&&(c("#"+a).addClass("active"),i.LastValue!=b.data?K(a,b.data,!0):K(a,b.data),Inpl.Auid.setDingCounter(b.data),i.LastValue=b.data)},error:function(){c("#"+a).removeClass("active")}})},I=function(a){H(a)},J=function(a){Inpl.Auid.dingWidgetIncentiveDisplayCheck(a)&&K(a,"incentive")},K=function(a,b,d){var e=m[a],g=c("#"+a+" ."+j.iconClass+" .count");if(countInt=e.config.count.countInt||10,0===g.length&&(g=c('<div class="count"></div>').appendTo("#"+a+" ."+j.iconClass)),"incentive"===b)g.html("<span class='incentive'></span>");else{if(b=parseInt(b,10),q.dingCounterValue=b,b>countInt&&(b=countInt+"+"),q.dingCounterDisplay=b,0===b&&g.length>0&&(N(a),q.dingCounterDisplay=null),i.LastRequestTime&&y.setValue(q),0===b)return;g.text(b)}d&&!f&&L(g,8)},L=function(a,b){c(a).hasClass("distinct")?c(a).removeClass("distinct"):c(a).addClass("distinct"),b--,f=b>0&&setTimeout(function(){L(a,b)},500)},M=function(a){G("dingTitleUpdater()"),G(a),a.initialTitle&&(b.title=a.dingCounterDisplay?"("+a.dingCounterDisplay+") "+a.initialTitle:a.initialTitle)},N=function(a){c("#"+a+" ."+j.iconClass+" .count").remove()},O=function(a){var b=m[a],d="",e="",f="";if(e+=j.iconClass,e+=b.config.customIconClass?" "+b.config.customIconClass:"",f+=b.config.advertisement?"background-image: url('"+b.config.icon+"'); ":"",d+='<div class="'+j.widgetClass+" "+j.widgetOnClass+(b.config.advertisement?" adv":"")+'"><div class="'+j.iconContainerClass+'"></div><div class="'+j.contentClass+'">',b.config.headline&&!b.mock.enabled&&(d+='<div><div class="'+j.headlineClass+'">'+b.config.headline+"</div></div>"),d+='<div><div class="'+j.closeClass+'">Zamknij</div></div>',b.mock.enabled?d+=b.mock.template:null!==b.iframeSrc&&(d+='<div class="'+j.iframeClass+'"><iframe width="'+b.config.width+'" height="'+b.config.height+'" frameborder="0" scrolling="no" src=""></iframe></div>'),b.links&&b.links.list&&b.links.list.length>0){var g,h,i="";i+=b.links.className?b.links.className:"",d+='<div class="'+j.linksClass+'"><ul class="'+i+'">';for(var g=0,h=b.links.list.length;g<h;g++)d+='<li class="li'+(g+1)+'"><a href="'+b.links.list[g].url+'">'+b.links.list[g].name+"</a></li>";d+="</ul></div>"}d+="</div></div>";var k=c("#"+a).find("."+j.widgetOnClass);k.length>0?(c(k).remove(),c(d).appendTo(c("#"+a))):c(d).appendTo(c("#"+a)),c("#"+a+" ."+j.widgetOnClass+" ."+j.iconContainerClass).append(c("#"+a+" ."+j.widgetOffClass+" ."+j.iconContainerClass).clone(!0)),c("#"+a+" ."+j.contentClass+" iframe").attr("src",b.iframeSrc+"#"+b.configUriQuery)},P=function(b){if(!m[b].config.staticPosition){var d,e,f,g,h,i="-"+k.position.baseTop;d=parseInt(c("#"+b).offset().top,10),e=d-k.position.baseTop-4,f=e-c(a).scrollTop(),g=c(a).height()-(f+m[b].config.height),h=c(a).height()-(d-c(a).scrollTop())-k.position.iconOffset,f<k.position.baseTop?(a.scrollTo(0,e),i="-"+k.position.baseTop):g<0&&(g*-1<f?h<7?(a.scrollTo(0,d-c(a).height()+k.position.iconOffset+k.position.bottomAdditionalOffset),i=(m[b].config.height-(k.position.frameAdditionalOffset+10))*-1):i=g-k.position.baseTop-k.position.frameAdditionalOffset:i="-"+(f- -k.position.baseTop)),c("#"+b+" ."+j.contentClass).css("top",i+"px")}},Q=function(a){return m[a]||!1},R=function(a,b){n===a?T(b):S(a,b)},S=function(a,e){if(a!==d&&m[a]!==d&&!o){var f=m[a];"wgt_webmail"!=a&&"wgt_ding"!=a||Inpl.interiaToolbar.removeVisible(),null!==n&&n!==a&&T(),f.config.count&&f.config.count.hideOnWidgetShow===!0&&(N(a),r(),y.setValue(q)),m[a].config.gemiusClick===d||e!==d&&e.noGemius===!0||"function"!=typeof gemius_hit||gemius_hit(m[a].config,0,0),l.queue(function(){f.instantiated||(O(a),f.instantiated=!0),P(a),U(a,function(a){c(b).trigger("widgetShown",a),n=a,l.dequeue()})})}},T=function(a){null!==n&&(o||l.queue(function(){V(n,function(){c(b).trigger("widgetHidden",n),n=null,l.dequeue()})}))},U=function(a,b){o=!0,c("#"+a+" ."+j.widgetOnClass).animate({opacity:"show"},0,function(){o=!1,b(a)}).parents("li").addClass("visible");var d=c(".dingSubscribeLayer");d.length&&d.removeClass("visible").hide()},V=function(a,b){o=!0,c("#"+a+" ."+j.widgetOnClass).animate({opacity:"hide"},0,function(){o=!1,b(a)}).parents("li").removeClass("visible")},W=function(a,b){c("#"+a+" iframe").animate({height:b+"px"},{duration:200})},X=function(a,b){m[a].instantiated=!1,b&&R(a)};this.add=s,this.addAd=t,this.attach=u,this.getConfig=Q,this.toggle=R,this.show=S,this.hide=T,this.refreshContent=X,this.countCheck=C,this.externalDingCountCheck=I,this.addDingObserver=w.addObserver,c(b).ready(function(){p()})}}(window,document,jQuery);