if(!Function.prototype.bind){Function.prototype.bind=function(a,d){var c=this,b=Array.prototype.slice.call(arguments,1);return function(f){var e=b.concat(Array.prototype.slice.call(arguments,0));return c.apply(a,e)}}}Object.keys=Object.keys||function(c){var a=[],b;for(b in c){if(c.hasOwnProperty(b)){a.push(b)}}return a};Object.create=Object.create||function(b){var a=function(){};a.prototype=b;return new a()};if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}if(!Array.prototype.filter){Array.prototype.filter=function(b){var a=this.length,e=[],d=arguments[1],c,f;if(typeof b!=="function"){throw new TypeError()}for(c=0;c<a;c++){if(c in this){f=this[c];if(b.call(d,f,c,this)){e.push(f)}}}return e}}if(!Array.filter){Array.filter=function(c,a){var b=arguments[2];return Array.prototype.filter.call(c,a,b)}}if(!Array.prototype.forEach){Array.prototype.forEach=function(b){var d,a=this.length*1,c=arguments[1];if(typeof b!=="function"){throw new TypeError()}for(d=0;d<a;d++){if(d in this){b.call(c,this[d],d,this)}}}}if(!Array.forEach){Array.forEach=function(c,a){var b=arguments[2];return Array.prototype.forEach.call(c,a,b)}}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(b){var a=this.length,c=Number(arguments[1])||0;c=(c<0)?Math.ceil(c):Math.floor(c);if(c<0){c+=a}for(;c<a;c++){if(c in this&&this[c]===b){return c}}return -1}}if(!Array.prototype.map){Array.prototype.map=function(b){if(typeof b!=="function"){throw new TypeError()}var e,a=this.length>>>0,d=new Array(a),c=arguments[1];for(e=0;e<a;e++){if(e in this){d[e]=b.call(c,this[e],e,this)}}return d}}if(!Array.map){Array.map=function(c,a){var b=arguments[2];return Array.prototype.map.call(c,a,b)}}if(!Array.prototype.some){Array.prototype.some=function(b){if(typeof b!=="function"){throw new TypeError()}var d=0,a=this.length>>>0,c=arguments[1];for(;d<a;d++){if(d in this&&b.call(c,this[d],d,this)){return true}}return false}}if(!Array.some){Array.some=function(c,a){var b=arguments[2];return Array.prototype.some.call(c,a,b)}}if(!Array.prototype.every){Array.prototype.every=function(b){if(this===undefined||this===null){throw new TypeError()}var e=Object(this),a=e.length>>>0;if(typeof b!=="function"){throw new TypeError()}var d=arguments[1];for(var c=0;c<a;c++){if(c in e&&!b.call(d,e[c],c,e)){return false}}return true}}if(!Array.prototype.reduce){Array.prototype.reduce=function(b){var d,a=this.length>>>0;if(typeof b!="function"){throw new TypeError()}if(a===0&&arguments.length==1){throw new TypeError()}var c=0;if(arguments.length>=2){d=arguments[1]}else{do{if(c in this){d=this[c++];break}if(++c>=a){throw new TypeError()}}while(true)}for(;c<a;c++){if(c in this){d=b.call(null,d,this[c],c,this)}}return d}}Array.isArray=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"};var JSON;if(!JSON){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());if(!window.Inpl){window.Inpl={}}if(!window.XMLHttpRequest){(function(){var e=null,c,d,f,b=["MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"];window.XMLHttpRequest=function(){if(e){return new ActiveXObject(e)}else{for(c=0,f=b.length;c<f;c+=1){try{d=new ActiveXObject(b[c]);e=b[c];return d}catch(a){}}return null}}}())}Inpl.Network=new function(){function b(v){if(v.indexOf("http://")===0||v.indexOf("https://")===0){if(v.indexOf(location.protocol+"//"+location.host)===0){return false}else{return true}}else{return false}}function c(){var v=new XMLHttpRequest();if(typeof v.withCredentials==="undefined"){if(typeof XDomainRequest!=="undefined"){v=new XDomainRequest()}else{if(typeof SWFHttpRequest!=="undefined"){v=new SWFHttpRequest()}else{v=null}}}if(v){v.inplIsCORS=true}return v}function k(v){return v.inplIsCORS}var e=1,j=2,f=(function(){var y=/MSIE\ ([\d.]+)/,w=y.exec(navigator.userAgent),v=(window.opera||!w)?0:parseFloat(w[1]),x=document.documentMode||0;return Math.max(v,x)}()),u=this,a=new s(),d="Inpl_Progress",q=null,i=null,o="Wczytuję...";this.XML=1;this.JSON=2;this.TEXT=3;this.JS=4;this.CSS=5;this.DEFAULT_TIMEOUT=5000;this.onShowProgress=m;this.onHideProgress=h;function g(v){return document.getElementById(v)}this.createRequest=function(y,v,x,w,A){var z=null;if(u.BrowserIsCompatible()){z=new n(y,v,x,w,A)}return z};this.get=function(w){if(w.params){w.url+=(-1==w.url.indexOf("?")?"?":"&")+p(w.params)}var v=u.createRequest(w.type||u.TEXT,w.url,null,w.tag||null,w.headers||null);v.Execute(w.onSuccess||null,w.timeout||u.DEFAULT_TIMEOUT,w.onError||null,w.onTimeout||null);return v};this.post=function(w){var v=u.createRequest(w.type||u.TEXT,w.url,w.params||null,w.tag||null,w.headers||null);v.Execute(w.onSuccess||null,w.timeout||u.DEFAULT_TIMEOUT,w.onError||null,w.onTimeout||null);return v};this.loadCss=function(v){if(typeof v==="string"){v={url:v}}v.type=u.CSS;return u.get(v)};this.loadJs=function(v){if(typeof v==="string"){v={url:v}}v.type=u.JS;return u.get(v)};this.download=function(v,w){w.tag=w.tag||{};w.tag.__downloadToObject=v;if(w.onSuccess){w.tag.__onSuccess=w.onSuccess}w.onSuccess=function(y,x){u.doneDownload(y,x)};return u.get(w)};this.doneDownload=function(w,v){if(typeof v.__downloadToObject==="object"){v.__downloadToObject.innerHTML=w}else{g(v.__downloadToObject).innerHTML=w}v.__downloadToObject=null;if(v.__onSuccess){run=v.__onSuccess;v.__onSuccess=null;run(w,v)}};this.setMaxParallelRequest=function(v){a.setMaxParallelRequest(v)};function p(x){var v,w="";for(v in x){if(x.hasOwnProperty(v)){w+=(w?"&":"")+encodeURIComponent(v)+"="+encodeURIComponent(x[v])}}return w}this.BrowserIsCompatible=function(){return(window.XMLHttpRequest?true:false)};this.setProgressText=function(v){o=v};function r(){if(g(d)){return g(d)}else{q=document.createElement("DIV");q.id=d;q.style.position="fixed";q.style.top="0px";q.style.right="0px";var v=document.createElement("p");v.innerHTML=o;q.appendChild(v);if(document.all&&!window.opera){q.style.position="absolute"}document.body.appendChild(q)}return q}this.updateProgressPosition=function(){var v=g(d);if(q){v.style.top=document.body.scrollTop+"px";v.style.left=(document.body.clientWidth-v.offsetWidth)+"px"}};function t(){r();q.style.display="block"}function m(){if(!i){i=setTimeout(t,200);if(document.all&&!window.opera){window.attachEvent("onresize",u.updateProgressPosition);window.attachEvent("onscroll",u.updateProgressPosition)}}}function h(){l();if(q){q.style.display="none";if(document.all&&!window.opera){window.detachEvent("onresize",u.updateProgressPosition);window.detachEvent("onscroll",u.updateProgressPosition)}}}function l(){if(i){clearTimeout(i)}i=null}function n(A,x,z,y,B){var v,w=false;if(A!=u.JS&&A!=u.CSS){x+=(-1==x.indexOf("?")?"?":"&")+"inpl_network_request=true"}v={type:A,url:x,onSuccess:null,context:y,postString:null,headers:B,timeout:null};if(typeof z==="object"){v.postString=p(z)}else{v.postString=z}this.Execute=function(F,D,C,E){v.onSuccess=F;if(C){v.onError=C}if(E){v.onTimeout=E}if(D){v.timeout=D}else{v.timeout=u.DEFAULT_TIMEOUT}if(!w){a.Add(v)}w=true};this.IsExecuting=function(){return w};this.Abort=function(){a.Remove(v);w=false}}function s(){var A=this,x=[],w=0,v=2;this.setMaxParallelRequest=function(D){v=D};this.Add=function(D){x.push(D);A.Continue()};this.Remove=function(D){var E;for(E in x){if(x[E]===D){x.splice(parseInt(E,10),1);break}}};this.AbortAll=function(){x=[]};this.Continue=function(){var D=this,E;if(w<v){if(x.length){E=x.shift();if(!E.isSilent){u.onShowProgress()}w+=1;switch(E.type){case u.XML:case u.TEXT:case u.JSON:E.executing=y(E);break;case u.JS:E.executing=z(E);break;case u.CSS:E.executing=B(E);break;default:w-=1}}else{u.onHideProgress()}}};function y(K){var F=0,G,E;if(b(K.url)){E=c()}else{E=new XMLHttpRequest()}if(!E){throw"Can't create Request: "+K.url}if(K.timeout){K.timer=setTimeout(D,K.timeout)}if((window.SWFHttpRequest&&E instanceof window.SWFHttpRequest)||!k(E)){E.onreadystatechange=H}else{E.onload=J}try{E.onerror=function(){C(null,K,j)}}catch(I){console.log(I)}if(K.postString){E.open("POST",K.url,true);E.setRequestHeader("Content-Type","application/x-www-form-urlencoded");if(!k(E)){E.setRequestHeader("X-Requested-With","XMLHttpRequest")}}else{E.open("GET",K.url,true);if(!k(E)){E.setRequestHeader("X-Requested-With","XMLHttpRequest")}}if(K.headers){for(G in K.headers){if(K.headers.hasOwnProperty(G)){E.setRequestHeader(G,K.headers[G])}}}E.send(K.postString);function J(){if(K.timer){clearTimeout(K.timer)}var L=null,M;switch(K.type){case u.XML:if(E.responseXML){L=E.responseXML}break;case u.TEXT:if(E.responseText){L=E.responseText}break;case u.JSON:if(E.responseText){M=E.responseText.replace(/^[ \t]*while([ ]*1[ ]*);/g,"");L=JSON.parse(M)}break}C(L,K);E=K=null}function H(){if(4==E.readyState){E.onreadystatechange=function(){};J()}}function D(){if(!k(E)){E.onreadystatechange=function(){}}E.abort();E=null;C(null,K,e);K=null}return E}function B(I){var F=0,E=document.createElement("LINK");E.onload=H;E.onerror=G;E.setAttribute("rel","stylesheet");E.setAttribute("type","text/css");E.setAttribute("href",I.url);document.getElementsByTagName("HEAD")[0].appendChild(E);if(I.timeout){I.timer=setTimeout(D,I.timeout)}function H(){if(I.timer){clearTimeout(I.timer)}C(true,I);E=I=null}function G(){if(I.timer){clearTimeout(I.timer)}C(null,I,j);E=I=null}function D(){C(null,I,e);I=null}return E}function z(I){var E=0,H=document.createElement("script");H.onload=G;if(f>0&&f<9){H.onreadystatechange=function(){if(this.readyState=="complete"||this.readyState=="loaded"){G()}}}H.onerror=F;H.setAttribute("type","text/javascript");H.setAttribute("src",I.url);document.body.appendChild(H);if(I.timeout){I.timer=setTimeout(D,I.timeout)}function G(){if(I.timer){clearTimeout(I.timer)}C(true,I);H=I=null}function F(){if(I.timer){clearTimeout(I.timer)}C(null,I,j);H=I=null}function D(){C(null,I,e);I=null}return H}function C(D,F,E){w-=1;if(F.onTimeout&&null==D&&E===e){F.onTimeout(F.context)}else{if(F.onError&&null==D&&E===j){F.onError(F.context)}else{if(F.onSuccess){F.onSuccess(D,F.context)}}}F=F.onSuccess=F.onError=F.onTimeout=F.context=F.executing=D=null;setTimeout(A.Continue,1)}}this.assign=function(v,w){if(typeof v==="string"){v=g(v)}if(w){v.__params=w}if(v.onsubmit){v.__onsubmit=v.onsubmit}v.onsubmit=function(){return u.send(this)}};this.send=function(y,A){var x=true,w,v,z={};if(typeof y==="string"){y=g(y)}if(!A&&y.__params){A=y.__params}if(!A.url){A.url=y.action}if(!A.params){A.params={}}for(w=0;w<y.elements.length;w+=1){z=y.elements[w];if(!z.disabled){switch(z.type){case"text":case"password":case"hidden":case"textarea":case"tel":case"number":case"email":case"search":A.params[z.name]=z.value;break;case"select-one":if(z.selectedIndex>=0){A.params[z.name]=z.options[z.selectedIndex].value}break;case"select-multiple":for(v=0;v<z.options.length;v+=1){if(z.options[v].selected){if(!A.params[z.name]){A.params[z.name]=[]}A.params[z.name][A.params[z.name].length]=z.options[v].value}}break;case"checkbox":if(z.checked){if(!A.params[z.name]){A.params[z.name]=[]}A.params[z.name][A.params[z.name].length]=z.value}break;case"radio":if(z.checked){A.params[z.name]=z.value}break}}}if(y.__onsubmit){x=y.__onsubmit()}if(x){if("post"==y.method){u.post(A)}else{u.get(A)}}return false}}();(function(){var g,e=Inpl.Network,c="@url",a="@callbacks";function b(o,j){o=o.split(".");j=j||window;var l,k,n=j;try{for(l=0,k=o.length;l<k;l+=1){n=n[o[l]]}}catch(m){n=null}if(n===j){n=null}return n}function d(j){var i=j[a];delete j[a];if(i&&i.length){i.forEach(function(k){k()})}}function f(j){var i=Inpl.Mail;e.loadJs({url:j[c],onSuccess:function(){d(j)},onError:function(){var k="Nie udało się załadować modułu: "+j[c];if(i.UI&&i.UI.showNotice){i.UI.showNotice(k,"error")}else{alert(k)}}})}function h(j,i){this.modulePath=j;this.message=i||"No such module: "+j}h.prototype=new Error();g={NoSuchModuleException:h,modules:{},init:function(i){this.modules=i},require:function(j,k){var i;if(b(j)){k()}else{i=b(j,this.modules);if(i){if(!i[a]){i[a]=[]}i[a].push(k);f(i)}else{throw new h(j)}}}};Inpl.LoadableModules=g}());function $(a){return document.getElementById(a)}window.Inpl=window.Inpl||{};Inpl.Mail=Inpl.Mail||{};Inpl.Mail.L10n=Inpl.Mail.L10n||{};if(!window.console){if(window.location.href.indexOf("debugAlerts")>=0){window.console={log:function(a){alert(a)}}}else{window.console={log:function(){}}}}if(window.location.host.indexOf(".mailv1.")!==-1&&typeof _gaq==="undefined"){_gaq={push:function(){console.log.apply(console,arguments)}}}Inpl.Mail.init=function(v,p,s){$("content").style.display="block";var d=Inpl.Mail,l=d.DOM,i=d.UI,m=l.createElement,w=d.ContactList,g=d.Folders,a=d.Composition,j=d.Prefs,h="",o,u,e,n=new Gettext({domain:"inpl_mail_init",locale_data:Inpl.Mail.L10n}),r=function(x){return n.gettext(x)};Inpl.Network.DEFAULT_TIMEOUT=60000;if(!d.Tools.checkParentFrames()){return}if(!v){i.showNotice(r("Inpl.Mail: Brak danych inicjalizacyjnych"),"error");return}d.env=v.env||{};d.browser.updateBodyClass();d.DOM.addHasFocusSupport();$("side-search").innerHTML='<div><form class=side-search-form action="#" method=post onsubmit="return Inpl.Mail.MessageList.search()"><label for=msg-search-field>'+r("Szukaj wiadomości:")+'</label><input type=search id=msg-search-field name=msg-search-field class=sideInput placeholder="'+r("Szukaj wiadomości…")+'"><input title="'+r("Szukaj wiadomości po słowach kluczowych")+'" type=submit id=msg-search-submit value="'+r("Szukaj")+'" onfocus="blur();"></form></div>';Inpl.LoadableModules.init(v.loadableModules);j.init(v.prefs);i.Theme.init(v.env.themes);w.init(v.contacts,v.contactsAutoinserted);d.CntGroups.init(v.groups);g.init(v.folders);d.Blacklist.init(v.bwList?v.bwList.black:[]);[d.Tabs,i.DnD,i.WindowTitle,d.TaskbarNotifications,d.AudioNotifications].forEach(function(x){x.init()});a.limits=v.limits;if(v.signatures){a.signatures=v.signatures;a.defaultSignatureId=v.defaultSignatureId}else{a.defaultSignatureId=-1}delete d.env.themes;i.injectButtons([{ident:"compose",label:r("Nowa"),title:r("Nowa wiadomość"),accessKey:"n",cmd:function(){d.Composition.composeNew();d.Tools.hitGemius(d.Tools.getGemiusByAlias("UNCATEGORISED","NEW_MESSAGE_BUTTON"))}},{ident:"fetch",label:r("Odśwież"),title:r("Odśwież listę wiadomości"),accessKey:"o",cmd:function(){if(d.MessageNotifQueue.isOk()){d.UI.showFakePushNotice(r("Brak nowych wiadomości"),r("Nie musisz już klikać przycisku Odśwież."),r("Informację o każdej wiadomości dostaniesz natychmiast po jej przyjściu!"))}else{d.Folders.checkForNew()}d.Tools.hitGemius("B8M6seLqb72.pFzEWLkbV8SsfcBWd4cisA21_w03gwX.17")}},{ident:"contacts",label:r("Kontakty"),title:r("Kontakty"),accessKey:"k",cmd:function(){d.ContactList.manage();d.Tools.hitGemius("d1NL_4NcdHuu1GhZNO6fFpQKHQKGDccDGXmVleAWByL.k7")}},"|"],"nav0");d.DOM.addEvent($("tabHeaderCont"),"dblclick",function(y){var x=y.target||y.srcElement;if(x.id==="tabHeaderCont"){a.composeNew()}});if(!p&&location.hash&&location.hash!=="#"){p=location.hash.substr(1)}d.MessageList.mainList=new d.MessageList({folder:1,page:1,prefetched:v.messages},r("Odebrane"));d.MessageList.mainList.openInTab(true,function(){d.Tools.handleStartAction(p,s)});if(d.browser.supports.dnd){i.DnD.makeDropTarget($("outerTabHeaderCont"),function(y){if(y.relatedItem){_gaq.push(["b._trackEvent","Drag and drop","Zakładki","Otwarcie wiadomości"]);var A=d.MessageList.currentList.getActiveRows(),z=A.length,x="open";if(y.relatedItem.folderId===-1){x="edit"}if(z<2){y.relatedItem[x]()}else{if(z<5){A.forEach(function(B){B.relatedItem[x]()})}else{if(z<=10){d.UI.ModalDialogs.confirm({message:n.strargs(r("Czy na pewno otworzyć %1 wiadomości?"),z),onAccept:function(){A.forEach(function(B){B.relatedItem[x]()})}})}else{d.UI.showNotice(r("Za jednym razem można otworzyć maks. 10 wiadomości"))}}}}else{if(y.relatedContact){_gaq.push(["b._trackEvent","Drag and drop","Zakładki","Nowa wiadomość (przeciągnięto kontakt)"]);y.relatedContact.composeMail()}else{if(y.relatedFolder){_gaq.push(["b._trackEvent","Drag and drop","Zakładki","Otwarcie folderu"]);y.relatedFolder.open()}}}})}window.onbeforeunload=function(z){var x=d.Tabs.list,y;if(d.disableBeforeUnload){delete d.disableBeforeUnload}else{if(x.length&&x.some(function(A){return A.contentChanged})){y=r("Wyjście ze strony spowoduje utratę niezapisanych danych.")}}return y};window.onunload=function(){d.UI.showNotices=false;d.MessageList.instances.forEach(function(x){if(x.destroy){x.destroy()}});d.Folders.cleanUp()};h=d.Prefs.get("forward");if(h){d.UI.showNotificationBar(l.createElement("span",{childNodes:[document.createTextNode(n.strargs(r("Poczta jest obecnie przekierowywana na konto %1"),h)+" - "),l.createElement("a",{href:"#dropRedir",innerHTML:r("Usuń przekierowanie"),onclick:function(y){var x=this.parentNode.parentNode;x.parentNode.removeChild(x);d.Prefs.set("forward","",true,function(){d.UI.showNotice(r("Przekierowanie zostało usunięte"))});l.preventDefault(y)}})]}))}if(!window.XMLHttpRequest||!window.XDomainRequest&&!("withCredentials" in new XMLHttpRequest())){setTimeout(function(){Inpl.Mail.MessageNotifView.init()},5000)}else{Inpl.Mail.MessageNotifView.init()}if(v.popTrashMsgCount>0){d.Folders.popTrashMsgCount=v.popTrashMsgCount;if(!d.Prefs.get("dontShowPopTrashBar")){d.Folders.showPopTrashBar()}}d.DOM.addEvent(window,"load",function(z){if(v.env.readOnly){var x,y=$("webmailSettingsMenu").querySelectorAll('a[href*="ustawienia.interia.pl"]');for(x=0;x<y.length;x++){l.addClass(y[x],"hideAfterClick");d.DOM.addEvent(y[x],"click",function(A){d.UI.showNotice(r("Opcja chwilowo niedostępna"),"error");l.preventDefault(A)})}}});d.Tools.showSideAd();l.addEvent(window,"load",function(){Object.keys(d.Addons).map(function(x){return d.Addons[x]}).forEach(function(x){if(typeof x.init==="function"){x.init()}})});d.QuickFilters.init();d.Views.init();d.User.init();if(navigator&&navigator.registerProtocolHandler){o=true;if(window.localStorage){o=!(window.localStorage.getItem("showMailtoHandlerBar")==="off");window.localStorage.setItem("showMailtoHandlerBar","off")}if(o){u=location.protocol+"//"+location.hostname+"/mh/?mailto=%s";navigator.registerProtocolHandler("mailto",u,"Poczta INTERIA.PL")}}d.DOM.addEvent($("footer-ifc-mobile"),"click",function(x){_gaq.push(["b._trackEvent","Nowy interfejs","Zmiana na mobilny"])});d.DOM.addEvent(window,"load",function(B){var x=["zUqaAerXfv4.zoIPQXmOOIXzHXIpHMeTRH2FEcJR63P.X7","zUqQm_rXoy6p_WG1QaYdC4XzP50pHG9YRCbRfUKVGJ3.g7"],z=document.querySelectorAll(".toolbarUl .userAccountLi li"),A=document.querySelectorAll(".toolbarUl .webmailSettingsLi li");for(var y=0;y<z.length;y++){(function(C){d.DOM.addEvent(z[y],"click",function(D){gemius_hit(C)})}(x[y]))}for(var y=0;y<A.length;y++){(function(C){if(C.getAttribute("data-gemius")!=null){d.DOM.addEvent(C,"click",function(D){gemius_hit(C.getAttribute("data-gemius"))})}}(A[y]))}});e=$("cal_href");if(e){l.addEvent(e,"click",function(){_gaq.push(["b._trackEvent","Kalendarz","link – kalendarze","klik"])})}if(Inpl.Mail.env.infoBoards[0]&&Inpl.Mail.env.infoBoards[0].id==7){d.PromotionQueue.insert(d.promotions.board.mobilePromotion,d.PromotionQueue.TYPE.BOARD)}d.DOM.addEvent(window,"load",function(A){var y=d.PromotionQueue.extractAllAsArray(d.PromotionQueue.TYPE.BUBBLE),x=false;for(var z=0;z<y.length&&!x;z++){x=y[z]()}});var f=d.PromotionQueue.extract(d.PromotionQueue.TYPE.BOARD);f();if(screen.width>1200&&Inpl.Mail.env.accountType==0){var q=document.getElementById("content"),k;document.getElementById("mainContent").style.minHeight="660px";document.getElementById("rightContent").style.minHeight="660px";q.className=q.className+" hektor-content";k=m("div",{className:"hektor-container",childNodes:[m("a",{className:"hektor-logo",href:"http://www.interia.pl?hkt=sgp#iwa_source=bloczek_poczta",target:"_blank"}),m("hr",{className:"hektor-hr",}),m("iframe",{id:"hektor",frameborder:"0",src:"https://a.hub.com.pl/hektor/hektor.html"}),m("div",{className:"hektor-close",onclick:function(){k.className+=" hektor-container--close";q.className+=" hektor-content--close";iwa("trackEvent","MailboxHektor","NewsList","zwiniecie_klikX");d.Tools.hitGemius("zadLAOuGdEQZ0WfQoc2T88dRLQpktWcv_c8oaOS8Ywv.Q7");if(!d.DOM.hasClass(q,"hektor-content--animate")){q.className+=" hektor-content--animate"}d.Prefs.set("hektorExpanded",0,true)}}),m("div",{className:"hektor-open",onclick:function(){k.className=k.className.replace("hektor-container--close","");q.className=q.className.replace("hektor-content--close","");iwa("trackEvent","MailboxHektor","NewsList","rozwiniecie");d.Tools.hitGemius("dv1FZINqGZd_jE8XpCNfj6dyzQCUHqb_WUDY1ZPa443.V7");if(!d.DOM.hasClass(q,"hektor-content--animate")){q.className+=" hektor-content--animate"}d.Prefs.set("hektorExpanded",1,true)}})]});if(parseInt(Inpl.Mail.env.hektorExpanded)==0){k.className+=" hektor-container--close";q.className+=" hektor-content--close"}q.parentNode.insertBefore(k,q.nextSibling);setTimeout(function(){var x=document.getElementById("hektor").offsetHeight;if(x==0){document.getElementsByTagName("body")[0].className+=" adblock"}},300)}if(Inpl.Mail.env.infoBoards[0]&&Inpl.Mail.env.infoBoards[0].id==601){d.dataSecurity.showdialog()}if(Inpl.Mail.env.infoBoards[0]&&Inpl.Mail.env.infoBoards[0].id==201){d.premiumInfo.showdialog()}if(Inpl.Mail.env.infoBoards[0]&&Inpl.Mail.env.infoBoards[0].id==203){d.adultPermission.showdialog()}if(Inpl.Mail.env.offerError){var c=m("div",{className:"notice--offerError",childNodes:[m("span",{innerHTML:"Ups. Nie możemy znaleźć wybranej oferty.\n"}),m("a",{innerHTML:"Sprawdź aktualne vouchery w folderze Oferty &raquo;",onclick:function(){Inpl.Mail.Folders.openShop();i.hideNotice();return false}})]});i.showNotice(c,"",-1,true)}if(Inpl.Mail.env.voucher&&Inpl.Mail.env.voucher.code){var t=Inpl.Mail.env.voucher;d.UI.ModalDialogs.alert({acceptLabel:r("Zamknij"),additionalClass:"voucher-info",message:[m("p",{className:"voucher-desc",childNodes:"Twój kod na seans:"}),m("p",{className:"voucher-bold",childNodes:t.title}),m("p",{className:"voucher-desc",childNodes:"W dniu:"}),m("p",{className:"voucher-bold",childNodes:t.date}),m("div",{className:"voucher-code",childNodes:[m("span",{childNodes:t.code}),m("div",{className:"barcode-container",childNodes:barcode(t.code,"code128")})]}),m("p",{className:"voucher-foot",childNodes:t.foot})]})}if(Inpl.Mail.env.oldBrowser){var b=d.UI.ModalDialogs.alert({acceptLabel:r("Zamknij"),additionalClass:"oldBrowser-info",message:[m("div",{childNodes:[m("span",{innerHTML:"Niestety używasz przestarzałej przeglądarki, żeby korzystać z&nbsp;nowej poczty zainstaluj jej nowszą wersję lub inny program. Informacje i pomoc jak to zrobić znajdziesz "}),m("a",{className:"",innerHTML:"tutaj",href:"http://pomoc.poczta.interia.pl/nhtml/news-jak-pobrac-najnowsza-wersje-przegladarki,nId,2136017",target:"_blank"})]})]})}};Inpl.Mail.DOM=(function(){var a;function h(i){return new RegExp("(^|\\s)"+i+"(\\s|$)")}function f(j,m,i){var l=null,k;if(typeof j==="string"){l=$(j)}else{if(j&&j.nodeType!==undefined){l=j}}if(!l){return null}k=h(i);switch(m){case"+":if(!k.test(l.className)){l.className=(l.className+" "+i+" ")}l.className=l.className.replace(/ +(?= )/g,"");return l.className;case"-":l.className=l.className.replace(k," ");l.className=l.className.replace(/ +(?= )/g,"");return l.className;case"?":return k.test(l.className)}return null}function b(j,i){j.addEventListener("load",i,false)}function c(j,i){j.attachEvent("onreadystatechange",function(){if(j.readyState==="complete"){i()}})}function e(j){j=j||event;var i;if(!this.maxLength){i=this.getAttribute("maxlength");this.maxLength=i}if([8,35,36,37,38,39,40,46].indexOf(j.keyCode)<0&&this.maxLength&&this.value.length>=parseInt(this.maxLength,10)){this.value=this.value.substring(0,this.maxLength);a.preventDefault(j)}}a={elmById:function(i){return document.getElementById(i)},elmsByClass:function(j,i){i=i||document;if(i.getElementsByClassName){return i.getElementsByClassName(j)}var k=h(j);return Array.filter(i.getElementsByTagName("*"),function(l){return k.test(l.className)})},addEvent:function(k,j,i){k.addEventListener(j,i,false)},removeEvent:function(k,j,i){k.removeEventListener(j,i,false)},dispatchClickEvent:document.createEvent?function(k,j){var i=k.document.createEvent("MouseEvents");i.initMouseEvent("click",true,true,k,0,0,0,0,0,false,false,false,false,0,null);j.dispatchEvent(i)}:function(j,i){i.fireEvent("onclick")},insertAfter:function(j,k){var i=k.parentNode;if(!i){throw new Error("insertAfter: relatedElement.parentNode does not exist")}if(k===i.lastChild){i.appendChild(j)}else{i.insertBefore(j,k.nextSibling)}return j},matchesSelector:function(o,n){var p=this,l=Inpl.Mail.browser.vendorPrefix.js.toLowerCase()+"MatchesSelector",m,s,q,j,k,i,r;if("matchesSelector" in o){return o.matchesSelector(n)}else{if(l in o){return o[l](n)}else{if(document.querySelectorAll){r=p.nodeListToArray(o.parentNode.querySelectorAll(n));return !!r.some(function(t){return t===o})}else{if(n.indexOf(" ")>=0){throw new Error("Unsupported selector in DOM.matchesSelector")}k=(/\#([a-zA-Z0-9_-]*)/).exec(n);q=(/\.([a-zA-Z0-9_-]*)/).exec(n);if(k){k=k[1]}if(q){q=q[1]}m=n.split(".")[0].split("#")[0];s=m?o.tagName.toLowerCase()===m.toLowerCase():true;j=q?p.hasClass(o,q):true;i=k?k===o.id:true;return s&&j&&i}}}},addHasFocusSupport:function(i){var j=this;i=i||document;if(typeof i.hasFocus==="function"){return}(function(){var k=true;j.addEvent(window,"focus",function(){k=true});j.addEvent(window,"blur",function(){k=false});i.hasFocus=function(){return k}}())},preventDefault:function(i){i.preventDefault();return false},stopPropagation:function(i){i=i||event;if(i.stopPropagation){i.stopPropagation()}else{i.cancelBubble=true}},nodeListToArray:function(l){var j,m,k;try{j=Array.prototype.slice.call(l)}catch(n){j=[];if(l.length===undefined){throw new TypeError("nodeListToArray requires an array-like object")}m=l.length;for(k=0;k<m;k+=1){j[k]=l[k]}}return j},addMaxLengthSupport:function(i){a.addEvent(i,"keypress",e)},addPlaceholderSupport:function(k){var i=k.getAttribute("placeholder");a.addEvent(k,"focus",function(){if(this.value===i){this.value="";a.removeClass(this,"placeholder")}});function j(){if(this.value===""){this.value=i;a.addClass(this,"placeholder")}}a.addEvent(k,"blur",j);j.call(k)},selectOnFocus:function(i){a.addEvent(i,"focus",function(){a.setSelectionRange(this,0,this.value.length)})},findPos:function(j){var k=0,i=0;while(j.offsetParent){k+=j.offsetLeft;i+=j.offsetTop;j=j.offsetParent}return[k,i]},findParentPos:function(j){var k=j.offsetLeft,i=j.offsetTop;return[k,i]},getStyle:function(j,i,k){var l;k=k||document;if(j.currentStyle&&!window.opera){if(i.indexOf("-")>=0){l=j.currentStyle[a.dashStyleToCamel(i)]}else{l=j.currentStyle[i]}}else{if(window.getComputedStyle){l=k.defaultView.getComputedStyle(j,null).getPropertyValue(i)}}return l},dashStyleToCamel:function(m){var l,k,j;l=m.split("-");k=l[0];if(l.length){for(j=1;j<l.length;j+=1){if(l[j]==="ms"){k+="ms"}else{k+=l[j].charAt(0).toUpperCase()+l[j].substr(1)}}}return k},getScrollXY:function(){var j=0,i=0;if(typeof window.pageYOffset==="number"){i=window.pageYOffset;j=window.pageXOffset}else{if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){i=document.body.scrollTop;j=document.body.scrollLeft}else{if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){i=document.documentElement.scrollTop;j=document.documentElement.scrollLeft}}}return[j,i]},getWindowSize:function(){var i=0,j=0;if(typeof window.innerWidth==="number"){i=window.innerWidth;j=window.innerHeight}else{if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){i=document.documentElement.clientWidth;j=document.documentElement.clientHeight}else{if(document.body&&(document.body.clientWidth||document.body.clientHeight)){i=document.body.clientWidth;j=document.body.clientHeight}}}return[i,j]},setSelectionRange:function(j,k,m){var i;try{if(j.setSelectionRange){j.focus();j.setSelectionRange(k,m)}else{if(j.createTextRange){i=j.createTextRange();i.collapse(true);i.moveEnd("character",m);i.moveStart("character",k);i.select()}}}catch(l){}},addClass:function(j,i){return f(j,"+",i)},removeClass:function(j,i){return f(j,"-",i)},hasClass:function(j,i){return f(j,"?",i)},toggleClass:function(j,i){if(a.hasClass(j,i)){a.removeClass(j,i)}else{a.addClass(j,i)}},createElement:function(s,n){var k,p,r,o,l,m,j,q;if(n){r=n.childNodes;if(r){delete n.childNodes}p=n.ownerDocument;if(p){delete n.ownerDocument}}p=p||document;if(s==="iframe"&&n.name&&Inpl.Mail.browser.ie&&Inpl.Mail.browser.ie<8){s='<iframe name="'+n.name.replace(/\"/g,"&quot;")+'">'}k=p.createElement(s);if(n){if(typeof n.style==="object"){j=n.style;q=k.style;for(m in j){if(j.hasOwnProperty(m)){q[m]=j[m]}}delete n.style}for(m in n){if(n.hasOwnProperty(m)&&n[m]!==undefined){k[m]=n[m]}}}if(r){if(!Array.isArray(r)){r=[r]}for(m=0,l=r.length;m<l;m++){o=r[m];if(typeof o==="string"){k.appendChild(p.createTextNode(o))}else{k.appendChild(o)}}}return k},getOuterHTML:("outerHTML" in document.createElement("p")?function g(i){return i.outerHTML}:function d(i){var k=i.ownerDocument,j=k.createElement(i.parentNode.tagName);j.appendChild(i.cloneNode(true));return j.innerHTML}),addFrameOnLoadEvent:(window.attachEvent&&!window.opera)?c:b,removeChildren:function(i){while(i.hasChildNodes()){i.removeChild(i.lastChild)}}};if(!window.addEventListener){(function(){function l(m){m.preventDefault=l.preventDefault;m.stopPropagation=l.stopPropagation;return m}l.preventDefault=function(){this.returnValue=false};l.stopPropagation=function(){this.cancelBubble=true};function i(p){p=p||l(((this.ownerDocument||this.document||this).parentWindow||window).event);var n,o=true,m=this.events[p.type];for(n in m){if(m.hasOwnProperty(n)){this.$$handleEvent=m[n];if(this.$$handleEvent(p)===false){o=false}}}return o}function j(n,p,o){if(!o.$$guid){o.$$guid=j.guid++}if(!n.events){n.events={}}var m=n.events[p];if(!m){m=n.events[p]={};if(n["on"+p]){m[0]=n["on"+p]}}m[o.$$guid]=o;n["on"+p]=i}j.guid=1;function k(m,o,n){if(m.events&&m.events[o]){delete m.events[o][n.$$guid]}}a.addEvent=j;a.removeEvent=k}());a.preventDefault=function(i){i.returnValue=false;return false}}return a}());(function(){var g=Inpl.Mail,k=g.DOM,h=navigator.userAgent,a,o,l,i,d,c,n,f,b,j,e,m;function p(s,r){var u=false,v,q;try{v=document.createElement("div");q=k.dashStyleToCamel(s);v.style[q]=r;u=r===v.style.getPropertyValue(s)}catch(t){}return u}b=(function(){var r=(/MSIE\ ([\d.]+)/).exec(h),q=(window.opera||!r)?0:parseFloat(r[1]),s=document.documentMode?document.documentMode:0;return Math.max(q,s)}());o=(function(){var q=(/WebKit\/([\d.]+)/).exec(h);return q?parseFloat(q[1]):0}());d=(function(){var q=(/KHTML\/([\d.]+)/).exec(h);return q?parseFloat(q[1]):0}());i=(function(){var q=(/Chrome\/([\d.]+)/).exec(h);return q?parseFloat(q[1]):0}());f=window.opera?(function(){var q=(/Opera.([\d.]+)/).exec(h),r=q?parseFloat(q[1]):0,s;if(r>=9.8){q=(/Version\/([\d.]+)/).exec(h);s=q?parseFloat(q[1]):0;return s||r}else{return r}}()):0;e=(function(){return(/iPad|iPhone/).test(h)}());m=(function(){var q;if(e){q=(navigator.appVersion).match(/OS (\d+)_(\d+)_?(\d+)?/);return[parseInt(q[1],10),parseInt(q[2],10),parseInt(q[3]||0,10)]}return null}());c=navigator.product==="Gecko"?(function(){var w=0,q=h.toLowerCase(),y=q.indexOf("rv:"),x=q.indexOf(")",y),t=q.substring(y+3,x),r=t.split("."),u=1,v,s;for(v=0;v<r.length;v+=1){s=parseInt(r[v],10);w+=s/u;u*=100}return w||0}()):0;n=c&&(h.indexOf("Fennec")>=0||h.indexOf("Maemo")>=0||h.indexOf("Android")>=0);l=o&&(h.indexOf("Mobile")>=0);a=(function(){var q;if(c){q="moz"}else{if(o){q="webkit"}else{if(f){q="o"}else{if(d){q="khtml"}else{if(b){q="ms"}}}}}return{css:q?"-"+q+"-":"",js:q?(q==="ms"?q:q.charAt(0).toUpperCase()+q.substring(1)):""}}());j={vendorPrefix:a,webkit:o,webkitMobile:l,khtml:d,chrome:i,opera:f,gecko:c,geckoMobile:!!n,ie:b,ios:e,iosVersion:m,supports:{nativeJSON:Object.prototype.toString.call(window.JSON)==="[object JSON]",cssOpacity:p("opacity","0.5"),cssBorderRadius:p("border-top-right-radius","10px"),cssTransitions:p("transition-duration","1s")||p(a.css+"transition-duration","1s"),cssTransforms:p("transform","scale(2)")||p(a.css+"transform","scale(2)"),cssColumnWidth:p("column-width","220px")||p(a.css+"column-width","220px"),placeholder:typeof document.createElement("input").placeholder==="string",textareaMaxLength:typeof document.createElement("textarea").maxLength==="number",inputSearch:(function(){try{var q=document.createElement("input");q.setAttribute("type","search");return q.type==="search"}catch(r){return false}}()),multiFile:(function(){if(i&&i<9||f&&f<11.1){return false}var q=document.createElement("input");q.type="file";return typeof q.multiple==="boolean"}()),editorPreInit:!l&&!(b&&b<7),dnd:!l&&!(b&&b<7)},updateBodyClass:function(q){var r=this;q=q||document.body;if(!r.supports.cssBorderRadius){k.addClass(q,"nobr")}if(r.supports.cssColumnWidth){k.addClass(q,"supports-columns")}if(r.webkit&&!k.hasClass(q,"webkit")){k.addClass(q,"webkit")}if(r.ios&&!k.hasClass(q,"ios")){k.addClass(q,"ios")}if(g.browser.ie&&g.browser.ie<=8){k.addClass(q,"ie8")}r.bugs.forEach(function(s){if(s.exists()){k.addClass(q,s.className)}})}};j.bugs=[{className:"webkit-bug13339",exists:function(){if(!o){return false}var t,s,q,r=false;s=document.createElement("table");s.innerHTML="<tbody><tr><td style='width:70px;padding-left:30px'><span style='display:inline-block;width:10px'></span></td></tr></tbody>";t=s.getElementsByTagName("td")[0];q=s.style;q.tableLayout="fixed";q.position="absolute";q.left=q.top=0;q.width="70px";document.body.appendChild(s);if(t.offsetWidth<100){r=true}document.body.removeChild(s);return r}}];g.browser=j}());(function(){var d=Inpl.Mail,f=d.DOM,e,b=new Gettext({domain:"inpl_mail_tools",locale_data:d.L10n}),g=function(l){return b.gettext(l)},a=[g("sty"),g("lut"),g("mar"),g("kwi"),g("maj"),g("cze"),g("lip"),g("sie"),g("wrz"),g("paź"),g("lis"),g("gru")],c={DONT_SEND:-1,UNCATEGORISED:{disabled:false,NEW_MESSAGE_BUTTON:"ctTgjU9t483UieY8vxb3TZR6fSuGPYdEcLGYs72qQ6f.V7",NEW_MESSAGE_TO:"zDtATXgL808ZmXYNYihHcLRJ31lWZ6_LECDq_g03gN7.j7",NEW_MESSAGE_ADD_ATTACHMENT:"zDFKsXh_z_izyb2PWWOrimYkPw1Z8m_4YbH6gHJRWFz.o7",CONTACTS_ADD_CONTACT:"ctTg7U9t405_VEa3vzQPTJR638OGPa9nEA3qfO1fKEf.j7",CONTACTS_ADD_GROUP:"zDrqkXgLv_ez5czh2bi78bRJPw1WZ2_4sId0Qr1PWLT.O7",CONTACTS_IMPORT_EXPORT:"zNFATXf_80958nYNcopH6GZWHUxZacbPwPHirEKRq0r.v7",CONTACTS_EDIT_CONTACT:"ctTq709tvzB02Sz_r9.DSZR6HQKGPccDptLCQrhXa3P.A7",CONTACTS_REMOVE_CONTACT:"zDrg63gL4xcZ40a34q6HbLPpfQtWd4c0sEcSFj0twxz.T7",CONTACTS_EDIT_GROUP:"zNFAS3f_8xgTRTwqMSqSP2ZW33lZaa_bYW7KlMps6Bv.f7",CONTACTS_REMOVE_GROUP:"ctVKT09tzzEeuRMR5wXPX5R6P4OGPW7Mpgka5hCd8Ev..7"},SIDEBAR:{disabled:false,CONTACTS:"1vXrsmNUZDpvuofLGIMPhNU731LB468Hp.BkgZUi1O3.s7"},MSGHEADER:{disabled:false,HISTORY:"1vXlFGNUCVZ5KyUt4LyHFNU7HZHB48ejBHRIQA1HZ4v.v7",BLOCK_SENDER:"zaBL0OrKdAREJX5gtZmSnscQ33Nkg68XKYhEFxxWlLz.Z7",ADD_TO_CONTACTS:"dw.rsIM7ZAOfu04quIxa6qbl33OUl68XH2pEFxc7b.D.v7",ORGANIZE:".KEwQfhnky0pL9wd6pwWJNU6.KjBLnCK_z5pAnIxpoP.V7",DELETE_FILTER:"nGE6RgfUb0ZTVrNEkUTLVNTarqvBPpra_x6bw0oNo3z.p7"},MSGLIST:{disabled:false,ENABLE_THREADING:"dwBL0oM7dDuplrfjgK.PpvVnHZKRzsejROpIQGTUPx..g7",DISABLE_THREADING:"d2BL0oO7dDtJId4LuDS6HKblfbuUl4bk6PESN5yk7vH.U7",ENABLE_MESSAGE_PREVIEW:"zU.ldutKCQ0KRA_4Fn874MbiHXJkCseTv4xI4L9bP3f.47",DISABLE_MESSAGE_PREVIEW:"d2.rsoO7ZDo.USfhgFi.v.VnfbuRzobkDnKYdOo970n.27",SAVE_AS_SEARCH_FOLDER:"d2BLcoO7dLufsbixOOXPwKbl3_mUl68ricPquyRPLOH.77"}},j={UNCATEGORISED:{NEW_MESSAGE_BUTTON:true}};e={checkParentFrames:function(){var l=true;if(top!==self&&self.location.pathname!=="/html/themepreview/"){try{if(top.TestRunner){top.TestRunner.isConnected=true}else{top.location.href=self.location.href;l=false}}catch(m){top.location.href=self.location.href;l=false}}return l},handleStartAction:function(l,m){switch(l){case"newMsg":if(m&&m.mailto){d.Composition.composeNew({mailto:m.mailto})}else{d.Composition.composeNew()}break;case"openMsg":d.Message.openUnlinked(m);break;case"contacts":d.ContactList.manage();break;case"importContacts":d.ContactList.showImportWizard();break;case"cntAdd":d.ContactList.showAddContactDialog();break;case"changeTheme":d.UI.Theme.choose();break}},overrideBeforeUnload:function(l){d.disableBeforeUnload=true;f.preventDefault(l||event);location.href=this.href;return false},showAd:function(n,o){var p,m="",l="";if(d.env.accountType===0){if(location.hash.indexOf("#inpltesterad")===0){m=location.hash}if(n==="side-ad"){l="<h5 class='sidebarItem side-ad-header'>Reklama</h5>"}p=$(n);if(!p.firstChild){p.innerHTML=l+"<iframe scrolling='no' allowTransparency=true height=0 frameBorder=0 src='/adv,adType,"+o+m+"'></iframe>"}}},showSideAd:function(){e.showAd("side-ad","box_ec_lewa_dol");e.showAd("side-chat-promo","poczta_166x75_2")},showBottomAd:function(){e.showAd("bottomAd","box_ec_prawa_dol")},hideBottomAd:function(){$("bottomAd").innerHTML=""},unique:function(m){var o,n,l=m.length,p=[];for(o=0;o<l;o+=1){for(n=o+1;n<l;n+=1){if(m[o]===m[n]){o+=1;n=o}}p.push(m[o])}return p},augment:function i(m,l){if(l){Object.keys(l).forEach(function(n){m[n]=l[n]})}},extendPrototype:function h(o,m,n){var l=Object.create(m.prototype);e.augment(l,n);l.constructor=o;o.prototype=l},ns:function(n){n=n.split(".");var l,m=window;for(l=0;l<n.length;l+=1){if(!m[n[l]]){m[n[l]]={}}m=m[n[l]]}return m},getCookie:function(o){var m=null,w=o+"=",v=w.length,u=document.cookie,p=u.length,s=0,q,t;while(s<p){q=s+v;if(u.substring(s,q)===w){t=u.indexOf(";",q);if(t===-1){t=u.length}m=unescape(u.substring(q,t));break}s=u.indexOf(" ",s)+1;if(!s){break}}return m},setCookie:function(o,q,r,p){var n,m,l;if(r){n=new Date();n.setTime(n.getTime()+(r*24*60*60*1000));m="; expires="+n.toGMTString()}else{m=""}q=escape(q);l=o+"="+q+m+"; path=/";if(p){l+="; domain="+p}document.cookie=l},getFlashMode:function(){return Math.max(this.Flash.getMajorVer()-3,0)},zeroPad:function(l){if(l<10){return"0"+l}else{return String(l)}},bytesToHRSize:function k(m,l){if(l===undefined){l=0}if(m>=1048576){return(m/1048576).toFixed(l).replace(/\./g,",")+" MB"}else{return(m/1024).toFixed(l).replace(/\./g,",")+" kB"}},HRSizeToBytes:function(l){var n,m=parseFloat(l.replace(/,/g,"."),10),o=l.substring(l.length-2,l.length).toLowerCase();switch(o){case"kb":n=1024;break;case"mb":n=1048576;break;case"gb":n=1073741824;break;default:n=1}return m*n},constructArrayElements:function(l,m){if(!l||typeof l!=="function"){throw new TypeError("first argument of constructArrayElements must be a constructor function")}if(!m||!m.sort){throw new TypeError("second argument of constructArrayElements must be an Array")}m.forEach(function(o,n,p){p[n]=new l(o)});return m},parseMailtoURL:function(m){if(!m){return null}if(m.indexOf("mailto:")<0){return undefined}m=m.substring(7,m.length);var r={},n,o,q,l=m.split("?");if(l[1]){o=l[1].split("&");r={};for(n=0;n<o.length;n+=1){q=o[n].split("=");r[q[0]]=decodeURIComponent(q[1])}}if(l[0]){if(!r.hasOwnProperty("to")){r.to=l[0]}else{r.to+=", "+decodeURIComponent(l[0])}}return r},formatDate:function(m,o){var l=new Date(),n=Inpl.Mail.Tools.zeroPad,p;if(!o){if(l.getDate()===m.getDate()&&l.getMonth()===m.getMonth()&&l.getFullYear()===m.getFullYear()){p=g("dziś,")+" "+n(m.getHours())+":"+n(m.getMinutes())}else{if(l.getFullYear()===m.getFullYear()){p=m.getDate()+" "+a[m.getMonth()]+", "+n(m.getHours())+":"+n(m.getMinutes())}else{p=m.getFullYear()+"-"+n(m.getMonth()+1)+"-"+n(m.getDate())}}}else{p=m.getFullYear()+"-"+n(m.getMonth()+1)+"-"+n(m.getDate())+" "+n(m.getHours())+":"+n(m.getMinutes())}return p},getUid:function(){return d.env.uid},setUid:function(l){d.env.uid=l},prepareFrameCheck:function(m,l){d.DOM.addFrameOnLoadEvent(m,function(){var n=d.Tabs,o=m.contentWindow.document.body;if(o.innerHTML.indexOf("nosession")===0){o.innerHTML="";l=l instanceof n.Tab?l:n.getById(l);if(l){l.close()}d.Network.showLoginForm()}})},truncateString:function(p,m,l,o){if(p.length<=m){return p}l=l!==undefined?l:"…";o=o||"e";var n;if(p.length>m){switch(o){case"s":n=l+p.substring(p.length-m,p.length);break;case"m":n=p.substring(0,m/2)+l+p.substring(p.length-m/2,p.length);break;default:n=p.substring(0,m)+l;break}}else{n=String(p)}return n},stripTags:function(l){return l.replace(/<\/?[^>]+>/gi,"")},decodeEntities:function(m){var l=document.createElement("textarea");l.innerHTML=m.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"\uE000");return l.value.replace(/\uE000/g,"\n")},removeSpecialChars:function(l){l=l.toLowerCase();return l.replace(/[^a-zA-Z _0-9ąćęłńóśżźĄĆĘŁŃÓŚŻŹäöüÄÖÜß]+/g,"").replace(/ /g,"_")},rgbToHex:function(m){var l=[];if(m.length>7){m=m.replace(/rgb|\s|\(|\)/gi,"");l=m.split(",").map(function(n){n=parseInt(n,10).toString(16);while(n.length<2){n="0"+n}return n});return"#"+l.join("")}else{return m}},shortHexColorToLong:function(o){var n,l,m="#";if(o.length!==4&&o.indexOf("#")<0){throw new Error("Wrong color value: wrong length or no #")}o=o.substring(1);for(n=0;n<3;n+=1){l=17*parseInt(o.charAt(n),16);if(isNaN(l)){throw new Error("Wrong color value: NaN during computations")}m+=l.toString(16)}return m},preparePost:function(m,l,p){try{var n,s,t=document.createDocumentFragment(),o=$("msg-opener-form"),u=document.getElementsByName(p)[0];if(u){u.preparePostParams=l;u.loaded=false;f.addEvent(u,"load",function q(){u.loaded=true;f.removeEvent(u,"load",q)})}if(o&&typeof o.appendChild==="function"){o.innerHTML=""}else{o=document.createElement("form");o.id="msg-opener-form";o.method="post";document.body.appendChild(o)}for(n in l){if(l.hasOwnProperty(n)){s=document.createElement("input");s.type="hidden";s.name=n;s.value=l[n];t.appendChild(s)}}o.appendChild(t);o.params=l;o.action=m;o.target=p}catch(r){}return o},isPreparePostCached:function(n,p,m){var o=window.location,l=o.protocol+"//"+o.host+n;if(m.action===l&&m.params&&m.params.mesg&&p.mesg&&m.params.mesg===p.mesg){return true}return false},preparePostCacheProxy:function(m,l){m=document.getElementsByName(m)[0];l=document.getElementsByName(l)[0];function o(){var s=l.contentDocument,q,p,r,t;if(s){for(index in this.contentDocument.childNodes){t=this.contentDocument.childNodes[index];if(t.nodeName==="HTML"){q=t;break}}s.open();for(r=0;r<q.childNodes.length;r++){t=q.childNodes[r];s.write(t.innerHTML||"")}s.close()}}if(m&&l){if(m.loaded){o.call(m)}else{f.addEvent(m,"load",function n(){f.removeEvent(m,"load",n);o.call(m)})}}},hitGemius:function(l){if(l===c.DONT_SEND){return}var m=l||Inpl.Mail.env.gemiusId;if(window.INTPL&&!Inpl.Mail.env.dev){INTPL("hitGemius",m)}},getGemiusByAlias:function(m,l){e.hitGFKbyAlias(m,l);if(c[m]&&!c[m].disabled){return c[m][l]||c.DONT_SEND}return c.DONT_SEND},hitGFK:function(){if(typeof gfkSst!="undefined"){gfkSst("poczta-PV_czesciowe")}},hitGFKbyAlias:function(m,l){if(j[m]&&j[m][l]){e.hitGFK()}},hitIWA:function(l){l=["trackEvent"].concat(l);if(window.location.host.indexOf(".mailv1.")!==-1){console.log("IWA",l)}else{if(iwa){iwa.apply(this,l)}}},escapeDiacritics:function(l){return l.replace(/ą/g,"a").replace(/Ą/g,"A").replace(/ć/g,"c").replace(/Ć/g,"C").replace(/ę/g,"e").replace(/Ę/g,"E").replace(/ł/g,"l").replace(/Ł/g,"L").replace(/ń/g,"n").replace(/Ń/g,"N").replace(/ó/g,"o").replace(/Ó/g,"O").replace(/ś/g,"s").replace(/Ś/g,"S").replace(/ż/g,"z").replace(/Ż/g,"Z").replace(/ź/g,"z").replace(/Ź/g,"Z")},MarketingPopup:{handleResponse:function(m){var l=["f_m_wojewodztwo","f_place","occupation","livPlace","f_above18","education","zipCode1","zipCode2","sex","birthYear","industry"];switch(m.status){case true:this.hide(false);break;case false:if(m.errors){d.UI.showNotice(g("Uzupełnij poprawnie dane marketingowe"),"error overlay-notice");l.forEach(function(o){var n=o.replace("f_","");if(m.errors.indexOf(n)<0){Inpl.Mail.DOM.removeClass($(o),"field-invalid")}else{Inpl.Mail.DOM.addClass($(o),"field-invalid")}})}else{d.UI.showNotice(g("Problem z zapisem danych marketingowych"),"error overlay-notice")}break}},hide:function(m){var l;this.dialog.hide();delete this.dialog;if(m){l=d.Prefs.get("showMarketingFormv3")+1;d.Prefs.set("showMarketingFormv3",l,true)}},rewriteDisabledFields:function(){$("m_wojewodztwo").value=$("f_m_wojewodztwo").value;$("place").value=$("f_place").value},show:function(o,n){this.dialog=Inpl.Mail.UI.ModalDialogs.richAlert({title:null,message:o,acceptLabel:n,additionalClass:"md-marketing-form",createButtons:function(){return[]}});function l(q){var p;if(q>=5&&q<=11){p=12-q}else{p=9}try{$("f_place").selectedIndex=p;$("f_place").disabled=true;$("place").value=p}catch(r){}}function m(r,p,q){l(q);var s=Array.filter($("f_m_wojewodztwo").options,function(t){return t.innerHTML===String(p)});if(s&&s[0]){s[0].selected=true;$("f_m_wojewodztwo").disabled=true;$("m_wojewodztwo").value=s[0].value}$("livPlace").value=r}d.UI.Suggestable.makeSuggestable($("livPlace"),{handleKey:function(){},render:function(s,r){var q,p=r.items;if(p.length){q=new d.UI.PopupMenu(r.items.map(function(t){return{label:t.title+" ("+t.desc+")",cmd:function(){m(t.title,t.desc,t.score)}}}),"livPlacePopup");q.show(s);this.pm=q}},keyDownHandler:function(){$("f_m_wojewodztwo").disabled=false;$("f_place").disabled=false},provideSuggestions:function(q,p){if(q&&q.length>0){Inpl.Mail.Network.jsonp({url:location.protocol+"//suggest.interia.pl/suggest/cities/?type=json&s="+encodeURIComponent(q),onSuccess:function(r){p(r)}})}}})}},portalToolbar:function(){var p=[f.elmsByClass("subMenuActivator",f.elmsByClass("userAccountLi")[0]),f.elmsByClass("subMenuActivator",$("webmailSettingsMainLi")),f.elmsByClass("dingHref",f.elmsByClass("widgetOff")[0])],q=[".FDlnvgnCUz4PE.5zcEIPpRMrmGGxJr41pBBSe.CVFf.D7","nFrr2wgxZHoo1vl3pcksi2X2DqtZeVtJWwDbtMdtrv3.J7","AutF.68uGU3DzHBPofxAyoYhnH4plbAz_6VJHccJUjb._7"],o,r=0,n,m;function l(){setTimeout(function(){if(!r&&f.elmsByClass("widgetOn")[0]){o=f.elmsByClass("dingHref",f.elmsByClass("widgetOn")[0]);if(o[0]){f.addEvent(o[0],"click",e.hitGemius.bind(e,q[2]));r=1;f.removeEvent(p[2][0],"click",l)}}},500)}for(n=0;n<p.length;n++){for(m=0;m<p[n].length;m++){f.addEvent(p[n][m],"click",e.hitGemius.bind(e,q[n]))}}f.addEvent(p[2][0],"click",l)},htmlEntities:function(l){return String(l).replace(/&/g,"").replace(/</g,"").replace(/>/g,"").replace(/"/g,"").replace(/'/g,"")}};d.Tools=e}());Inpl.Mail.Tools.Flash=(function(){var e=(navigator.appVersion.indexOf("MSIE")!=-1)?true:false,h=(navigator.appVersion.toLowerCase().indexOf("win")!=-1)?true:false,d=(navigator.userAgent.indexOf("Opera")!=-1)?true:false,k,f,l,i,j=null;function b(){var m,q;try{q=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");m=q.GetVariable("$version")}catch(s){}if(!m){try{q=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");m="WIN 6,0,21,0";q.AllowScriptAccess="always";m=q.GetVariable("$version")}catch(r){}}if(!m){try{q=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");m=q.GetVariable("$version")}catch(p){}}if(!m){try{q=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");m="WIN 3,0,18,0"}catch(o){}}if(!m){try{q=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");m="WIN 2,0,0,11"}catch(n){m=-1}}return m}function a(){var s=-1;if(navigator.plugins&&navigator.plugins.length){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var r=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"",m=navigator.plugins["Shockwave Flash"+r].description,q=m.split(" "),o=q[2].split("."),t=o[0],n=o[1],p=q[3];if(p==""){p=q[4]}if(p[0]=="d"){p=p.substring(1)}else{if(p[0]=="r"){p=p.substring(1);if(p.indexOf("d")>0){p=p.substring(0,p.indexOf("d"))}}}s=t+"."+n+"."+p}}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.6")!=-1){s=4}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.5")!=-1){s=3}else{if(navigator.userAgent.toLowerCase().indexOf("webtv")!=-1){s=2}else{if(e&&h&&!d){s=b()}}}}}return s}function g(){if(j===null){j=a()}return j}return{getVersion:g,getMajorVer:function c(){var m=g();if(m&&m.split&&e&&h&&!d){m=m.split(" ")[1]}if(m&&m.split){return parseInt(m.split(".")[0],10)}else{return -1}},isAtLeast:function(r,p,o){r=r||0;p=p||0;o=o||0;i=g();if(i==-1){return false}else{if(i!=0){if(e&&h&&!d&&i.indexOf("WIN")!==-1){k=i.split(" ");f=k[1];l=f.split(",")}else{l=i.split(".")}var q=l[0],m=l[1],n=l[2];if(q>parseFloat(r)){return true}else{if(q==parseFloat(r)){if(m>parseFloat(p)){return true}else{if(m==parseFloat(p)){if(n>=parseFloat(o)){return true}}}}}return false}}return false}}}());(function(){var a=Inpl.Mail;function b(c){this.items=[];this.size=c}a.Tools.augment(b.prototype,{add:function(c){this.items.unshift(c);this.items=this.items.slice(0,this.size)},getByField:function(g,f){var d=this.items,c=d.length,e;for(e=0;e<c;e+=1){if(String(d[e][g])===String(f)){return d[e]}}return null}});a.ArrayCache=b}());Inpl.Mail.Prefs=(function(){var a=Inpl.Mail,b={contactsView:"alpha",folderViewDetailed:true,theme:"a",previewShown:true,threadedView:0,attGalBubbleCnt:1,inboxFolderBubbleCnt:1,audioNotificationId:0,audioNotifPageSeen:0,isQuickFiltersDisabled:0,dontShowPopTrashBar:0},c={};return{init:function(d){if(d){b=d}},get:function(d){return b[d]},getAll:function(){var e={},d;for(d in b){if(b.hasOwnProperty(d)){e[d]=b[d]}}return e},set:function(e,g,f,d){if(b[e]!==g){b[e]=g;if(c[e]){clearTimeout(c[e]);delete c[e]}if(f){a.Prefs.store(e,d)}else{c[e]=setTimeout(function(){a.Prefs.store(e,d);delete c[e]},5000)}}return g},store:function(e,d){if(!e){throw new Error("Prefs.store: required argument missing")}var f={};f[e]=b[e];a.Network.ajax({url:"/html/writesetting",post:f,onSuccess:d})},storeAll:function(){a.Network.ajax({url:"/html/writesetting",post:b})}}}());(function(){var f=Inpl.Mail,a,c=f.Tools,k=f.DOM,l=k.createElement,q=k.addEvent,r=k.removeEvent,i=10,p=new Gettext({domain:"inpl_mail_message",locale_data:f.L10n}),u=function(v){return p.gettext(v)},o={none:"red",red:"green",green:"blue",blue:"none"};var s={ajax:function(x,z){var w="/html/gallery",B="post",A="";var y={mId:x,state:z};if(window.XMLHttpRequest){var v=new XMLHttpRequest()}else{var v=new ActiveXObject("Microsoft.XMLHTTP")}if(B=="post"){this.ajaxPost(v,w,y,A)}},ajaxPost:function(w,v,x,z){var y="mId="+x.mId+"&state="+x.state;w.open("POST",v,true);w.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");w.setRequestHeader("X-Requested-With","XMLHttpRequest");w.setRequestHeader("X-HTTP-Method-Override","PUT");w.setRequestHeader("X-XSRF-TOKEN",f.env.uid);w.send(y);w.onreadystatechange=function(){if(w.readyState===4&&w.status===200){var A=JSON.parse(w.response);if(!A.status){z(x.id,x.isStarred)}}else{if(w.readyState===4){z(x.id,x.isStarred)}}}}};function e(v){return document.createTextNode(v)}function h(w,x,y){y=y||event;if(k.hasClass(x,"attachments-videos-list")){return}var v=k.nodeListToArray(k.elmsByClass("att-img-link",x)).map(function(A){var z=A.getElementsByTagName("img")[0]||{};return{src:A.href,thumbSrc:z.getAttribute("data-inpl-src"),title:A.title}});Inpl.LoadableModules.require("Inpl.Mail.SlideShow",function(){f.SlideShow.open(v,w)});k.preventDefault(y);return false}function j(){var w=this,v=w.parentNode.relatedItem;v.switchFlag(function(x){w.className="msglist-flag "+x})}function t(C){var z=0,y,x,v,w=f.Tabs.getActiveTab().bodyElement,A=k.nodeListToArray(k.elmsByClass("attach-unseen",w))||{},B;if(A.length){z=k.getScrollXY()[1]+k.getWindowSize()[1];for(y=0;y<A.length;y++){B=A[y];v=B.offsetTop-B.clientHeight;if(v<z){x=B.getElementsByTagName("img")[0];x.src=x.getAttribute("data-inpl-src");k.removeClass(B,"attach-unseen")}else{break}}}}function m(x,v,w,y){y=y||w;if(v.length){x.appendChild(l("dt",{innerHTML:w,title:y}));x.appendChild(l("dd",{childNodes:Array.map(v,b)}));x.appendChild(l("br"))}}function g(x,w){var v=String(w.name||"unnamed-file.dat");return f.env.uploadUrl+"/html/getattach,mid,"+x+",mpid,"+w.mpid+",uid,"+c.getUid()+",/"+encodeURIComponent(v.trim())+"?f="+encodeURIComponent(v.trim())}function n(D,C,F){var J,H,G,x,w=F.msgId,I=u("zalacznik")+"_"+(1+C),z=F.relatedUl,v=D.name||I,E=D.shortName||I,A=f.env.staticUrl+"/image-loader.gif",B=f.env.uploadUrl+"/html/getattach,mid,"+w+",mpid,"+D.mpid+",min,1,uid,"+c.getUid(),y=g(w,D);x=l("span",{className:"attachment-name-inner",childNodes:e(E)});if(!F.disableThumbnails&&(D.shortType==="image"||D.shortType==="video")){J=l("li",{className:"attachments-images-list-item attach-unseen",childNodes:[l("span",{className:"attachments-images-list-item-inner",childNodes:[l("span",{className:"att-img-ctr-span",childNodes:G=l("a",{href:y,title:v,className:"att-img-link att-"+D.shortType,childNodes:[l("i",{className:"ie7-valign-fix"}),H=l("img",{src:A,alt:v}),l("span",{className:"att-badge"})]})}),x,l("br"),l("span",{className:"attachment-size",innerHTML:"("+D.size+")"})]}),l("ul",{className:"attachment-operations",childNodes:(D.shortType==="video"?[]:[l("li",{childNodes:l("a",{href:y,innerHTML:u("Wyświetl"),onclick:function(K){k.dispatchClickEvent(window,H);return k.preventDefault(K||event)}})})]).concat([l("li",{childNodes:l("a",{href:y,innerHTML:u("Zapisz"),onclick:f.Tools.overrideBeforeUnload})})])})]});G.onclick=h.bind(G,C,z);if(C<i){k.removeClass(J,"attach-unseen");H.src=B}H.setAttribute("data-inpl-src",B);if(D.thumbCount>1){[["template",B.replace(",min,1",",min,%1")],["max",parseInt(D.thumbCount,10)],["current",1]].forEach(function(K){H.setAttribute("data-thumb-"+K[0],K[1])});f.UI.FrameThumbnail.init(H)}}else{J=l("li",{className:"attachment-li",childNodes:[G=l("a",{className:"attachment-name",href:y,title:v,childNodes:[l("span",{className:"attachment-icon file-icon_"+D.shortType}),x],onclick:f.Tools.overrideBeforeUnload}),l("br"),l("span",{className:"attachment-size",innerHTML:"("+D.size+")"}),l("br"),l("ul",{className:"attachment-operations",childNodes:(D.shortType==="eml"&&F.folderId!==-1&&F.folderId!==2?[l("li",{childNodes:l("a",{href:y,innerHTML:u("Wyświetl"),onclick:function(K){k.dispatchClickEvent(window,G);return k.preventDefault(K||event)}})})]:[]).concat([l("li",{childNodes:[l("a",{href:y,innerHTML:u("Zapisz"),onclick:f.Tools.overrideBeforeUnload})]})])})]});if(D.shortType==="eml"&&F.folderId!==-1&&F.folderId!==2){G.onclick=function(K){K=K||event;(new a({id:w,mpid:D.mpid})).open();k.preventDefault(K);return false}}}return J}Inpl.Mail.Message=function a(w){if(!(this instanceof a)){return new a(w)}var v;this.id=null;this.folderId=0;this.seen=null;this.xflag="none";a.voucherCode=false;if(w){for(v in w){if(w.hasOwnProperty(v)){this[v]=w[v]}}}this.subject=this.subject||"";this.rawDate=new Date(1000*this.rawDate)};a=Inpl.Mail.Message;function d(y,x){var w;w=document.createDocumentFragment();if(y){var v=l("span",{className:"msglist-from-icon-padlock",title:u("Wiadomość została poprawnie zweryfikowana"),href:"#"});v.inplBubble=new f.UI.Bubble({content:l("div",{style:{width:"300px"},innerHTML:u("Ten symbol oznacza, że nadawca tej wiadomości został poprawnie zweryfikowany.")+"<br><a target=_blank href='http://pomoc.poczta.interia.pl/nhtml/news-oznaczenie-bezpieczny-nadawca,nId,2136371'>"+u("Dowiedz się więcej »")+"</a>"}),prefName:"dkimBubbleCnt",ownerElement:x});v.onclick=v.inplBubble.open.bind(v.inplBubble,v,"top-left",true,true,true);w.appendChild(v);return w}else{return w}}function b(z,x,v){var y=document.createDocumentFragment(),w=l("a",{href:"mailto:"+z.rfcString,onclick:function(A){A=A||event;Inpl.Mail.Composition.composeNew({mailto:decodeURIComponent(this.href)});k.preventDefault(A);return false}});w.appendChild(e(z.email));if(z.name){y.appendChild(e(z.name+" <"));y.appendChild(w);y.appendChild(e(">"))}else{y.appendChild(w)}if(v&&x!==undefined&&x<v.length-1){y.appendChild(e("; "))}return y}a.prototype={setSeen:function(w){this.seen=!!w;var v=f.FolderCache.get(this.folderId);if(v){v.invalidate()}},onMsgListRowClick:function(y,v){var w=f.Folders.getById(this.folderId)||f.Folders.getById(y.folder),z=this.relatedNode;function x(){var A=z.relatedItem?z.relatedItem.parentThread:null;if(k.hasClass(z,"ch")){k.removeClass(z,"ch");if(w){w.read++;w.unread--;w.updateView()}y.updateWinTitle()}if(A){A.updateReadStatus()}}if(v.shiftKey){y.activateMultiple(z)}else{if(v.ctrlKey){if(k.hasClass(z,"active")){y.deactivate(z)}else{y.activate(z,false)}}else{if(y.isPreviewShown){if(z.relatedItem&&(!k.hasClass(z,"active")||y.getActiveRows().length===1)){z.relatedItem.openPreview(y.htmlNodes.mailFrame,Inpl.Mail.Tabs.activeId,z);y.activate(z,true);x()}}else{if(y.folder!==-1){z.relatedItem.open()}else{z.relatedItem.edit()}if(k.hasClass(z,"ch")){x()}}if(z.relatedItem.parentThread){_gaq.push(["b._trackEvent","Wątkowanie","klik w wiadomość",f.Folders.getById(z.relatedItem.folderId).getFolderName()])}}}},onMsgListRowDblClick:function(w,v){if(this.folderId!==-1){this.open()}else{this.edit()}},getSubject:function(v){if(this.subject){if(v){return c.truncateString(this.subject,v)}else{return this.subject}}else{return u("Brak tematu")}},open:function(){if(this.tab){this.tab.show();return}var w,v,x,z,A,y=Inpl.Mail.Tabs.nextId;Inpl.Network.onShowProgress();this.setSeen(true);x=l("iframe",{id:"mailFrame_"+y,name:"mailFrame_"+y});c.prepareFrameCheck(x,y);x.frameBorder=0;x.width="100%";x.src="about:blank";x.message=this;v=l("div",{id:"view;"+this.id+";"+this.folderId+";"+y,className:"viewEm",childNodes:[l("div",{id:"emHead_"+y,className:"emHeader"}),x,l("div",{id:"emFoot_"+y})]});z=this.subject.length?this.subject:u("(brak tematu)");w=new f.Tabs.Tab(z,v);w.mail=this;w.onAfterOpen=function(){this.makeButtons();f.Tools.showBottomAd()}.bind(this);w.onAfterClose=function(){delete this.tab;f.Tools.hideBottomAd()}.bind(this);w.onBeforeHide=function(){f.Tools.hideBottomAd();return true};w.show();A={folder:this.folderId,mesg:this.id,tabid:y,uid:c.getUid()};if(this.mpid){A.mpid=this.mpid}c.preparePost("/html/getmail,imgProtectedStatus,1",A,"mailFrame_"+y).submit();this.makeButtons();this.tab=w},makeButtons:function(){var x=this.folderId===-2,v=this,w=[{ident:"responseT",label:u("Odpowiedz"),cmd:v.edit.bind(v,"res")},{ident:"responseAllT",label:u("Odp. wszystkim"),cmd:v.edit.bind(v,"resAll")},{ident:"forwardT",label:u("Prześlij dalej"),cmd:v.edit.bind(v,"forw")},"|",{ident:"moveMsg",label:u("Przenieś"),cmd:v.showMoveDialog.bind(v,!this.isMailing&&this.fromEmail),disabled:!!v.mpid},{ident:"removeBtn",label:u("Usuń"),cmd:function(){var y=v.isMailing&&f.env.accountType===0;v.remove(y);if(y){f.MessageList.currentList.showRemoveMailingNotice()}if(f.Folders.getOfferFolderId()==v.folderId){c.hitIWA(["html","oferty","-","przenies","pojedynczy_mail","kosz"])}else{if(f.Folders.getSocialFolderId()==v.folderId){c.hitIWA(["html","spolecznosci","przenies","pojedynczy_mail","kosz"])}}},disabled:!!v.mpid},{ident:x?"noSpamT":"spamT",label:x?u("To nie jest spam"):u("Uznaj za spam"),cmd:function(){var z=v.isMailing&&f.env.accountType===0;if(v.isOffer||v.isVoucher){var y=l("div",{className:"notice--offerSpamInfo",childNodes:[l("span",{innerHTML:"Ta wiadomość nie jest spamem.<br>Możesz wyłączyć folder Oferty w "}),l("a",{innerHTML:"Ustawieniach",href:"https://ustawienia.interia.pl/poczta/filtry",target:"_blank"})]});f.UI.showNotice(y,"error",5000,true)}else{v.switchSpamStatus(z);if(z){f.MessageList.currentList.showSpamMailingNotice()}else{if(!v.isMailing&&!f.QuickFilters.DISABLE_FOR_MOVING_TO_SPAM&&!f.Prefs.get("isQuickFiltersDisabled")){f.QuickFilters.showFilterPrompt(v.fromEmail,x?1:-2)}}}if(f.Folders.getOfferFolderId()==v.folderId){c.hitIWA(["html","oferty","-","przenies","pojedynczy_mail","spam"])}else{if(f.Folders.getSocialFolderId()==v.folderId){c.hitIWA(["html","spolecznosci","przenies","pojedynczy_mail","spam"])}}},disabled:!!v.mpid},"|",{ident:"printBtn",label:u("Drukuj"),cmd:v.print.bind(v)}];f.UI.injectButtons(w,"nav1");f.UI.injectButtons(w,"bottIco")},fitToHeight:function(A,x){var v=A.document,y=A.frameElement,z=(this.attachments||x)?70:200,w;if(y){y.style.height=z+"px";if(v.compatMode==="CSS1Compat"){w=Math.max(v.documentElement.offsetHeight,v.body.offsetHeight)}else{if(f.browser.ie&&(f.browser.ie<9)){w=Math.max(v.documentElement.scrollHeight,v.body.scrollHeight)}else{if(f.browser.webkit){y.style.height=z+"px"}w=Math.max(v.documentElement.offsetHeight,v.body.offsetHeight)}}y.style.height=Math.min(32765,(Math.max(z,w)))+"px"}},openPreview:function(x,w){try{if(x.messageId==this.id){return}x.message=this;this.setSeen(true);Inpl.Network.onShowProgress();c.preparePost("/html/getmail,imgProtectedStatus,1",{folder:this.folderId,mesg:this.id,tabid:w,uid:c.getUid()},x.name).submit();x.messageId=this.id;c.showBottomAd();f.Tools.hitGFK()}catch(v){}},edit:function(w,v){f.Composition.editMessage(this,w||"edit",v);f.Tools.hitGFK();if(w=="resAll"){if(f.Folders.getOfferFolderId()==this.folderId){c.hitIWA(["html","oferty","-","odpowiedz_wszystkim","-"])}else{if(f.Folders.getSocialFolderId()==this.folderId){c.hitIWA(["html","spolecznosci","odpowiedz_wszystkim","-"])}}}},showMoveDialog:function(v){f.Folders.chooseFolder(u("Przenieś wybrane wiadomości"),u("Przenieś wiadomości do folderu:"),u("Przenieś"),this.move.bind(this),this.folderId,v||null)},move:function(x,A,y){if(x.id===-2){return this.switchSpamStatus(y)}var z=f.Folders.getById(this.folderId),v=x.id===3?u("Wiadomość została przeniesiona do kosza"):Gettext.strargs(u("Wiadomość została przeniesiona do folderu „%1”"),x.name),w=[this.folderId,x.id];f.Network.ajax({url:"/html/movemesg,srcfolder,"+this.folderId+",dstfolder,"+x.id+",mesg,"+this.id+"|"+this.folderId,onSuccess:function(B,C){if(!y){f.UI.showNotice(v)}this.folderId=x.id;if(z){z.needsRefresh=true}if(x){x.needsRefresh=true}f.FolderCache.invalidateFolder(z.id);f.FolderCache.invalidateFolder(x.id);f.Folders.retrieveAndMark(w);if(A){A()}}})},switchSpamStatus:function(w){var x=this,v=f.Folders.getById(this.folderId),y=x.fromEmail,A=this.folderId===-2,D=A?u("Usunięto oznaczenie wiadomości jako spam"):u("Wiadomość została oznaczona jako spam"),B=A?null:f.Folders.getById(-2),z=B?[this.folderId,B.id]:[this.folderId];function C(){f.Network.ajax({url:"/html/setspam,param,"+x.id+",folder,"+x.folderId,onSuccess:function(E,F){if(!w){f.UI.showNotice(D)}if(v){v.needsRefresh=true}if(B){B.needsRefresh=true}f.FolderCache.invalidateFolder(v.id);f.FolderCache.invalidateFolder(B.id);f.Folders.retrieveAndMark(z);x.tab.close();f.Folders.retrieve()}})}if(!A){f.ContactsWarnList.doAction(y,u("Czy w dalszym ciągu chcesz przenieść tę wiadomość do folderu Spam?"),C)}else{C()}},remove:function(v){var x=this,w=x.tab;if(this.folderId!==3){f.FolderCache.invalidateFolder(this.folderId);f.FolderCache.invalidateFolder(3);this.move(f.Folders.getById(3),this.tab.close.bind(this.tab),v)}else{f.UI.ModalDialogs.confirm({message:u("Czy usunąć nieodwracalnie tę wiadomość?"),title:u("Potwierdzenie usunięcia"),acceptLabel:u("Usuń"),onAccept:function(){f.Network.ajax({url:"/html/delmail,real,1,folder,"+x.folderId+",param,"+x.id,onSuccess:function(y,z){f.FolderCache.invalidateFolder(3);if(!v){f.UI.showNotice(u("Wiadomość została usunięta"))}f.Folders.getById(3).needsRefresh=true;w.close()}})}})}},print:function(){(new f.PrintPreview({msgId:this.id,mpid:this.mpid,folderId:this.folderId,allowExternalContent:this.allowExternalContent,voucherCode:a.voucherCode})).open()},createSnippetNode:function(){var z=this.snippet,v=[],y,w,x;z=z.split(/[\u0002\u0003]/g);for(x=0;x<z.length;x++){y=e(z[x]);if(x%2===0){v.push(y)}else{v.push(l("mark",{childNodes:y}))}}return l("div",{className:"msg-snippet",childNodes:v})},createMsgListTableRow:function(F,A,K,H,E){K=K||"";var L=this,v,y,J,B,x="";v=L.fromName?L.fromName:L.fromEmail;function z(N){var M;if(N){M=l("span",{title:u("Wiadomość została poprawnie zweryfikowana"),className:"msglist-from-icon-padlock"});return M}else{M=l("span",{});return M}}y=l("td",{className:"msglist-from",childNodes:[l("div",{childNodes:[z(L.senderInfo.DKIM),v||u("(brak odbiorcy)")]})],title:L.fromEmail||L.senderEmail||L.fromName});if(!v){k.addClass(y,"no-value")}B=l("td",{className:L.subject.length?"msglist-subject":"msglist-subject no-value",childNodes:L.subject.length?[l("div",{childNodes:e(L.subject)})]:[l("div",{childNodes:e(u("(brak tematu)"))})],title:L.subject.length?L.subject:u("(brak tematu)")});if(L.snippet){B.appendChild(this.createSnippetNode())}var D="";if(L.priority){D+="<span class=msg-priority-"+L.priority+"></span>"}if(L.attachments){D+="<span class=msg-hasatt></span>";k.addClass(B,"att")}if(this.parentThread&&this.parentThread.folderId!=this.folderId){K+=" msg-otherfld"}var C="";if(L.answered||L.forwarded){if(L.answered&&L.forwarded){C="msg-status-fwd-re"}else{if(L.answered){C="msg-status-re"}else{if(L.forwarded){C="msg-status-fwd"}}}}var w=l("span",{className:"msg-status "+C});var I=l("tr",{className:["msglist-msg-tr",(!L.seen&&L.folderId!=-1)?"ch":"",K].join(" "),id:"mailsTable_"+A.id+"_item_"+F,inpl_index:F,childNodes:[l("td",{className:"msglist-check",childNodes:[l("input",{type:"checkbox",title:u("Zaznacz/odznacz wiadomość"),onclick:E,ondblclick:function(M){M.stopPropagation()},className:"undraggable"})]}),l("td",{className:L.xflag?"msglist-flag "+L.xflag:"msglist-flag none",innerHTML:"<span></span>",onclick:j}),l("td",{className:"msglist-threads",childNodes:w}),y,B,l("td",{className:"msglist-prioatt",innerHTML:D}),l("td",{className:"msglist-date",title:c.formatDate(L.rawDate,true),childNodes:[e(c.formatDate(L.rawDate))]}),l("td",{className:"msglist-size",childNodes:[e(f.Tools.bytesToHRSize(L.size))]})]});if(H){try{x=f.Folders.getById(L.folderId).name}catch(G){x="?"}J=l("td",{className:"msglist-folder",childNodes:l("div",{childNodes:[document.createTextNode(c.truncateString(x,13))]})});I.insertBefore(J,B)}I.relatedItem=L;return I},switchFlag:function(v){var x=this,w=this.xflag,y=o[w];v=v||function(){};v(y);x.xflag=y;if(this.parentThread){this.parentThread.calculateFlag()}f.Network.ajax({url:"flagmsg,param,"+this.id+",xflag,"+y+",folder,"+this.folderId,onSuccess:function(z){f.FolderCache.invalidateFolder(x.folderId);z=f.Network.parseResponse(z);if(!z.status){x.xflag=w;v(w);f.UI.showNotice(u("Błąd podczas ustawiania flagi dla wiadomości"),"error")}}})},displayAttachments:function(I,R,O,x,W){R=R||[];O=O||[];x=x||[];var D=this,M,G,E,A,B,Q,K,U,y,w=this.id,S,F,H,z,L,v=$("emHead_"+W),P=$("emFoot_"+W),T,J,V;R.msgId=O.msgId=x.msgId=w;R.folderId=O.folderId=x.folderId=this.folderId;if(O.length){J=l("ul",{className:"attachments-images-list"})}if(x.length){V=l("ul",{className:"attachments-images-list attachments-videos-list"})}O.relatedUl=J;x.relatedUl=V;R.disableThumbnails=true;G=Array.map(O,n);E=Array.map(x,n);M=Array.map(R,n);A=E.length+R.length+O.length;function C(){U=[d(I,v),l("span",{className:"",childNodes:[l("span",{childNodes:[u("Ta wiadomość pochodzi od Bezpiecznego Nadawcy - ")]}),l("a",{href:"http://pomoc.poczta.interia.pl/nhtml/news-oznaczenie-bezpieczny-nadawca,nId,2136371",target:"_blank",childNodes:[u("Dowiedz się więcej")]})]})];K=l("div",{className:"message-att-info",childNodes:U});return K}if(A){P.innerHTML="<hr class='message-footer-hr'>";P.className="message-footer-section";F=[];if(G.length){G.forEach(function(X){J.appendChild(X)});F.push(J);if(G.length>i){q(window,"scroll",t)}}if(E.length){E.forEach(function(X){V.appendChild(X)});F.push(V)}if(M.length){F.push(l("ul",{className:"attachments-other-list",childNodes:M}))}H=[d(I,P),l("span",{className:"attachment-caption-safety",childNodes:[u("Załączniki od Bezpiecznego Nadawcy - ")+A]})];S=l("div",{className:"attachments-section",childNodes:F});B=[l("a",{href:"#",className:"attach-count message-att-operation",childNodes:[l("b"),l("span",{childNodes:[u("Liczba załączników:")+" "+A]})],onclick:function(X){S.scrollIntoView();k.preventDefault(X||event);return false}})," "];if(A>1){B.push(z=l("a",{className:"attach-saveall message-att-operation",href:f.env.uploadUrl+"/html/getattach,mid,"+w+",all,1,fid,"+this.folder+",uid,"+c.getUid()+"?f="+encodeURIComponent(a.stringToZipName(this.subject)+".zip"),childNodes:[l("b"),l("span",{childNodes:u("Zapisz wszystkie")})]}))}else{if(G.length){T=O[0]}else{if(E.length){T=x[0]}else{T=R[0]}}B.push(l("a",{className:"attach-saveall message-att-operation",href:g(w,T),childNodes:[l("b"),l("span",{childNodes:u("Zapisz załącznik")})],onclick:f.Tools.overrideBeforeUnload}))}Q=l("div",{className:"message-att-info",childNodes:B});y=l("div",{className:"message-att-info",childNodes:H});if(k.hasClass(v.firstChild.lastChild,"imgProtect")){v.firstChild.insertBefore(Q,v.firstChild.lastChild);if(I){v.firstChild.insertBefore(C(),v.firstChild.lastChild)}}else{v.firstChild.appendChild(Q);if(I){v.firstChild.appendChild(C())}}if(z){L=z.cloneNode(true);z.onclick=L.onclick=f.Tools.overrideBeforeUnload;S.appendChild(L)}if(I){P.appendChild(y)}P.appendChild(S);if(f.browser.ie&&f.browser.ie<9){var N;if(J){N=k.nodeListToArray(J.getElementsByTagName("img"))}else{N=[]}if(V){N=N.concat(k.nodeListToArray(V.getElementsByTagName("img")))}N.forEach(function(X){X.removeAttribute("width");X.removeAttribute("height")})}P.style.display="block"}else{if(I){P.innerHTML="<hr class='message-footer-hr'>";P.className="message-footer-section";v.firstChild.insertBefore(C(),v.firstChild.lastChild)}else{P.innerHTML="";P.style.display="none"}}},displayMessageData:function(ab,C,T){var J=this,H,X,y,R,S,U,K="",ac,O,I,E,P,L,w,V,v,B,Z=[],aa,G,Q,A,z,W;ab.date=new Date(1000*ab.date);ab.from.email=ab.from.email||"";Inpl.Network.onHideProgress();y=$("emHead_"+ab.tabId);R=$("emFoot_"+ab.tabId);f.DOM.removeClass(y,"hide");f.DOM.removeClass(R,"hide");X=document.createDocumentFragment();Z.push(d(ab.senderInfo.DKIM,y));Z.push(b(ab.from));O=l("div",{className:"emHead",childNodes:[l("span",{className:"message-date",innerHTML:"<b>"+u("Data:")+" </b>"+c.formatDate(ab.date,true)}),l("span",{className:"header-switch",innerHTML:" ",title:u("Wyświetl/ukryj pełny nagłówek"),onclick:(function(ad){return function(){f.Message.switchHeaderDetails(this,$("extHead"+ad));return false}}(ab.tabId))})]});U=f.ContactList.list.length<200?f.ContactList.getByField("email",ab.from.email):null;if(U){K=U.getPictureURL(true);if(K){ac=new Image();ac.src=K;O.appendChild(ac)}}if(ab.subject.length){E=ab.subject;P="emSubject"}else{E=u("(brak tematu)");P="emSubject no-value"}if(J.tab){J.tab.setTitle(E)}L=e(E);O.appendChild(l("span",{className:P,childNodes:[L]}));if(ab.from.email!==Inpl.Mail.env.ownEmail){Z.push(H=l("a",{className:"msg-cnt-action msg-cnt-history",innerHTML:"<span></span><b>"+u("Historia")+"</b>",title:u("Wyświetl historię korespondencji"),href:"#",onclick:(function(ad){return function(){f.Contact.prototype.openHistoryTab.call({email:ad});f.Tools.hitGemius(f.Tools.getGemiusByAlias("MSGHEADER","HISTORY"))}}(ab.from.email))}));if(!Inpl.Mail.ContactList.getByField("email",ab.from.email,false,true)){Z.push(l("a",{className:"msg-cnt-action add2Cnt",innerHTML:"<span></span><b>"+u("Dodaj do kontaktów")+"</b>",title:u("Dodaj nadawcę do kontaktów"),href:"#",onclick:(function(ae,ad){return function(){f.ContactList.addContactSimple(ae,ad);f.Tools.hitGemius(f.Tools.getGemiusByAlias("MSGHEADER","ADD_TO_CONTACTS"));return false}}(ab.from.email,ab.from.name||ab.from.email.split("@")[0]))}))}G=f.Blacklist.checkEmail(ab.from.email);Z.push(l("a",{className:"msg-cnt-action blockSender "+ab.from.email,innerHTML:"<span></span><b>"+(G?u("Odblokuj nadawcę"):u("Zablokuj nadawcę"))+"</b>",title:G?u("Usuń z zablokowanych"):u("Dodaj do zablokowanych"),href:"#",onclick:(function(ad,ae){if(ab.isMailing&&f.env.accountType===0){return function(){f.MessageList.currentList.showMailingBlockNotice(function(){if(f.Blacklist.checkEmail(ad)){f.ContactList.removeEmailFromBlackList(ad)}else{f.ContactList.addEmailToBlackList(ad);f.Tools.hitGemius(f.Tools.getGemiusByAlias("MSGHEADER","BLOCK_SENDER"))}return false})}}else{return function(){if(f.Blacklist.checkEmail(ad)){f.ContactList.removeEmailFromBlackList(ad)}else{if(ae){f.Views.openUnsubscribeDialog(ae,function(){f.ContactList.addEmailToBlackList(ad)},function(){f.ContactList.addEmailToBlackList(ad)})}else{f.ContactList.addEmailToBlackList(ad)}}f.Tools.hitGemius(f.Tools.getGemiusByAlias("MSGHEADER","BLOCK_SENDER"));return false}}}(ab.from.email,ab.viewFilterId))}));if(!ab.isMailing&&!(ab.fid===-2&&!f.QuickFilters.getFilterNumber(ab.from.email))){var N,F;W=f.QuickFilters.getFilterNumber(ab.from.email);Z.push(N=l("a",{className:"msg-cnt-action msg-cnt-quickfilter",innerHTML:"<span></span><b>"+(!W?u("Porządkuj"):u("Usuń filtr"))+"</b>",title:(!W?u("Porządkuj"):u("Usuń filtr")),href:"#",onclick:function(){if(f.env.viewsActive){var ad=k.hasClass(document.body,"shv-enabled"),ae=k.hasClass(document.body,"sov-enabled")}W=f.QuickFilters.getFilterNumber(ab.from.email);if(!W){f.QuickFilters.showCustomFilterPrompt(ab.from.email,function(){W=f.QuickFilters.getFilterNumber(ab.from.email);N.innerHTML="<span></span><b>"+u("Usuń filtr")+"</b>"},function(af){J.move(af,function(){f.MessageList.currentList.refresh()})});f.Tools.hitGemius(f.Tools.getGemiusByAlias("MSGHEADER","ORGANIZE"))}else{f.QuickFilters.showDeleteFilterPrompt(ab.from.email,function(){W=null;N.innerHTML="<span></span><b>"+u("Porządkuj")+"</b>"});f.Tools.hitGemius(f.Tools.getGemiusByAlias("MSGHEADER","DELETE_FILTER"))}return false}}));f.PromotionQueue.insert(function(){f.promotions.bubble.quicFiltersSender(N)},f.PromotionQueue.TYPE.BUBBLE)}}S=l("dl",{childNodes:[l("dt",{innerHTML:u("Od:")}),l("dd",{childNodes:Z}),l("br")]});[[ab.to,u("Do:")],[ab.cc,u("DW:"),u("Do wiadomości")],[ab.bcc,u("UDW:"),u("Ukryte do wiadomości")],].forEach(function(ad){m.apply(null,[S].concat(ad))});O.appendChild(S);I=l("div",{className:"hide extHead",id:"extHead"+ab.tabId,innerHTML:"<ul>"+ab.headers+"</ul>"});O.appendChild(I);function Y(ad){J.allowExternalContent=true;a.showHiddenImages(C);ad.parentNode.parentNode.removeChild(ad.parentNode)}if(1==ab.imgProtect&&!J.allowExternalContent&&!ab.senderInfo.DKIM){w=l("div",{className:"imgProtect",id:"imgProtect"+ab.tabId,innerHTML:u("Ze względów bezpieczeństwa obrazki zostały zablokowane - "),childNodes:[l("a",{className:"imgProtectShow",innerHTML:u("Wyświetl obrazki"),href:"#",onclick:function(){if(f.Folders.getOfferFolderId()==J.folderId){c.hitIWA(["html","oferty","-","pokaz_obrazki","-"])}else{if(f.Folders.getSocialFolderId()==J.folderId){c.hitIWA(["html","spolecznosci","-","pokaz_obrazki","-"])}}return !!Y(this)}})]});imgProtectDisplayAll=l("span",{childNodes:[l("span",{className:"pipe",innerHTML:"|"}),l("a",{className:"imgProtectShow",innerHTML:u("Zawsze wyświetlaj obrazki od tego nadawcy"),href:"#whitelist",onclick:function(){f.ContactList.addEmailToWhiteList(J.fromEmail);if(f.Folders.getOfferFolderId()==J.folderId){c.hitIWA(["html","oferty","-","pokaz_obrazki_zawsze","-"])}else{if(f.Folders.getSocialFolderId()==J.folderId){c.hitIWA(["html","spolecznosci","-","pokaz_obrazki_zawsze","-"])}}return !!Y(this)}})]});if(this.folderId!=-2){w.appendChild(imgProtectDisplayAll)}O.appendChild(w)}aa=ab.deliveryReport;X.appendChild(O);y.innerHTML="";y.appendChild(X);this.displayAttachments(ab.senderInfo.DKIM,ab.mimeParts,ab.mimePartsThumb,ab.mimePartsVideo,ab.tabId);if(aa){X=document.createDocumentFragment();Array.forEach(aa.failures,function(ad){X.appendChild(a.createFailureBar(ad,aa))});y.lastChild.appendChild(X)}if(ab.senderInfo.DKIM&&B){B.inplBubble.open(B,"top-left",true,false,true)}galleryState=ab.gallery.state;if(ab.fid==2&&(galleryState==1||galleryState==2||ab.gallery.content)){var x=this.id,R=$("emFoot_"+ab.tabId),M=R.getElementsByClassName("message-footer-hr")[0];if(galleryState==1||galleryState==0||galleryState==2){var D=document.createElement("div");D.innerHTML=ab.gallery.content;D.className="publicGalleryPanelSending";D.id="pg_"+ab.tabId}setTimeout(function(){c.hitGemius(".W01lmthueH5fH.hCTEQhKQ933mGPa_bWX.KJYCQb.L.I7");if((galleryState==1||galleryState==0)){R.insertBefore(l("span",{className:"attPublicGalleryPanel",innerHTML:'<p>Wszystkie wysłane przez Ciebie zdjęcia i inne pliki graficzne będą prezentowane adresatom w&nbsp;atrakcyjny sposób.\n                        Galeria w treści maila nie tylko wyróżni Twoją wiadomość, ale też sprawi, że przeglądanie zdjęć będzie jeszcze wygodniejsze i możliwe w programach pocztowych. <a href="http://info.poczta.interia.pl/pomoc/artykuly,2209523" target="_blank" class="read-more-gallery">Dowiedz się więcej.</a></p>',childNodes:[l("div",{className:"galleryButton"+(galleryState==0?" btnGalleryOff":""),id:"galleryButton_"+ab.tabId,childNodes:[l("p",{innerHTML:"Opcje"})]})],onclick:function(){showGalleryPopupMenuIsSending(ab.tabId,x)}}),M)}else{if(galleryState==2){R.insertBefore(l("span",{className:"attPublicGalleryPanel attPublicGalleryPanel--block",innerHTML:'<p><span>UWAGA!</span> Wszystkie wysłane przez Ciebie zdjęcia i inne pliki graficzne będą prezentowane adresatom w atrakcyjny sposób.\n                        Galeria w treści maila nie tylko wyróżni Twoją wiadomość, ale też sprawi, że przeglądanie zdjęć będzie jeszcze wygodniejsze i możliwe w programach pocztowych. <a href="http://info.poczta.interia.pl/pomoc/artykuly,2209523" target="_blank" class="read-more-gallery">Dowiedz się więcej.</a></p>',childNodes:[l("div",{className:"galleryButtonBlock",id:"galleryButton_"+ab.tabId,childNodes:[l("p",{innerHTML:"Galeria zablokowana"})]})]}),M)}}R.insertBefore(D,M)},0)}showGalleryPopupMenuIsSending=function(ae,ad){var af=[u("Zobacz jak wygląda galeria"),u("Wyłącz galerię dostępną pod linkiem"),u("Dowiedz się więcej o galerii")],ag=document.getElementById("inpl_public_gallery_menu_"+ae),ai=this;var ak=af.map(function(ao,an){return{label:ao}});ak[0].specialElement=l("a",{target:"_blank",onclick:function(){c.hitGemius("nS07Mnu_FJCJlomagY.cmJZWP4MpLG7MPqca_a7OxEv.s7")},href:"/next/gallery/preview?uid="+Inpl.Mail.env.uid+"&mId="+ad});ak[1].specialElement=l("a",{onclick:function(){var an=document.getElementById("galleryButton_"+ae);if(ai.galleryState===1){s.ajax(ad,0);ai.galleryState=0;c.hitGemius("ncebkHusJFq.4VN9qSvhfHZHfStZ4odE1CSYRFHIbx..47");an.className+="btnGalleryOff"}else{if(galleryState===0){s.ajax(ad,1);ai.galleryState=1;an.className=an.className.replace("btnGalleryOff","")}}},href:"#"});ak[2].specialElement=l("a",{target:"_blank",onclick:function(){c.hitGemius(".c2bkmrRJJGvfLmuKTGcBKSdfQuGLYc0ueHy3aBULyv.L7")},href:"http://info.poczta.interia.pl/pomoc/artykuly,2209523"});if(!ag){var am=document.getElementById("galleryButton_"+ae);new f.UI.PopupMenu(ak,"inpl_public_gallery_menu_"+ae,false,am.id).show(am);var aj=document.querySelector("#inpl_public_gallery_menu_"+ae+" ul .ctxMLiEnabled:nth-child(2) a"),ah=document.querySelector("#inpl_public_gallery_menu_"+ae+" ul .ctxMLiEnabled:nth-child(1)"),al=document.getElementById("inpl_public_gallery_menu_"+ae);al.style.top=f.DOM.findPos(am)[1]+30+"px";al.style.left=f.DOM.findPos(am)[0]-142+"px";if(ai.galleryState===1){aj.innerHTML="Wyłącz galerię dostępną pod linkiem";document.querySelector("#inpl_public_gallery_menu_"+ae+" ul .ctxMLiEnabled:nth-child(2)").className="ctxMLiEnabled";ah.className="ctxMLiEnabled"}else{if(ai.galleryState===0){aj.innerHTML="Włącz galerię dostępną pod linkiem";document.querySelector("#inpl_public_gallery_menu_"+ae+" ul .ctxMLiEnabled:nth-child(2)").className="ctxMLiEnabled turnGallery";ah.className="ctxMLiEnabled galleryOff"}}}else{f.UI.PopupMenu.hideAll()}}}};a.addInteriaVerifiedLinkHandlers=function(x){var w=k.elmsByClass("inplwelcome-replaced",x.document.body),v;v={importContacts:function(y){y=y||event;f.ContactList.showImportWizard();return k.preventDefault(y)},changeTheme:function(y){y=y||event;f.UI.Theme.choose();return k.preventDefault(y)}};Array.forEach(w,function(z){var y=(/openTab,([a-zA-Z]+)/g).exec(z.href);if(y.length==2){k.addEvent(z,"click",v[y[1]]);z["data-inpl-handlerName"]=y[1]}})};a.voucherCode=false;a.addVoucherHandlers=function(w){var v=w.document.getElementById("inpl-get-voucherCode");v.onclick=function(y){var z=v.href.split("/"),x=z[z.length-1];f.Network.ajax({url:"/html/offer,offerHash,"+x,onSuccess:function(C){C=f.Network.parseResponse(C);if(C.status){var D=C.data.code,B=barcode(D,"code128"),A=document.createElement("div"),E=document.createElement("div");A.className="voucher-code";A.innerHTML=D;E.className="barcode-container";E.appendChild(B);A.appendChild(E);(v.parentNode).appendChild(A);v.parentNode.removeChild(v);a.voucherCode=D}else{f.UI.showNotice(C.msg)}},onError:function(){f.UI.showNotice("Nie udało się pobrać kodu")}});y.preventDefault()}};a.addOfferHandlers=function(v){var w=v.document.getElementById("inpl-offer-link");w.onclick=function(){iwa("trackEvent","Kody_rabatowe","Oferty","klik_w_mail","kody",w.getAttribute("href"))}};a.createFailureBar=function(v,z){var A,x,C,w,y,B=Array.map(v.addresses,function(D){return"<a onclick='Inpl.Mail.Composition.composeNew({mailto:this.href});return false' href='mailto:"+D+"'>"+D+"</a>"}).join(", ");if(v.addresses.length>1){x=u("Wiadomość wysłana %1 o godzinie %2 nie dotarła na adresy: %3.")}else{x=u("Wiadomość wysłana %1 o godzinie %2 nie dotarła na adres: %3.")}if(z.date&&z.hour){A=p.strargs(x,[z.date,z.hour,B])}else{A=p.strargs(u("Wiadomość nie dotarła na adres: %1."),[B])}w="<p class=message-failed-intro>"+A+"</p>";if(v.reason){w+="<p class=message-failed-reason>"+v.reason+"</p>"}if(v.suggestion){w+="<p class=message-failed-action>"+v.suggestion+"</p>"}C=l("div",{className:"message-failed-bar",innerHTML:w});if(v.suggestion){y=k.elmsByClass("message-failed-resend",C);if(y&&y[0]){y[0].onclick=function(D){if(z.msgId){f.Composition.editMessage({id:z.msgId},"edit")}else{f.Composition.composeNew()}return k.preventDefault(D||event)}}callCenterLinks=k.elmsByClass("message-failed-mailto",C);if(callCenterLinks&&callCenterLinks[0]){callCenterLinks[0].onclick=function(D){f.Composition.composeNew({mailto:this.href});return k.preventDefault(D||event)}}}return C};a.displayAVContent=function(y){var A,x,v,B,z,C,w,D;if(!f.env.useVideoMail){return}C=f.DOM.nodeListToArray(f.DOM.elmsByClass("inpl_av_msg",y));D=C.length;if(D){for(A=0;A<D;A++){w=C[A];z=a.getVideoData(w);if(!z){return}B="frame_"+z.hash+"_"+(new Date()).getTime();x=l("iframe",{name:B,className:"video-frame",src:"about:blank",frameBorder:0,scrolling:"no",width:320,height:265},y);v=l("form",{target:x.name,action:location.protocol+"//"+Inpl.Mail.env.videoHost+"/odtworz-webmail,"+z.hash,method:"POST",innerHTML:"<input type='hidden' name='pin' value='"+z.pin+"'>",style:{display:"none"}},y);w.parentNode.replaceChild(x,w);y.body.appendChild(v);v.submit()}}};a.getVideoData=function(v){var x=f.DOM.elmsByClass("inpl_av_link",v),w=["b","c"];if(x.length>0){x=x[0];w=x.href.split("odtworz,");if(w&&w[1]){return{hash:w[1],pin:""}}}return null};a.switchHeaderDetails=function(w,v){k.toggleClass(w,"header-switch-reveal");k.toggleClass(v,"hide")};a.frameLoadHandler=function(x,w){var v;a.showHiddenImages(x);x.document.onclick=function(){f.UI.CtxMenu.hideAll()};a.displayAVContent(x.document);if(f.VideoPreview){v=f.VideoPreview.createThumbnailBar(x.frameElement)}x.frameElement.message.fitToHeight(x,!!v);if(w.isMailing){a.prepareResponsiveMailingImage(x)}if(w.senderInfo.DKIM&&w.email==="noreply@firma.interia.pl"){a.addInteriaVerifiedLinkHandlers(x)}if(w.isVoucher){a.addVoucherHandlers(x)}if(w.isOffer){a.addOfferHandlers(x)}};a.prepareResponsiveMailingImage=function(w){w.document.body.className+=" inpl-mailing";var v=w.document.querySelectorAll(".inpl-inline-attachment");if(v.length==1){v[0].style.maxWidth="100%";v[0].style.height="initial";if(f.browser.ie){v[0].style.width="100%";v[0].style.height="auto"}}};a.showHiddenImages=function(A){var y=0,B,v=[],w=[],z=A.document;function x(){y+=1;A.frameElement.message.fitToHeight(A)}if(A.frameElement.message.allowExternalContent){B=z.getElementsByTagName("img");if(document.querySelectorAll){v=z.querySelectorAll("[data-inpl-style]");w=z.querySelectorAll("[data-inpl-background]")}f.Network.ajax({url:"/html/logunblock,email,"+A.frameElement.message.fromEmail});Array.forEach(B,function(C){var D=C.getAttribute("data-inpl-src");if(D){C.onload=x;C.src=D}});Array.forEach(v,function(C){C.setAttribute("style",C.getAttribute("data-inpl-style"));C.removeAttribute("data-inpl-style")});Array.forEach(w,function(C){C.setAttribute("background",C.getAttribute("data-inpl-background"));C.removeAttribute("data-inpl-background")})}};a.sendConfirmation=function(w,v){f.UI.ModalDialogs.confirm({title:u("Potwierdzenie odczytu"),message:u("Użytkownik prosi o potwierdzenie przeczytania tej wiadomości. Czy chcesz je wysłać?"),acceptLabel:u("Prześlij"),onAccept:function(){f.Network.ajax({url:"/html/sendnotif,mid,"+w+",fid,"+v,onSuccess:function(x,y){f.UI.showNotice(u("Potwierdzenie odbioru zostało przesłane"))}})}})};a.stringToZipName=function(v){return c.truncateString(c.removeSpecialChars(c.decodeEntities(v))||u("zalaczniki"),60,"")};a.openUnlinked=function(v){var w,x;if(!v.id){throw new TypeError("Message.openUnlinked: Wrong specifier")}if(f.MessageList){w=f.MessageList.getMessageFromAll(v.id);if(w){w.forEach(function(y){y.setSeen(true);k.removeClass(y.relatedNode,"ch")});if(w[0]){w[0].open();return w[0]}}}x=new a(v);x.open();f.MessageList.currentList.refresh();return x}}());Inpl.Mail.Thread=(function(){var c=Inpl.Mail,i=c.Message,d=c.Tools,f=c.DOM,b=f.createElement,e={none:"red",red:"green",green:"blue",blue:"none"},a=new Gettext({domain:"inpl_mail_thread",locale_data:c.L10n}),g=function(l){return a.gettext(l)};function j(l){return document.createTextNode(l)}function h(){var m=this,l=m.parentNode.relatedItem;l.switchFlag(function(n){m.className="msglist-flag "+n;if(l.list){l.list.forEach(function(o){o.xflag=n;if(o.relatedNode){Array.forEach(f.elmsByClass("msglist-flag",o.relatedNode),function(p){p.className="msglist-flag "+n})}})}})}function k(m){var l;if(m){for(l in m){if(m.hasOwnProperty(l)){this[l]=m[l]}}}if(this.list){d.constructArrayElements(i,this.list)}this.list.forEach(function(n){n.parentThread=this},this);this.subject=this.subject||"";this.rawDate=new Date(1000*this.rawDate)}k.prototype={getItemMapper:function(m){var n=this,l=n.handleCheckboxes.bind(n);return function(q,p,o){var s=m.getCheckboxClickHandler(),r=q.createMsgListTableRow("_thread_"+n.id+"_item_"+p,m,"thread-item"+(p<o.length-1?"":" thread-item-last"),true,s,null);q.parentThread=n;q.relatedNode=r;q.relatedCheckbox=r.firstChild.firstChild;f.addEvent(q.relatedCheckbox,"click",l);return r}},onMsgListRowClick:function(o,m){var l=this.relatedNode,p=m.target||m.srcElement,r,q,n=f.hasClass(p,"thread-switch");if(m.shiftKey){o.activateMultiple(l)}else{if(m.ctrlKey){if(f.hasClass(l,"active")){o.deactivate(l)}else{o.activate(l,false)}}else{if(l.relatedItem){if(!this.isPulledDown){if(!n){o.deactivateAllItems(true);_gaq.push(["b._trackEvent","Wątkowanie","otwarcie wątku wiadomość",c.Folders.getById(o.folder).getFolderName()])}else{_gaq.push(["b._trackEvent","Wątkowanie","otwarcie wątku plus",c.Folders.getById(o.folder).getFolderName()])}this.pullDown(o,l,!n);if(!(o.isPreviewShown||n)){r=this.list.filter(function(s){return s.folderId==o.folder});if(r.length){q=r[0];q.setSeen(true);f.removeClass(q.relatedNode,"ch");this.updateReadStatus();q.open()}else{this.openTab()}}}else{this.pullUp(o,l)}}}}},onMsgListRowDblClick:function(){this.openTab()},onMsgListCheckboxChecked:function(l){if(this.isPulledDown){this.tableRows.forEach(function(m){l.activate(m)})}},onMsgListCheckboxUnchecked:function(l){if(this.isPulledDown){this.tableRows.forEach(function(m){l.deactivate(m)})}},updateReadStatus:function(){function l(m){return !m.seen}if(this.list.some(l)){f.addClass(this.relatedNode,"ch")}else{f.removeClass(this.relatedNode,"ch")}},createMsgListTableRow:function(t,o,y,u,s){y=y||"";var v=this,r="",q="",m,x,l,n,w,p;l=v.fromName||v.fromEmail;n=b("td",{className:"msglist-from",childNodes:[b("div",{childNodes:[l||g("(brak odbiorcy)")]})],title:v.fromEmail||v.senderEmail||v.fromName});if(!l){f.addClass(n,"no-value")}p=b("td",{className:"msglist-subject",childNodes:[b("div",{childNodes:[v.subject.length?j(v.subject):b("span",{className:"no-value",innerHTML:g("(brak tematu)")}),j(" ("+v.msgCount+")")]})],title:v.subject.length?v.subject:g("(brak tematu)")});if(v.priority){r+="<span class=msg-priority-"+v.priority+"></span>"}if(v.attachments){r+="<span class=msg-hasatt></span>";f.addClass(p,"att")}if(v.answered||v.forwarded){if(v.answered&&v.forwarded){q="msg-status-fwd-re"}else{if(v.answered){q="msg-status-re"}else{if(v.forwarded){q="msg-status-fwd"}}}}m=b("span",{className:"msg-status "+q});x=b("tr",{className:["msglist-thread-tr",!v.seen?"ch":"",y].join(" "),id:"mailsTable_"+o.id+"_item_"+t,inpl_index:t,childNodes:[b("td",{className:"msglist-check",childNodes:[b("input",{type:"checkbox",title:g("Zaznacz/odznacz wątek"),onclick:s,className:"undraggable"})]}),b("td",{className:v.xflag?"msglist-flag "+v.xflag:"msglist-flag none",innerHTML:"<span></span>",onclick:h}),b("td",{className:"msglist-threads",childNodes:m}),n,p,b("td",{className:"msglist-prioatt",innerHTML:r}),b("td",{className:"msglist-date",title:d.formatDate(v.rawDate,true),childNodes:[j(d.formatDate(v.rawDate))]}),b("td",{className:"msglist-size",innerHTML:c.Tools.bytesToHRSize(v.size)})]});if(u){w=b("td",{className:"msglist-folder",childNodes:b("div",{childNodes:[document.createTextNode(d.truncateString(c.Folders.getById(v.folderId).name,13))]})});x.insertBefore(w,p)}x.relatedItem=v;x.childNodes[2].innerHTML="<span class='thread-switch undraggable'></span>";return x},print:function(){(new c.PrintPreview({threadId:this.id,folderId:this.folderId,mode:c.PrintPreview.SHOW_THREAD})).open()},edit:function(l){if(l!=="forw"){throw new Error('Unsupported thread edit mode: "'+l+'"')}c.Composition.composeNew({forwardThreads:[this]})},move:function(l){if(l===-2){return this.switchSpamStatus()}d.preparePost("/html/opthread",{param:this.id+"|"+this.folderId,fId:l,o:2,uid:d.getUid()}).submit()},remove:function(){d.preparePost("/html/opthread",{param:this.id+"|"+this.folderId,o:1,uid:d.getUid()}).submit()},showMoveDialog:function(l){c.Folders.chooseFolder(g("Przenieś wątek"),g("Przenieś wątek do folderu:"),g("Przenieś"),this.move.bind(this),this.folderId,l)},switchFlag:function(l){var n=this,m=this.xflag,o=e[m];l=l||function(){};l(o);c.Network.ajax({url:"flagmsg,threads,"+this.id+",xflag,"+o+",folder,"+this.folderId,onSuccess:function(p){p=c.Network.parseResponse(p);if(p.status){n.xflag=o}else{l(m);c.UI.showNotice(g("Błąd podczas ustawiania flagi dla wątku"),"error")}}})},calculateFlag:function(){var q=this.list,n,l,m=["red","blue","green"],o="none";function p(s,r){return r.xflag==s}for(l in m){if(m.hasOwnProperty(l)){n=m[l];if(q.some(p.bind(null,n))){o=n;break}}}this.xflag=o;f.elmsByClass("msglist-flag",this.relatedNode)[0].className="msglist-flag "+o},switchSpamStatus:function(){d.preparePost("/html/opthread",{param:this.id+"|"+this.folderId,o:3,uid:d.getUid()}).submit()},saveAllAttachments:function(){location.href=c.env.uploadUrl+"/html/getattach,tid,"+this.id+",uid,"+c.Tools.getUid()+"?f="+encodeURIComponent(i.stringToZipName(this.subject)+".zip")},openTab:function(){var n,o,l=this,q=c.MessageList,m=q.mainList;n={folder:l.folderId,thread:l.id,sort:m.sort,sorder:m.sorder};try{o=new q(n,this.subject);o.openInTab(undefined,function(){var r=o.items.filter(function(s){return l.folderId==s.folderId});if(r.length){o.activate(r[0].relatedNode,true);if(o.isPreviewShown){r[0].openPreview(o.htmlNodes.mailFrame,o.tab.id)}}})}catch(p){return false}return true},pullUp:function(n,o,l){if(this.tableRows&&this.tableRows.length){var m=this.tableRows[0].parentNode;this.tableRows.forEach(function(p){m.removeChild(p)})}o=o||this.relatedNode;f.removeClass(o.childNodes[2].firstChild,"thread-switch-opened");f.removeClass(o,"thread-pulled-down");delete this.tableRows;this.isPulledDown=false;n.pulledDownThread=null;if(!o.nextSibling){f.addClass(o,"last")}if(n.isPreviewShown&&!l){n.showDefaultContent()}n.updateToolbars()},pullDown:function(n,o,p){var l=this,m=o.firstChild.firstChild;function q(){var r=o.parentNode.parentNode.parentNode;if(r.scrollTop>o.offsetTop){r.scrollTop=o.offsetTop}}Array.forEach(o.parentNode.getElementsByTagName("tr"),function(r){if(r.relatedItem instanceof k){r.relatedItem.pullUp(n,r,true)}});this.isPulledDown=true;this.showMessages(n,o,function(){if(m.checked){l.activateAll(n)}else{l.deactivateAll(n)}if(p){l.activateFirstFromFolder(n)}});f.addClass(o,"thread-pulled-down");f.addClass(o.childNodes[2].firstChild,"thread-switch-opened");if(this.msgCount>this.list.length){this.loadMoreMessages(n,q)}else{q()}n.pulledDownThread=this.id;f.removeClass(o,"last")},activateAll:function(l){this.tableRows.forEach(function(m){l.activate(m,false)})},deactivateAll:function(l){this.tableRows.forEach(function(m){if(f.hasClass(m,"active")){l.deactivate(m,false,true)}})},activateFirstFromFolder:function(n,l){l=l||n.folder;if(!this.isPulledDown){return false}var p,o,m=this.list.filter(function(q){return q.folderId==l});if(m.length){p=m[0];o=c.Folders.getById(p.folderId);n.activate(p.relatedNode,false);p.setSeen(true);p.openPreview(n.htmlNodes.mailFrame,n.tab.id);this.updateReadStatus();if(f.hasClass(p.relatedNode,"ch")){f.removeClass(p.relatedNode,"ch");o.read++;o.unread--;o.updateView();n.updateWinTitle()}return true}return false},handleCheckboxes:function(){var n=this.list,m=this.relatedNode.firstChild.firstChild,l;l=n.every(function(o){return o.relatedCheckbox.checked});if(l){m.checked=true;f.addClass(this.relatedNode,"active")}else{m.checked=false;f.removeClass(this.relatedNode,"active")}return true},showMessages:function(m,p,l){var o,n,r,q=c.UI;if(!this.tableRows){o=this;n=this.list.map(this.getItemMapper(m));r=document.createDocumentFragment();n.forEach(function(s){r.appendChild(s);q.DnD.makeDraggable(s,m.getMsgItemsDragHandler())});this.tableRows=n;f.insertAfter(r,p)}l()},loadMoreMessages:function(m,l){var n=c.Network,o=this;n.ajax({url:"/html/thread",post:{folder:this.folderId,thId:this.id},onSuccess:function(t){var r,q,u,s=o.list,p=document.createDocumentFragment();t=n.parseResponse(t);if(t&&t.status&&o.isPulledDown){r=t.data.list[0].list;u=f.elmsByClass("msglist-from",o.relatedNode);if(u.length){u[0].title=t.data.list[0].fromEmail}r=r.filter(function(v){return !(s.some(function(w){return w.id===v.id}))}).map(c.Message);q=s[s.length-1].relatedNode;s=o.list=s.concat(r);r.map(o.getItemMapper(m)).forEach(function(v){p.appendChild(v);o.tableRows.push(v)});q.parentNode.insertBefore(p,q.nextSibling);f.removeClass(q,"thread-item-last");if(l){l()}}else{if(t.msg){c.UI.showNotice(t.msg,"error")}}}})}};return k}());(function(){var c=Inpl.Mail,g=Inpl.Network,f=c.DOM,a="",d=0,i=0,h=g.TEXT,b=new Gettext({domain:"inpl_mail_network",locale_data:c.L10n}),e=function(j){return b.gettext(j)};c.Network={getSandboxOrigin:function(){return location.protocol+"//"+c.env.sandboxHost},getSandboxUrl:function(){return this.getSandboxOrigin()+"/"},xdr:function(j){if(!j||!j.url){throw"IM.Network.xdr call: no url specified"}var k;g.progressDisabled=!!j.isSilent;k=g.createRequest(h,j.url,j.post,j.onSuccess);if(j.isSilent){k.isSilent=true}k.Execute(this.sessionHandler,j.timeout,j.onError,j.onTimeout);return k},ajax:function(j){if(!j||!j.url){throw"IM.Network.ajax call: no url specified"}else{a=j.url}var l,k=j.url.split("?");k[0]=k[0]+",uid,"+c.Tools.getUid();k=k.join("?");g.progressDisabled=!!j.isSilent;var m=j.headers;l=g.createRequest(h,k,j.post,j.onSuccess,m);l.Execute(this.sessionHandler,j.timeout,j.onError,j.onTimeout);return l},ajaxApi:function(j){var k,l="";if(window.XMLHttpRequest){k=new XMLHttpRequest()}else{k=new ActiveXObject("Microsoft.XMLHTTP")}k.withCredentials=true;k.open("POST",j.url,true);if(j.post){Object.keys(j.post).forEach(function(m){l+="&"+m+"="+j.post[m]});l=l.substr(1);k.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8")}l?k.send(l):k.send();k.onreadystatechange=function(){if(k.readyState===4&&k.status===200){var m=JSON.parse(k.response);j.callback(m.result)}else{if(k.readyState===4){if(m&&m.result&&m.result.data){c.UI.showNotice(m.result.data,"error")}}}}},jsonp:function(j){var k="jsonp"+(new Date()).getTime()+"c"+d;d+=1;window[k]=function(l){j.onSuccess(l);try{delete window[k]}catch(m){window[k]=null}k=null};g.loadJs({url:j.url+"&callback="+k,onError:function(){var l=e("Nie udało się załadować danych");if(c.UI&&c.UI.showNotice){c.UI.showNotice(l,"error")}else{alert(l)}},timeout:j.timeout,onTimeout:j.onTimeout})},sandboxedRequests:{},registerSandboxedJsonp:function(o,j,k){var l=this,n=j.onSuccess,m;l.sandboxedRequests[o]={onSuccess:function(){if(m){clearTimeout(m)}j.onSuccess.apply(j,arguments)},iframe:k};if(j.onTimeout){m=setTimeout(function(){k.parentNode.removeChild(k);j.onTimeout()},j.timeout||25000)}if(!l.sbxReceiverRegistered){f.addEvent(window,"message",function(s){if(s.origin!==l.getSandboxOrigin()){return}var t=JSON.parse(s.data),r=t.callbackId,p=l.sandboxedRequests[r],q=p.iframe;if(p){p.onSuccess(t.response);q.parentNode.removeChild(q);p.iframe=null;p.onSuccess=null;delete l.sandboxedRequests[r]}});l.sbxReceiverRegistered=true}},sandboxedJsonp:function(j){var k="sj_"+i+"_"+parseInt(1000000*Math.random(),10),l;i+=1;l=f.createElement("iframe",{src:c.Network.getSandboxUrl()+"?callbackId="+encodeURIComponent(k)+"&url="+encodeURIComponent(j.url)+(location.hostname.indexOf("mybravo.de")>=0?"&s=mybravo":""),style:{position:"absolute",top:"-100px",left:"-100px",width:"1px",height:"1px"}});this.registerSandboxedJsonp(k,j,l);document.body.appendChild(l)},sessionHandler:function(k,l){if(k==="nosession"){c.Network.showLoginForm()}else{if(k==="notallowed"){if(this.url.indexOf("checknew")<0){c.UI.showNotice(e("Błąd połączenia. Spróbuj ponownie za chwilę."),"error")}}else{try{if(l){l(k)}}catch(j){if(window.console){console.log(j)}}}}},checkSession:function(l,j){var k=g.createRequest(g.TEXT,"/html/ping,uid,"+c.Tools.getUid(),null,function(m){if(m==="1"&&l){l()}});k.Execute(function(n,p){var m;if(n!=="nosession"){try{m=true;p(n)}catch(o){m=false}}else{m=false}if(!m){if(j){j()}c.Network.showLoginForm()}})},getLastUrl:function(){return a},parseResponse:function(k,l){try{k=k.replace(/[ \t]*while\([ ]*1[ ]*\);/g,"");return JSON.parse(k)}catch(j){Inpl.Mail.Bugtracker.send({url:this.getLastUrl(),exception:""+j,response:k.substring(0,2048)});if(!l){c.UI.showNotice(e("Błąd podczas przetwarzania odpowiedzi serwera."),"error")}if(window.console){console.log("Mail.Network parseResponse exception:");console.log(j)}return undefined}},showLoginForm:function(n){var k,m,o,j,l;g.onHideProgress();n=n||e("Sesja wygasła. Prosimy zalogować się ponownie.");if(!this.loginFormDisplayed){iwa("trackEvent","plansza","wygasla_sesja","view","-");k=c.env.ownEmail;m=location.protocol;o=location.hostname;l=$("toolbar");j='<div class="overlay overlay-login"><h2>'+e("Logowanie")+"</h2><p id=overlay-login-message>"+n+'</p><form target=loginFrame action="'+(c.env.loginUrl)+'" id=pocztaLoginForm method=post><input type=hidden value="'+m+"//"+o+'/framelogin" name=referer id=pocztaLoginReferer><input type=hidden value="'+m+"//"+o+'/frameloginfailed" name="refererError" id="pocztaLoginRefererError"><div class=loginInputs><label for=formLogin>'+e("E-mail:")+'</label><br><input value="'+k+'" name=email id=formLogin class=text></div><div class=loginInputs><label for=formPassword>'+e("Hasło:")+'</label><br><input type=password name=pass id=formPassword class=text></div><div class=loginSubmit><input type=submit value="'+e("Zaloguj się")+"\" id=formSubmit onclick=\"if(Inpl.Mail.env.ownEmail != $('formLogin').value ){this.form.target='';$('pocztaLoginReferer').value='"+m+"//"+o+"';$('pocztaLoginRefererError').value='"+m+"//"+o+'\';}" ></div><input type=hidden id=htmlMail name=htmlMail value=on></form><iframe src="about:blank" id=loginFrame name=loginFrame width=10 height=10 style="position: absolute; top: -9999px; left: -30px;"></iframe><hr><span class=bottomLinks><a href="http://interia.pl#utm_source=poczta&amp;utm_medium=sesja&amp;utm_campaign=sesja&amp;iwa_source=log_sesja" target="_top">'+e("Przejdź na stronę główną portalu")+" <span class=raq>»</span></a></span>";c.UI.showOverlay(j,null,true);this.loginFormDisplayed=true}else{$("overlay-login-message").innerHTML=n}if(l){l.style.display="none"}$("formPassword").focus()},hideLoginForm:function(){var j=$("toolbar");if(j){j.style.display=""}c.UI.hideOverlay();this.loginFormDisplayed=false},frameLoginSuccess:function(o,q){var m=Inpl.Mail,p,n,l,r,k;if(o&&o!==m.env.ownEmail){location.reload();return}m.Tools.setUid(q);this.hideLoginForm();if(history.pushState){history.pushState(null,null,"#iwa_source=log_sesja")}else{location.hash="#iwa_source=log_sesja"}iwa("trackEvent","wygasla_sesja","klik","zaloguj");if(m.Composition.instances.length>0){l=m.DOM.elmsByClass("composition-attachments");if(l&&l.length>0){for(p=0;p<l.length;p+=1){r=f.elmsByClass("att-operations");for(n=0;n<r.length;n+=1){r[n].parentNode.removeChild(r[n])}}}m.Composition.instances.forEach(function(j){j.isSending=false;j.purgeAttachments(true);j.appendUploadForm()});m.UI.showNotice(e("Uwaga: po zalogowaniu konieczne jest ponowne dodanie załączników do wiadomości"),"info",5000)}Array.forEach(m.DOM.elmsByClass("uid-link"),function(j){j.href=j.href.replace(/,uid,.*/g,",uid,"+q)});m.MessageList.currentList.refresh();k=m.Tabs.getById(m.Tabs.activeId);if(typeof k.onAfterOpen==="function"){k.onAfterOpen()}},frameLoginFail:function(){c.Network.showLoginForm('<span class="loginError">'+e("Podane dane są nieprawidłowe!")+"</span>")}}}());window.Inpl=window.Inpl||{};Inpl.Mail=Inpl.Mail||{};Inpl.Mail.Bugtracker=(function(){var b="/bugtracker",a=function(d){try{Inpl.Mail.Network.ajax({url:b,post:{data:JSON.stringify(d)},onError:function(){},onTimeout:function(){}})}catch(c){}};return{send:a}}());(function(){var a=Inpl.Mail,b=a.Network,c;b.LongPoll=c={errorDelay:30000,timeout:5*60000,events:{},addEventListener:function(d,e){var f=this.events[d];if(!f){throw new Error("Unsupported event: "+d)}if(typeof e!=="function"){throw new TypeError("eventHandler must be a function")}f.push(e)},removeEventListener:function(d,e){var f=this.events[d];if(!f){throw new Error("Unsupported event: "+d)}f.splice(f.indexOf(e),1)},handleEvent:function(d){try{d=JSON.parse(d)}catch(g){console.log("LongPoll: Error processing incoming data: ",g);return}var f=this.events[d.event];if(d&&f){f.forEach(function(e){e(d)})}},getUrl:function(){return a.env.longPollUrl},fetchData:function(e){var d=this;b.xdr({isSilent:true,url:d.getUrl(),timeout:d.timeout,onSuccess:function(f){d.recentFail=false;if(f){d.handleEvent(f);if(typeof e==="function"){e()}}else{d.recentFail=true;if(typeof e==="function"){setTimeout(e,c.errorDelay)}}},onError:function(){d.recentFail=true;if(typeof e==="function"){setTimeout(e,c.errorDelay)}},onTimeout:function(){d.recentFail=false;if(typeof e==="function"){e()}}})},connect:function(){var d=this;if(!d.disabled){if(!d._boundConnect){d._boundConnect=d.connect.bind(d)}d.fetchData(d._boundConnect)}},disable:function(){this.disabled=true},enable:function(){if(this.disabled){delete this.disabled}this.connect()},isEnabled:function(){return !this.disabled}}}());(function(b){var j,d=b.Mail,i=d.DOM,g=d.Network,e=d.Tools,m,a=null,l=[];function n(){j.revision=0}function f(){var o=j.revision;return d.env.longPollUrl+"?"+(o?"revision="+o+"&":"")+"PUSHID="+a+"&d="+(+new Date())}function c(o){d.FolderCache.invalidateAll();j.items.push(o);j.revision=o.currentRevision}function h(){j.updatePushId()}function k(){var o=Object.create(d.Network.LongPoll);o.events={newMg:[c],change:[],revisionMismatch:[n],"PushId not exist":[h]};o.getUrl=f;return o}d.MessageNotifQueue=j={revision:0,updatePushId:function(){m.disable();function o(){d.UI.showNotice("Błąd pobierania identyfikatora sesji autoodświeżania","error")}g.ajax({url:"/html/getpushid",onSuccess:function(p){p=g.parseResponse(p);if(p&&p.status&&p.data&&p.data.pushId&&Number(p.data.pushId)!==-1){a=p.data.pushId;m.enable()}else{o()}},onError:o})},addPushListener:function(o){l.push(o)},removePushListener:function(o){l.splice(l.indexOf(o),1)},items:[],cleanUp:function(){this.items.length=0},init:function(){a=d.env.initialPushId||0;this.revision=d.env.initialRevision||0;if(Number(a)!==-1){m=k();m.enable();this.isInitialized=true}},isEnabled:function(){return m.isEnabled()},isOk:function(){return this.isEnabled()&&!m.recentFail}};e.augment(j.items,{push:function(o){var p=this;Array.prototype.push.apply(this,i.nodeListToArray(arguments));l.forEach(function(q){q(o,p.length)})}})}(Inpl));(function(){var i,e=5*1000,c=Inpl.Mail,g=c.MessageNotifQueue,f=c.DOM,a=new Gettext({domain:"inpl_mail_messagenotifview",locale_data:c.L10n}),h=function(j){return a.gettext(j)},b=f.createElement;function d(j){if(c&&c.UI&&c.UI.WindowTitle){c.UI.WindowTitle.setMailCount(j)}}Inpl.Mail.MessageNotifView=i={htmlNodes:{},cycleInterval:null,notifDiv:null,isOpened:false,close:function(){var j=this.htmlNodes.notifDiv;if(j){j.parentNode.removeChild(j);this.htmlNodes.notifDiv=null}g.cleanUp();this.isOpened=false;if(this.cycleInterval){clearInterval(this.cycleInterval)}d(0)},createMsgLi:function(l){var j;try{j=c.Folders.getById(l.folderId)}catch(k){}j=j||{name:a.strargs(h("Folder %1"),l.folderId)};return b("li",{childNodes:[b("a",{href:"#msg"+l.id,onclick:function(){c.Message.openUnlinked(l);return false},childNodes:[b("span",{className:"msgnotif-folder",childNodes:j.name}),b("span",{className:"msgnotif-from",childNodes:l.fromName||l.fromEmail}),b("span",{className:"msgnotif-subject",childNodes:l.subject})]})]})},renderHeader:function(j){return a.strargs(a.ngettext("Odebrano %1 wiadomość","Odebrano %1 wiadomości",j),j)},render:function(l){var j,k;this.isOpened=true;d(l.length);k=this.htmlNodes.notifDiv=document.body.appendChild(b("div",{className:"notice msgnotifview-notice",childNodes:[b("div",{className:"notice-content",childNodes:[b("div",{className:"msgnotif-header",childNodes:[this.htmlNodes.header=b("p",{innerHTML:this.renderHeader(l.length)}),b("div",{className:"tabHeader msgnotif-tab",childNodes:[this.htmlNodes.counter=b("span",{childNodes:[this.htmlNodes.counterCurrent=b("b",{innerHTML:1})," "+h("z")+" ",this.htmlNodes.counterAll=b("b",{innerHTML:1})]}),b("button",{innerHTML:"<span>"+h("Zamknij")+"</span>",onclick:this.close.bind(this)})]})]}),j=b("ul",{childNodes:l.map(this.createMsgLi)})]})]}));this.currentLi=j.firstChild;this.currentLi.className="current";this.htmlNodes.messagesUl=j;document.body.appendChild(this.htmlNodes.notifDiv);this.startCycleInterval()},startCycleInterval:function(){if(this.cycleInterval){clearInterval(this.cycleInterval)}this.cycleInterval=setInterval(this.cycle.bind(this),e)},cycle:function(){var k=this.htmlNodes.messagesUl,j=this.currentLi;if(document.hasFocus()&&j===k.lastChild&&!this.overrideNextItem){this.close();return}if(j){f.removeClass(j,"current")}if(this.overrideNextItem){j=this.overrideNextItem;delete this.overrideNextItem}else{if(j===k.lastChild){j=k.firstChild}else{j=j?j.nextSibling:k.firstChild}}f.addClass(j,"current");this.currentLi=j;this.htmlNodes.counterCurrent.innerHTML=1+f.nodeListToArray(k.childNodes).indexOf(j)},update:function(j){var k,l=j.folderId===-2;if(!c.UI.isNoticeShown&&!l){Inpl.Network.onHideProgress();if(!this.isOpened){this.render([j])}else{k=this.htmlNodes;k.messagesUl.appendChild(this.createMsgLi(j));k.header.innerHTML=this.renderHeader(k.counterAll.innerHTML=k.messagesUl.childNodes.length);d(k.messagesUl.childNodes.length)}}c.MessageList.instances.forEach(function(m){m.needsRefresh=true});if(document.hasFocus()){c.MessageList.currentList.refresh()}},focusListener:function(){var j=i;if(j.htmlNodes&&j.htmlNodes.messagesUl){j.overrideNextItem=j.htmlNodes.messagesUl.firstChild;j.cycle();j.startCycleInterval();if(c.MessageList.currentList.needsRefresh){c.MessageList.currentList.refresh()}}},observeFocus:function(){f.addEvent(window,"focus",this.focusListener);f.addEvent(window,"message",function(k){try{var l=JSON.parse(k.data),j=c.MessageList.currentList;if(l.event=="preview"&&j.isPreviewShown&&j.htmlNodes.mailFrame.messageId==l.messageId){c.MessageNotifView.focusListener()}}catch(m){}})},unobserveFocus:function(){f.removeEvent(window,"focus",this.focusListener)},init:function(){if(!g.isInitialized){g.init()}g.addPushListener(this.update.bind(this));i.observeFocus();this.isInitialized=true}}}());(function(){var a=new Gettext({domain:"inpl_network_overrides",locale_data:Inpl.Mail.L10n}),c=600,b=function(d){return a.gettext(d)};Inpl.Network.onShowProgress=function(){var d=Inpl.Network;if(!d.timerSp&&!d.progressDisabled){d.timerSp=setTimeout(d.realShowProgress,c);if(window.attachEvent&&!window.opera){window.attachEvent("onresize",d.updateProgressPosition);window.attachEvent("onscroll",d.updateProgressPosition)}}};Inpl.Network.realShowProgress=function(){Inpl.Network.createProgress();Inpl.Network.divProgress.style.display="block"};Inpl.Network.createProgress=function(){Inpl.Network.progressId="Inpl_Progress";var d=$(Inpl.Network.progressId);if(!d){d=document.createElement("div");d.className="notice";d.id=Inpl.Network.progressId;d.style.display="block";d.style.top="0";d.innerHTML="<p class=notice-content id=progressText>"+b("Trwa komunikacja z serwerem…")+"</p><div class=notice-footer><span class=nf-left></span><span class=nf-right></span><span class=nf-mid></span></div>";document.body.appendChild(d)}Inpl.Network.divProgress=d;return d};Inpl.Network.onHideProgress=function(){var d=Inpl.Network;d.clearShowProgress();if(d.divProgress){d.divProgress.style.display="none";if(window.detachEvent&&!window.opera){window.detachEvent("onresize",d.updateProgressPosition);window.detachEvent("onscroll",d.updateProgressPosition)}}};Inpl.Network.clearShowProgress=function(){var d=Inpl.Network;if(d.timerSp){clearTimeout(d.timerSp)}d.timerSp=null}}());Inpl.Mail.UI=(function(){var q,f=Inpl.Mail,k=f.DOM,c=k.createElement,g=k.addEvent,m=k.removeEvent,a=new Gettext({domain:"inpl_mail_ui",locale_data:f.L10n}),l=function(r){return a.gettext(r)},h=false,d=false;function p(r){return document.createTextNode(r)}function j(){return false}function n(){q.showNotice(l("Brak zdefiniowanej akcji dla tego przycisku"),"error")}function b(r){return function(){if(this.scrollHeight>this.offsetHeight&&this.scrollHeight<r){this.style.height=this.scrollHeight+"px"}else{if(this.scrollHeight>=r){this.style.height=r+"px";this.style.overflowY="auto";this.scrollTop=this.scrollHeight}}}}function o(s,v,t){var r,u=q.Theme.currentTheme.id;if(s==="|"){r=c("span",{className:"separator"})}else{r=c("button",{id:s.ident+(v?"_"+v:""),className:s.ident+(t?" last":""),innerHTML:"<span>"+s.label+"</span>"});if(s.accessKey){r.accessKey=s.accessKey}if(s.title){r.title=s.title}if(s.tabIndex){r.tabIndex=s.tabIndex}if(!s.disabled){r.className+=" act";if(s.cmd){r.onclick=function(){setTimeout(function(){s.cmd.call(r)},1)}}else{if(s.menuitems){r.onclick=function(){var w=new f.UI.PopupMenu(s.menuitems,s.ident+"_menu");w.show(r)}}else{r.onclick=function(){setTimeout(n,1)}}}if(s.gemiusClickId){k.addEvent(r,"click",(function(w){return function(){f.Tools.hitGemius(w)}}(s.gemiusClickId)))}}else{if(u==="4"||!Inpl.Mail.browser.ie){r.disabled="disabled"}else{r.onclick=j}}}return r}function i(r){r=r||event;if(typeof r.layerX==="undefined"){r.layerX=r.offsetX}if(typeof r.layerY==="undefined"){r.layerY=r.offsetY}return r}function e(t,r){var v,s,u=r==="x"?"offsetLeft":"offsetTop";v=t[u];s=t.offsetParent;while(s!==null){v+=s[u];s=s.offsetParent}return v}q={showNotices:true,isNoticeShown:false,showNotificationBar:function(s){var r=c("div",{className:"notification-bar"});try{if(typeof s==="string"){r.innerHTML=s}else{r.appendChild(s)}}catch(t){throw new TypeError("invalid content argument for showNotificationBar")}k.insertAfter(r,$("header"));return r},hideNotificationBar:function(){Array.forEach(k.elmsByClass("notification-bar"),function(r){r.parentNode.removeChild(r)})},injectButtons:function(x,s){var w=false,u,t,v,z,y={},r,A=document.createDocumentFragment();if(typeof s==="string"){z=$(s)}else{z=s;s=s.id}if(!z){return false}z.innerHTML="";if(x){for(v=0;v<x.length;v+=1){u=(v===x.length-1)||(x[v+1]==="|");t=(v===0)||(x[v-1]==="|");r=A.appendChild(o(x[v],s,u));if(!u&&x[v]!=="|"){A.appendChild(c("span",{className:"mSeparator"}))}if(x[v]!=="|"){y[x[v]]=r}w=true}}if(w){z.appendChild(A)}if(s==="bottIco"&&!z.childNodes.length){z.style.display="none"}else{z.style.display=""}return y},confirm:function(u,w,s,t,v,r){return f.UI.ModalDialogs.confirm({title:w||l("Prośba o potwierdzenie"),message:u||l("[brak tekstu]"),acceptLabel:v||l("Ok"),cancelLabel:r||l("Anuluj"),onAccept:s,onCancel:t})},alert:function(t,v,r,u,s){return f.UI.ModalDialogs.alert({title:v||l("Informacja"),message:t||l("[brak tekstu]"),acceptLabel:u||l("Ok"),onAccept:r,type:s})},showOverlay:function(x,r,s,w){if(typeof x!=="string"&&!(typeof x==="object"&&x.nodeName)){throw new TypeError("showOverlay expects content to be a string or a DOM Node")}var y,z=$("overlay-background"),t,u,v;if(!z){z=document.createElement("div");z.id="overlay-background";document.body.appendChild(z)}else{z.style.display="block"}z.style.height=(window.innerHeight||document.documentElement.offsetHeight)+"px";z.style.width="100%";if(w){z.className="clean"}else{z.className=""}y=document.createElement("div");y.id="overlay-content";if(r){for(t in r){if(r.hasOwnProperty(t)){y[t]=r[t]}}}if(typeof x==="string"){y.innerHTML=x}else{if(typeof x==="object"&&x.nodeName){y.appendChild(x)}}document.body.appendChild(y);u=Math.floor((document.body.clientWidth-y.offsetWidth)/2);v=Math.floor(0.5*(document.documentElement.clientHeight-y.offsetHeight));if(u<0){u=0}if(v<0){v=0}y.style.left=u+"px";y.style.top=v+"px";scrollTo(0,0);if(f.browser.ie&&f.browser.ie<7){k.addClass(document.body,"ie6-hide-selects")}},hideOverlay:function(){q.hideOverlayWithDelay()},hideOverlayWithDelay:function(r){var s=$("overlay-background"),t=$("overlay-content"),r=r||0;if(s){s.style.display="none"}setTimeout(function(){if(t){t.parentNode.removeChild(t)}if(f.browser.ie&&f.browser.ie<7){k.removeClass(document.body,"ie6-hide-selects")}},r)},showNotice:function(y,w,x,t,s){if(!q.showNotices){return}if(f.MessageNotifView){f.MessageNotifView.close()}clearInterval(h);clearInterval(d);d=h=null;var r=$("main-notice"),v=r.getElementsByTagName("p")[0],u=document.createDocumentFragment();if(f.browser.ie&&f.browser.ie<7){window.scrollTo(0,0)}v.innerHTML="";if(t){v.appendChild(y)}else{if(s){v.innerHTML=y}else{y=y.split("\n");y.forEach(function(B,A,z){u.appendChild(document.createTextNode(B));if(A<z.length-1){u.appendChild(c("br"))}});v.appendChild(u)}}if(!w){r.className="notice"}else{r.className="notice "+w}if(!h&&!d){x=!x?6000:x;r.style.top="-"+10*parseInt(r.offsetHeight/10,10)+"px";h=setInterval(function(){var z=parseInt(r.style.top,10);if(z>=-10){clearInterval(h);h=false}r.style.top=(z+10)+"px"},20);if(x>0){d=setTimeout(q.hideNotice,x)}}q.isNoticeShown=true},hideNotice:function(){var r=$("main-notice"),t=r.getElementsByTagName("p")[0],s=-r.offsetHeight;r.style.top="0px";d=setInterval(function(){var u=parseInt(r.style.top,10);if(u<=s){clearInterval(d);d=false;t.innerHTML=""}r.style.top=(u-5)+"px"},7);q.isNoticeShown=false},showFakePushNotice:function(u,t,r){if(!q.showNotices){return}if(f.MessageNotifView){f.MessageNotifView.close()}var s=c("div",{className:"notice msgnotifview-notice fake-push-notice",id:"cwfp-notice",childNodes:[c("div",{id:"fake-push-notice",className:"notice-content",childNodes:[c("div",{className:"msgnotif-header",childNodes:[c("p",{childNodes:p(u)}),c("div",{className:"tabHeader msgnotif-tab",childNodes:[c("button",{innerHTML:"<span>"+l("Zamknij")+"</span>",onclick:f.UI.hideFakePushNotice})]})]}),c("div",{className:"fake-push-notice-content",childNodes:[c("b",{childNodes:[p(t)]}),c("br"),p(r)]})]})]});document.body.appendChild(s);setTimeout(this.hideFakePushNotice,5000)},hideFakePushNotice:function(){var r=$("fake-push-notice");r.parentNode.removeChild(r)},makeResizer:function(t,s,r,v,y,u,x){var w={obj:null,objPre:null,objPost:null,minPre:null,minPost:null,init:function(D,z,A,C,E,B){D.ontouchstart=w.start;D.onmousedown=w.start;D.hmode=C?false:true;D.vmode=C;w.objPost=A;w.objPre=z;w.minPost=B;w.minPre=E},start:function(z){w.minPre=$("tabHeaderCont").clientHeight+10;w.obj=this;var A=this;z=i(z);A.lastMouseX=z.clientX;A.lastMouseY=z.clientY;A.prePostHSum=w.objPre.clientHeight+w.objPost.clientHeight;A.prePostWSum=w.objPre.clientWidth+w.objPost.clientWidth;document.onmousemove=w.Dr;document.onmouseup=w.end;document.ontouchmove=w.Dr;document.ontouchend=w.end;document.body.style.cursor="ns-resize";return false},Dr:function(H){H=i(H);var C=w.obj,I=H.clientY,K=H.clientX,E,L,G,B,M,A,z,D,J,F,O,N;if(!I&&!K&&H.touches&&H.touches.length===1){I=H.touches[0].clientY;K=H.touches[0].clientX}O=(K-C.lastMouseX);N=(I-C.lastMouseY);if(C.vmode){L=w.objPre.clientHeight+N;G=w.objPost.clientHeight-N;if(G>0&&L>0){if(w.minPost!==null&&G<w.minPost){G=w.minPost;L=C.prePostHSum-w.minPost}if(w.minPre!==null&&L<w.minPre){L=w.minPre;G=C.prePostHSum-w.minPre}w.objPre.style.height=L+"px"}}if(C.hmode){B=w.objPre.clientWidth+O;M=w.objPost.clientWidth-O;if(M>0&&B>0){if(w.minPost!==null&&M<w.minPost){M=w.minPost;B=C.prePostWSum-w.minPost}if(w.minPre!==null&&B<w.minPre){B=w.minPre;M=C.prePostWSum-w.minPre}w.objPre.style.width=B+"px"}}C.lastMouseX=K;C.lastMouseY=I;E=$("layFrame");if(E){E.parentNode.removeChild(E)}A=e(w.objPost,"x")-5;z=e(w.objPost,"y")-5;D=w.objPost.clientWidth+10;J=w.objPost.clientHeight+10;F=document.createElement("div");F.id="layFrame";F.style.position="absolute";F.style.top=z+"px";F.style.left=A+"px";F.style.width=D+"px";F.style.height=J+"px";w.objPost.appendChild(F);return false},end:function(){if(x){Inpl.Mail.Tools.setCookie(x,parseInt(w.objPre.style.height,10),365)}var z=$("layFrame");if(z){z.parentNode.removeChild(z)}document.onmousemove=null;document.onmouseup=null;document.ontouchmove=null;document.ontouchend=null;w.obj=null;document.body.style.cursor=""}};if(typeof t==="string"){t=$(t)}if(typeof s==="string"){s=$(s)}if(typeof r==="string"){r=$(r)}w.init(t,s,r,v,y,u)},switchTableDisplay:function(s,r){if(s.style.display==="none"){s.style.display="";k.addClass(r.getElementsByTagName("span")[0],"details-opened")}else{s.style.display="none";k.removeClass(r.getElementsByTagName("span")[0],"details-opened")}},keepCheckedState:function(t,s){var r=Array.filter(s.getElementsByTagName("input"),function(u){return u.type==="checkbox"});r.forEach(function(u){u.checked=t.checked});return r},optionExists:function(r,s){return Array.some(r.options,function(t){return t.id===s})},moveOptions:function(w,u,r,v){var t,x=false,s;if(r){t=w.childNodes}else{t=k.elmsByClass("checked",w)}t=k.nodeListToArray(t);t.forEach(function(y){if(!Array.some(u.childNodes,function(z){return(y.id===z.id)})){u.appendChild(y);x=true}else{w.removeChild(y)}});if(x){s=k.nodeListToArray(u.childNodes);s.sort(function(B,A){var z=B.innerHTML.toLowerCase(),C=A.innerHTML.toLowerCase();return((z<C)?-1:((z>C)?1:0))});if(s.length){k.removeChildren(u)}s.forEach(function(y){u.appendChild(y)})}v(w);v(u)},makeGrowable:function(s,r){r=r||50;s.grow=b(r);g(s,"keyup",s.grow);g(s,"change",s.grow);return s}};return q}());Inpl.Mail.User=(function(){var b=false;function a(f){var c=f.split(" "),d=c[0].split("-"),e=c[1].split(":");return new Date(d[0],d[1]-1,d[2],e[0],e[1],e[2])}return{init:function(){if(this.isPremium()&&this.isPremiumCloseToExpiry()&&!Inpl.Mail.Tools.getCookie("isPremiumCloseToExpiry")){Inpl.Mail.PromotionQueue.insert(Inpl.Mail.promotions.bubble.premiumAccount,Inpl.Mail.PromotionQueue.TYPE.BUBBLE,Inpl.Mail.PromotionQueue.PRIORITY.HIGH)}if(!this.isPremium()){Inpl.Mail.PromotionQueue.insert(Inpl.Mail.promotions.bubble.freeAccount,Inpl.Mail.PromotionQueue.TYPE.BUBBLE,Inpl.Mail.PromotionQueue.PRIORITY.HIGH)}},isPremium:function(){return !!Inpl.Mail.env.accountType},getPremiumEndDate:function(){return Inpl.Mail.env.premiumEmailData.end_date.substr(0,10)},isPremiumCloseToExpiry:function(){try{var g=7,i=1000*60*60*24,c=Inpl.Mail.env.premiumEmailData.end_date,e=a(c).getTime(),d=new Date().getTime(),h=Math.round((e-d)/i);return h<=7}catch(f){return false}}}}());Inpl.Mail.UI.FrameThumbnail=(function(){var b,a=Inpl.Mail,c=a.DOM;b={init:function(d){c.addEvent(d,"mouseover",this.over);c.addEvent(d,"mouseout",this.out)},cycle:function(){var d=parseInt(this.getAttribute("data-thumb-current"),10);d=d+1;if(d>parseInt(this.getAttribute("data-thumb-max"),10)){d=1}this.src=Gettext.strargs(this.getAttribute("data-thumb-template"),d);this.setAttribute("data-thumb-current",d)},over:function(){this.cycleInterval=setInterval(b.cycle.bind(this),750)},out:function(){clearInterval(this.cycleInterval);delete this.cycleInterval}};return b}());(function(){var c=Inpl.Mail,h=c.DOM,g=c.UI,f=h.createElement,a=new Gettext({domain:"inpl_mail_ui_theme",locale_data:c.L10n}),e=function(i){return a.gettext(i)},b;function d(l,k,j,i){this.id=l;this.name=k;this.cssFile=j;if(i){this.isNew=true}}g.Theme=d;d.prototype={apply:function(){var n=document.getElementsByTagName("link")[1],p=document.getElementsByTagName("iframe"),k,o,m,l,j;l=d.currentTheme.id;n.href=this.cssFile.indexOf("data:")===0?this.cssFile:c.env.staticUrl+"/css/"+this.cssFile;d.currentTheme=this;j=this.id;if((l=="4"||j=="4")&&c.browser.ie){m=document.getElementById("nav1").getElementsByTagName("button");Array.forEach(m,function(i){if(!h.hasClass(i,"act")&&l=="4"){i.disabled=""}else{if(!h.hasClass(i,"act")&&j=="4"){i.disabled="disabled"}}})}for(k=0;k<p.length;k++){o=p[k];if(h.hasClass(o,"addcontFrame")||h.hasClass(o,"attupload-iframe")){o.src=o.src}}return this.id}};d.instances=[];d.currentTheme=null;d.getById=function(m){var j,l,k=this.instances;for(j=k.length;j--;){l=k[j];if(l.id===m){return l}}return null};d.choose=function(){var o,m,n,j=c.Prefs.get("theme"),i=d.instances,l=f("ul",{id:"themeChooser"});function k(){g.hideOverlay();d.isChooserOpen=false}if(d.isChooserOpen){return}d.isChooserOpen=true;b=i[0];i.forEach(function(p){if(p.id===j){b=p}});i.forEach(function(s,q){var p,r;r=[f("img",{width:150,height:73,alt:"",src:c.env.staticUrl+"/theme_"+s.id+".png"}),f("span",{className:"theme-anchor-span",childNodes:f("span",{childNodes:[document.createTextNode(s.name)]})})];if(s.isNew){r.push(f("span",{className:"inplNewFeature"}))}p=f("li",{childNodes:[f("a",{className:"theme-anchor",href:"#",onclick:function(){o=s.apply();return false},childNodes:r})]});l.appendChild(p);if(s===b){m=p.firstChild}});n=f("div",{className:"overlay",childNodes:[f("h2",{innerHTML:"<span></span>"+e("Wybierz kolorystykę")}),l,f("div",{className:"overlayButtons",childNodes:[f("button",{className:"okBtn",innerHTML:e("Zatwierdź"),onclick:function(){c.Prefs.set("theme",o,true);k()}}),f("button",{className:"cancelBtn",innerHTML:e("Anuluj"),onclick:function(){b.apply();k()}})]})]});g.showOverlay(n,null,null,true);m.focus();l.scrollTop=0;return false};d.setAndApply=function(i){if(typeof i==="string"){Inpl.Mail.UI.Theme.getById(i).apply();c.Prefs.set("theme",i,true)}else{throw new TypeError("themeId should be a string")}};d.init=function(m){var j=0,l,k=m.length;for(;j<k;j++){l=m[j];d.instances.push(new d(l.id,l.name,l.cssFile,l.isNew))}this.currentTheme=this.getById(c.Prefs.get("theme"))||this.instances[0]};return d}());Inpl.Mail.UI.DnD=(function(){var n,b=Inpl.Mail,l=b.DOM,p=l.addEvent,s=l.removeEvent,q=null,g=null,r=null;function c(){return this.cloneNode(true)}function o(v){v.followMouse=(function(w){return function(x){x=x||event;var y=l.getScrollXY();w.style.top=(x.clientY+y[1]+5)+"px";w.style.left=(x.clientX+y[0]+5)+"px"}}(v));p(document.body,"mousemove",v.followMouse)}function e(v){s(document.body,"mousemove",v.followMouse);v.followMouse=null;try{delete v.followMouse}catch(w){}}function i(){q=this}function u(){q=null}function f(){return true}function a(){return false}function m(){if(r){e(r);r.parentNode.removeChild(r);r=null}document.onselectstart=f;document.onmousedown=f;l.removeClass(document.body,"dnd")}function t(w){w=w||event;var v=w.target||w.srcElement;if(v&&!v.inpl_isDropTarget){while((v&&!v.inpl_isDropTarget)||v===document.body){v=v.parentNode}}if(v&&v.inpl_isDropTarget){if(q&&g&&g.inpl_isDraggable&&typeof v.inpl_ondrop==="function"){v.inpl_ondrop(g)}}m();r=null;g=null}function d(w){g=this;w=w||event;var v=w.target||w.srcElement,z,y,x;if(l.hasClass(v,"undraggable")){return}z=l.getScrollXY();x=w.clientY;y=w.clientX;document.onselectstart=a;document.onmousedown=a;this.mTimeout=setTimeout(function(){if(r){r.parentNode.removeChild(r)}if(g){r=g.inpl_getClone()}if(r){l.addClass(r,"dragClone");r.style.top=(x+z[1]+5)+"px";r.style.left=(y+z[0]+5)+"px";document.body.appendChild(r);o(r);l.addClass(document.body,"dnd")}},200)}function k(){clearTimeout(this.mTimeout)}function h(v){return function(w){if(w!==this){return v(w)}else{return null}}}n={init:function(){p(document,"mouseup",t)},makeDropTarget:function j(w,v){p(w,"mouseover",i);p(w,"mouseout",u);w.inpl_ondrop=h(v);w.inpl_isDropTarget=true;l.addClass(w,"dropTarget");return w},unmakeDropTarget:function(v){s(v,"mouseover",i);s(v,"mouseout",u);v.inpl_ondrop=null;v.inpl_isDropTarget=false;v.onmousedown=v.onmouseup=null;l.removeClass(v,"dropTarget")},makeDraggable:function(w,v){p(w,"mousedown",d);p(w,"mouseup",k);w.inpl_isDraggable=true;w.inpl_getClone=v||c;return w},unmakeDraggable:function(v){s(v,"mousedown",d);s(v,"mouseup",k);v.onmousedown=v.onmouseup=null;v.inpl_isDraggable=false;v.inpl_getClone=null}};return n}());(function(){var f=Inpl.Mail,i=f?f.DOM:PROFILE?PROFILE.dom:{},c=i.createElement,b=false,g=2,j=15,d=15,m,a,h;try{a=new Gettext({domain:"inpl_mail_ui_bubble",locale_data:f.L10n});h=function(e){return a.gettext(e)}}catch(k){h=function(e){return e}}m=document.createElement("p").style;if((f&&f.browser&&f.browser.supports.cssTransitions)||"MozTransition" in m||"WebkitTransition" in m||"transition" in m){b=true}function l(e){this.htmlNodes={};function n(o){if(o in e){this[o]=e[o]}}this.ownerElement=document.body;if(e){["hideCheckbox","ownerElement","content","prefName","dontShowAgainText","closeText","closeButtonSilent","onAfterClose","onAfterOpen"].forEach(n,this);if(e.endDate){this.endDate=new Date(e.endDate)}}}l.prototype={content:"imui-bubble dummy content",open:function(r,t,q,o,p){t=t||"top-left";r=r||document.body;p=p||false;var e,s=this.htmlNodes,n;if("prefName" in this){n=parseInt(f.Prefs.get(this.prefName),10)}if(!o){if("prefName" in this){if(n===0){return false}else{if(n>0){n--;f.Prefs.set(this.prefName,n)}}}if("endDate" in this){if(this.endDate<new Date()){return false}}}s.closeButton=c("button",{className:"imui-bubble-close",innerHTML:"<span>"+(this.closeText||h("Zamknij"))+"</span>",onclick:this.close.bind(this,false)});s.arrow=c("span",{className:"imui-bubble-arrow imui-bubble-arrow-"+t.split("-")[0]});e=[s.closeButton,this.content];if(this.prefName&&!this.hideCheckbox){e.push(c("label",{className:"imui-bubble-cbox-label",childNodes:[s.dontShowAgainCBox=c("input",{type:"checkbox"}),this.dontShowAgainText||h("nie pokazuj tego komunikatu")]}))}s.container=c("div",{className:"imui-bubble imui-bubble-"+t,childNodes:[c("div",{className:"imui-bubble-content",childNodes:e}),s.arrow],style:{visibility:"hidden"}});this.ownerElement.appendChild(s.container);this.relatedElement=r;this.positionType=t;this.isOpened=true;if(q){this.posUpdInterval=setInterval(this.updatePosition.bind(this,p),700)}this.updatePosition(p);if(typeof this.onAfterOpen==="function"){this.onAfterOpen()}return true},updatePosition:function(o){if(i.hasClass(this.ownerElement,"tabBody")&&!i.hasClass(this.ownerElement,"activeBodyTab")){return}var s=this.positionType,p=this.relatedElement,e,r=this.htmlNodes,n=r.container.style,q=r.arrow.style;e=this.getPosition(p,s,o);n.top=e.top;n.left=e.left;n.visibility="visible";e=this.getArrowPosition(s);q.top=e.top;q.left=e.left},close:function(r){var o=this;if(!o.isOpened){return}if(o.posUpdInterval){clearInterval(o.posUpdInterval);delete o.posUpdInterval}var q=o.htmlNodes,p=q.container,n=parseInt(f.Prefs.get(o.prefName),10);if(!r){if(q.dontShowAgainCBox){if(n!==0&&q.dontShowAgainCBox.checked){f.Prefs.set(o.prefName,0,true)}else{if(n===0&&!q.dontShowAgainCBox.checked){f.Prefs.set(o.prefName,-1,true)}}}}function e(s){o.isOpened=false;if(p&&p.parentNode){p.parentNode.removeChild(p)}delete q.container;delete q.closeButton;delete q.arrow;delete o.positionType;delete o.relatedElement;if(typeof o.onAfterClose==="function"&&!r){o.onAfterClose()}}if(b){i.addClass(p,"imui-bubble-disappear");setTimeout(e,800)}else{e()}if(o.closeButtonSilent){Inpl.Mail.Prefs.set(o.prefName,0)}},getArrowPosition:function(q){q=q||"top-left";var n=this.htmlNodes.container,p=this.htmlNodes.arrow,o,e;if(q==="left"||q==="right"){return{top:(n.clientHeight-p.offsetHeight)/2+"px",left:(q==="left"?-p.offsetWidth:n.clientWidth)+"px"}}else{q=q.split("-");switch(q[0]){case"top":o=-p.offsetHeight+"px";break;case"bottom":o="auto";break}switch(q[1]){case"left":e=j+"px";break;case"right":e=(n.clientWidth-j-p.offsetWidth)+"px";break;case"center":e=(n.clientWidth-p.offsetWidth)/2+"px";break}}return{top:o,left:e}},getPosition:function(q,p,s){p=p||"top-left";var o={},n=this.htmlNodes.container,u=this.htmlNodes.arrow,t=s?i.findParentPos(q):i.findPos(q),r=t[1],e=t[0];if(p==="left"||p==="right"){o.top=(r+q.offsetHeight/2-n.offsetHeight/2)+"px";if(p==="right"){o.left=(e-(u.offsetWidth+g+n.offsetWidth)+"px")}else{o.left=(e+q.offsetWidth+u.offsetWidth+g+"px")}}else{p=p.split("-");switch(p[0]){case"top":o.top=(r+q.offsetHeight+d);break;case"bottom":o.top=(r-n.offsetHeight-d);break}o.top+="px";var v=Math.max(q.offsetWidth,q.clientWidth);switch(p[1]){case"left":o.left=e+v/2-j-u.offsetWidth/2;break;case"right":o.left=e+v/2-(n.clientWidth-j-u.offsetWidth/2);break;case"center":o.left=e+v/2-n.clientWidth/2;break}o.left+="px"}return o}};l.closeAll=function(){Array.forEach(i.elmsByClass("imui-bubble-close"),function(e){e.click()})};if(!window.Inpl){window.Inpl={}}if(!Inpl.Mail){Inpl.Mail={UI:{}}}Inpl.Mail.UI.Bubble=l}());(function(){var a,i=false,d=Inpl.Mail,f=d.DOM,b=f.createElement,e=f.addEvent,h=f.removeEvent;function c(l,k){return function(m){k.node.style.display="none";m=m||event;l.cmd.call(k,this,m);k.hide();k.node.style.display="";return false}}function j(){e(document,"click",function(l){l=l||event;var k=l.target||l.srcElement;while(k){if(f.hasClass(k,"popupMenu")||f.hasClass(k,"menu-activator")){return}k=k.parentNode}a.hideAll()});i=true}function g(m,k){function l(o,n){if(typeof n==="boolean"){return o||n}else{if(typeof n==="function"){return o||!!n(k)}else{if(n&&typeof n.reduce==="function"){return o||n.reduce(l,false)}else{if(typeof n==="undefined"){return o}else{throw new Error("reduceAlternative received incorrect items")}}}}}return l(false,m)}a=function(l,k,o,m,p,n){if(!i){j()}this.node=b("div",{className:"popupMenu"+(m?" "+m:"")});this.items=l;if(o&&k){this.attachTo(k,o,m)}if(typeof p==="function"){this.beforeShow=p}if(typeof n==="function"){this.afterHide=n}a.instances.push(this)};a.prototype={attachTo:function(k,n,l){var m=this;f.addEvent(k,"contextmenu",function(){return function(p){p=p||event;f.preventDefault(p);var o=p.target||p.srcElement;while(o!==k){if(o.nodeName===n||f.matchesSelector(o,n)){break}o=o.parentNode}if(o!==k&&!f.hasClass(o,"disableCtxmenu")){m.show(o,p,l)}}}(k,n,l))},show:function(k,y,n,B,v){a.hideAll();this.contextNode=k;if(typeof this.beforeShow==="function"){this.beforeShow(y)}this.node.innerHTML="";var r,u,o,l,C,m,w,A,q=document.createElement("ul"),t=this.items,z,x,p,s;for(x=0;x<t.length;x+=1){z=t[x];p=g(z.ommit,k);s=g(z.disabled,k);if(!p){if(z.separator||z==="-"){this.node.appendChild(q);this.node.appendChild(b("hr"));q=b("ul")}else{r=b("li");if(!s){u=b("a",{href:"#",childNodes:[z.label],onclick:c(z,this)});r.className="ctxMLiEnabled"}else{u=b("span",{className:"ctxMItemDisabled",innerHTML:z.label});r.className="ctxMLiDisabled"}if(z.additionalHtml&&u.insertAdjacentHTML){u.insertAdjacentHTML("beforeend",z.additionalHtml)}r.appendChild(u);q.appendChild(r)}}}this.node.appendChild(q);r=null;o=this.node.childNodes;for(x=0;x<o.length;x+=1){if(o[x].firstChild){o[x].firstChild.tabIndex=this.contextNode.tabIndex}}if(y){m=document.body.scrollTop?document.body.scrollTop:document.documentElement.scrollTop;w=document.body.scrollLeft?document.body.scrollLeft:document.documentElement.scrollLeft}this.node.style.left=this.node.style.top=-1000+"px";if(n){this.node.className="popupMenu "+n}else{this.node.className="popupMenu"}l=document.documentElement.offsetHeight;if(Inpl.Mail.browser.ie>6){l=document.documentElement.scrollHeight}else{if(Inpl.Mail.browser.ie>0){l=document.body.scrollHeight}}document.body.appendChild(this.node);C=this.node.offsetHeight;if(v===undefined){if(y.clientY+m+C+10>l){this.node.style.top=(l-C-10)+"px"}else{this.node.style.top=y.clientY+m+"px"}}else{this.node.style.top=v}if(B===undefined){if(y.clientX+w<document.documentElement.offsetWidth-this.node.offsetWidth-25){this.node.style.left=y.clientX+w+"px"}else{this.node.style.left=(document.documentElement.offsetWidth-this.node.offsetWidth-25)+"px"}}else{this.node.style.left=B}this.isShown=true},hide:function(){if(this.contextNode){if(this.node&&(this.node.parentNode===document.body)){document.body.removeChild(this.node)}}this.contextNode=null;if(typeof this.afterHide==="function"){this.afterHide()}this.isShown=false},destroy:function(){var m,k=a.instances,l=null;this.hide();this.node=null;for(m=k.length;m--;){if(k[m]===this){l=m}}if(l){k.splice(l,1)}}};a.instances=[];a.hideAll=function(){a.instances.forEach(function(k){k.hide()})};Inpl.Mail.UI.CtxMenu=a}());(function(){var a=Inpl.Mail,f=a.DOM,c=f.createElement,b,e;var d=function(h,g,k,i,l,j){a.UI.CtxMenu.call(this,h,g,k,i,l,j)};d.prototype=Object.create(Inpl.Mail.UI.CtxMenu.prototype);e=d.prototype;e.attachTo=function(g,j,h){var i=this,k=f.elmsByClass("menu-activator",g);if(k&&k[0]){f.addEvent(k[0],"click",function(){return function(m){m=m||event;f.preventDefault(m);var l=m.target||m.srcElement;while(l!==g){if(l.nodeName===j||f.matchesSelector(l,j)){break}l=l.parentNode}if(l!==g&&!f.hasClass(l,"disableCtxmenu")){i.show(l,m,h)}}}(k[0],j,h))}f.addEvent(g,"contextmenu",function(){return function(m){m=m||event;f.preventDefault(m);var l=m.target||m.srcElement;while(l!==g){if(l.nodeName===j||f.matchesSelector(l,j)){break}l=l.parentNode}if(l!==g&&!f.hasClass(l,"disableCtxmenu")){i.show(l,m,h)}}}(g,j,h))};e.show=function(m,j,l,o,n){if(j.button==0&&j.type!=="contextmenu"){var k=m.parentNode.firstChild,i=f.findPos(m.parentNode),h=i[0]+m.parentNode.offsetWidth-2,g=i[1],p=f.elmsByClass("side-cnt-list");if(m.parentNode.id.indexOf("fli_")==-1){h+=4;if(p&&p[0]){g=g-p[0].scrollTop-4}else{g-=4}}else{g=g-$("ful_my").scrollTop}a.UI.CtxMenu.prototype.show.call(this,k,j,"side-ctx-menu",h+"px",g+"px");b=f.elmById("menu-plug");if(b){f.removeClass(b,"hide")}else{b=c("span",{className:"side-ctx-menu-plug",innerHTML:"<span class='folder-action-icon'/>",id:"menu-plug"});document.body.appendChild(b)}b.style.left=(h-19)+"px";b.style.top=g+"px"}else{a.UI.CtxMenu.prototype.show.call(this,m,j,l,o,n)}};e.hide=function(){a.UI.CtxMenu.prototype.hide.call(this);b=f.elmById("menu-plug");f.addClass(b,"hide")};Inpl.Mail.UI.AttachableCtxMenu=d}());(function(){var b=Inpl.Mail,h=b.DOM,g=b.UI,f=h.createElement,d=h.addEvent,e=h.removeEvent,c;function a(i){i=i||event;var l=15,k=h.getScrollXY(),j=c.tooltipElement.style;j.top=(i.clientY+k[1]+l)+"px";j.left=(i.clientX+k[0]+l)+"px"}c={show:function(j){if(this.isShown){this.hide()}var i=f("div",{className:"rich-tooltip"});if(typeof j==="string"){i.innerHTML=j}else{try{i.appendChild(j)}catch(k){throw"Invalid content for RichTooltip.show"}}document.body.appendChild(i);this.tooltipElement=i;d(document.body,"mousemove",a);this.isShown=true},hide:function(){var i=this.tooltipElement;if(i){document.body.removeChild(i);i=this.tooltipElement=null;e(document.body,"mousemove",a)}this.isShown=false}};g.RichTooltip=c}());(function(){var b=Inpl.Mail,e=b.DOM,d=b.UI,c=e.createElement,a;a={observe:function(j,i,h,g,f,k){k=k===undefined?1000:k;if(!j||!i||!h){throw new TypeError("UtilLayer.observe missing required arguments")}function l(n){n=n||event;var o,m=n.target||n.srcElement;while(m!==document.body&&!e.hasClass(m,i)&&!e.hasClass(m,"util-layer")){m=m.parentNode}if(m===document.body){a.hide()}if(m&&e.hasClass(m,i)){o=e.findPos(m);m.inpl_utilLayerTimeout=setTimeout(function(){var p=g,q=f;if(p===undefined){p=m.offsetWidth/2}if(q===undefined){q=m.offsetHeight/2}b.UI.UtilLayer.show(h(m),o[0]+p,o[1]+q);m.onmouseout=null},k);m.onmouseout=function(){clearTimeout(m.inpl_utilLayerTimeout);try{delete m.inpl_utilLayerTimeout}catch(p){}m.onmouseout=null}}}e.addEvent(j,"mouseover",l)},show:function(g,f,j){if(this.isShown){this.hide()}var h=c("div",{className:"util-layer"});if(typeof g==="string"){h.innerHTML=g}else{try{h.appendChild(g)}catch(i){throw"Invalid content for UtilLayer.show"}}document.body.appendChild(h);h.style.top=5+j+"px";h.style.left=5+f+"px";this.layerElement=h;this.isShown=true},hide:function(){var f=this.layerElement;if(f){document.body.removeChild(f);f=this.layerElement=null}this.isShown=false}};d.UtilLayer=a}());Inpl.Mail.UI.Pager=(function(){var b=Inpl.Mail.DOM.createElement;function a(c){this.currentPage=c.currentPage||1;this.pagesCount=c.pagesCount;this.onPageChange=c.onPageChange;this.containerElement=c.containerElement}a.prototype={render:function(){var d,c,e=this,f=[],g=this.containerElement;if(!g){throw new Error("Pager does not have a containerElement, thus cannot be rendered")}if(e.pagesCount>1){for(d=1;d<=e.pagesCount;d++){if(d===1||d>e.pagesCount-1||Math.abs(e.currentPage-d)<5){if(c!==d-1&&d!==1){f.push(b("li",{innerHTML:"…"}))}f.push(b("li",{className:(d===e.currentPage?"pack-selected":""),childNodes:[b("a",{packNo:d,href:"#p"+d,onclick:e.setCurrentPage.bind(e,d),innerHTML:d})]}));c=d}}}g.innerHTML="";g.appendChild(b("ul",{className:"packs-list",childNodes:f}))},setCurrentPage:function(c){this.currentPage=c;this.render();if(this.onPageChange){this.onPageChange(c);Inpl.Mail.Tools.hitGFK()}}};return a}());(function(){var g=Inpl.Mail,m=g.DOM,f=g.UI,c=m.createElement,e="scrollable-inactive",n=1,d=-1,b=10,j=50,a=25,p,i;p={inpl_scroll:function o(r){var u=this,v=u.scrollLeft,t=v+r,q=u.scrollRightBtn,s=u.scrollLeftBtn;if(u.scrollWidth<=u.clientWidth){q.style.display=s.style.display="none";m.removeClass(this.parentNode,"scrollable-show-arrows")}else{q.style.display=s.style.display="";m.addClass(this.parentNode,"scrollable-show-arrows")}if(t<=0){t=0;m.addClass(u.scrollLeftBtn,e);if(this.inpl_scrollInterval){clearInterval(this.inpl_scrollInterval)}}else{if(t>=u.scrollWidth-u.clientWidth){t=u.scrollWidth-u.clientWidth;m.addClass(u.scrollRightBtn,e);if(this.inpl_scrollInterval){clearInterval(this.inpl_scrollInterval)}}else{m.removeClass(u.scrollLeftBtn,e);m.removeClass(u.scrollRightBtn,e)}}u.scrollLeft=t},inpl_startScroll:function l(s,r){s=s||n;r=r||event;var q=this;clearInterval(this.inpl_scrollInterval);q.inpl_scroll(s*j);this.inpl_scrollInterval=setInterval(function(){q.inpl_scroll(s*b)},a);m.preventDefault(r);m.stopPropagation(r);return false},inpl_stopScroll:function h(){clearInterval(this.inpl_scrollInterval)}};i={mixin:p,wrapModes:{BEFORE:0,AFTER:1,AROUND:2},apply:function k(u,w,v,t,r){var s,y,q,x=i.wrapModes;r=r||i.wrapModes.BEFORE;Object.keys(p).forEach(function(z){u[z]=p[z]});if(w&&!u.scrollRightBtn){s=u.inpl_stopScroll.bind(u);y=u.parentNode;q=c("div",{className:"scrollable-wrapper"});y.replaceChild(q,u);q.appendChild(u);u.scrollRightBtn=c("span",{className:"scrollable-right scrollable-arrow",innerHTML:t||"&gt;",onmousedown:u.inpl_startScroll.bind(u,n),onmouseup:s,onmouseout:s});u.scrollLeftBtn=c("span",{className:"scrollable-left scrollable-arrow",innerHTML:v||"&lt;",onmousedown:u.inpl_startScroll.bind(u,d),onmouseup:s,onmouseout:s});switch(r){case x.BEFORE:y.insertBefore(u.scrollLeftBtn,q);y.insertBefore(u.scrollRightBtn,q);break;case x.AFTER:y.appendChild(u.scrollLeftBtn);y.appendChild(u.scrollRightBtn);break;case x.AROUND:y.insertBefore(u.scrollLeftBtn,q);y.appendChild(u.scrollRightBtn);break}}u.inpl_scroll(0)}};f.Scrollable=i}());Inpl.Mail.UI.ModalDialogs=(function(){var c=Inpl.Mail.UI,k=Inpl.Mail.DOM,b=k.createElement,a=new Gettext({domain:"inpl_mail_ui_modaldialogs",locale_data:Inpl.Mail.L10n}),l=function(q){return a.gettext(q)},p,i,n,h,g=false,j=[];function o(q){return document.createTextNode(q)}function m(r){var q=document.createDocumentFragment();q.appendChild(o(r));q.appendChild(b("br"));return q}function f(){if(typeof this.onBeforeAccept==="function"){if(!this.onBeforeAccept()){return}}this.hide();if(this.onAccept){this.onAccept()}}function e(){this.hide();if(this.onCancel){this.onCancel()}}p={acceptLabel:l("Ok"),message:"dummy alert",title:l("Informacja"),onAccept:null,onShow:null,onHide:null,type:null,hideIcons:false,show:function(){g=true;var r=this,q=r.createButtons(),s=[];if(r.title!==null){s.push(b("h2",{childNodes:[b("span"),o(r.title)]}))}s.push(r.createInnerDiv());if(!r.hideButtons){s.push(b("div",{className:"overlayButtons"+(r.hideIcons?" overlayButtonsHiddenIcons":""),childNodes:q}))}if(r.createFooter){s.push(r.createFooter())}Inpl.Mail.UI.showOverlay(b("div",{className:"overlay"+(this.additionalClass?" "+this.additionalClass:""),childNodes:s}),null,true);if(q&&q[0]){q[0].focus()}if(typeof r.onShow==="function"){r.onShow()}},createInnerDiv:function(){var q=this.message;if(this.type=="htmlText"){return b("div",{className:"",innerHTML:q})}if(Object.prototype.toString.call(q)==="[object String]"){return b("div",{childNodes:String.prototype.split.call(q,"\n").map(m)})}else{return b("div",{childNodes:q})}},createButtons:function(){var q=b("button",{className:"okBtn",innerHTML:"<span>"+this.acceptLabel+"</span>",onclick:f.bind(this)});return[q]},hide:function(){c.hideOverlay();g=false;var r=this;var q=j.shift();if(q){q.show()}if(typeof r.onHide==="function"){r.onHide()}},enqueue:function(){j.push(this);j.showNext();return this}};n=Object.create(p);n.createInnerDiv=function(){return b("div",{innerHTML:this.message})};i=Object.create(p);i.title=l("Prośba o potwierdzenie");i.cancelLabel=l("Anuluj");i.createButtons=function(){var r=this,q,s;q=b("button",{className:"okBtn",innerHTML:"<span>"+r.acceptLabel+"</span>",onclick:f.bind(r)});s=b("button",{className:"cancelBtn",innerHTML:"<span>"+r.cancelLabel+"</span>",onclick:e.bind(r)});return[q,s]};h=Object.create(i);h.createInnerDiv=n.createInnerDiv;function d(q,t){var s,r=Object.create(t||p);for(s in q){if(q.hasOwnProperty(s)){r[s]=q[s]}}return r}j.showNext=function(){var q;if(!g){q=j.shift();if(q){q.show()}}};return{prototypes:{alertDialog:p,confirmationDialog:i,richAlertDialog:n,richConfirmationDialog:h},createModalDialog:d,alert:function(q){return d(q).enqueue()},confirm:function(q){return d(q,i).enqueue()},richAlert:function(q){return d(q,n).enqueue()},richConfirm:function(q){return d(q,h).enqueue()}}}());Inpl.Mail.UI.PopupMenu=(function(){var j="popupMenu",d="isOpen",f=Inpl.Mail,e=f.UI,i=f.DOM,b=i.createElement,g=f.Tools,h=i.addEvent,l=i.removeEvent;function m(s,n,r,p){s=s||"menu";r=r||a.hideAll;var o=document.createElement("ul"),q=b("div",{id:s,className:j+(p?" "+p:""),childNodes:[o]});n.forEach(function(w){var v,u,t;if(w.specialElement){w.specialElement.title=w.label;w.specialElement.innerHTML=w.label;o.appendChild(b("li",{className:"ctxMLiEnabled",childNodes:[w.specialElement]}))}else{if(w!=="-"){v=document.createDocumentFragment();if(w.beforeContent){v.appendChild(w.beforeContent)}v.appendChild(document.createTextNode(w.label));if(w.afterContent){v.appendChild(w.afterContent)}if(w.disabled){u=b("span",{childNodes:[v]})}else{u=b("a",{href:"#",title:w.label,onclick:function(x){x=x||event;w.cmd();r(s);i.preventDefault(x);return false},childNodes:[v]});if(w.indentLevel){u.style.marginLeft=w.indentLevel+"ex"}}t={childNodes:[u]};if(w.className){t.className=w.className+(w.disabled?" ctxMLiDisabled":" ctxMLiEnabled")}else{t.className=w.disabled?"ctxMLiDisabled":"ctxMLiEnabled"}o.appendChild(b("li",t))}else{q.appendChild(document.createElement("hr"));o=document.createElement("ul");q.appendChild(o)}}});return q}function k(n){function o(p){if(!p){p=event}var q=n,r=p.target||p.srcElement;while(true){if(r===q){return}if(r===document.body||r===document.documentElement){a.hideAll();l(document.body,"click",o);return}if(r.parentNode){r=r.parentNode}else{return}}}return o}var c=0;function a(n,q,p,o){this.items=n;this.id=q||"imui-popupmenu-"+(c++);this.closeFunc=p;this.className=o}g.augment(a.prototype,{show:function(o){var q,p;a.hideAll();if(!o){return false}q=m(this.id,this.items,this.closeFunc,this.className);p=f.DOM.findPos(o);q.style.left=p[0]+"px";q.style.top=(p[1]+o.offsetHeight+2)+"px";document.body.insertBefore(q,document.body.firstChild);this.handleDocClicks=k(o,this.id);h(document.body,"click",this.handleDocClicks);var n=document.getElementById(this.className);if(n){n.className+=" "+d}return true}});a.hideAll=function(){var n=i.nodeListToArray(i.elmsByClass(j));n.forEach(function(q){var p=q.className.replace(j+" ","");var o=document.getElementById(p);if(o){o.className=o.className.replace(d,"")}q.parentNode.removeChild(q)})};return a}());Inpl.Mail.UI.Suggestable=(function(){var d=750,j="data-inpl-sugg-timeout",h="data-inpl-sugg-index",a=Inpl.Mail,g=a.DOM,b=Inpl.Mail.Network,c=g.addEvent,i=g.removeEvent;var f=[];var e={keyDownHandler:function(k){var m=k.target||k.srcElement,l=f[m.getAttribute(h)];clearTimeout(m.getAttribute(j));if(l.keyDownHandler){l.keyDownHandler()}if(k.keyCode===38||k.keyCode===40||k.keyCode===13){l.handleKey(k.keyCode);return g.preventDefault(k)}else{m.setAttribute(j,setTimeout(function(){e.doSuggest(m,l)},d))}return undefined},doSuggest:function(k,m){var l=k.value;m.provideSuggestions(l,function(n){if(k.value==l){m.render(k,n)}})},makeSuggestable:function(k,l){k.setAttribute(h,f.length);f.push(l);c(k,"keydown",e.keyDownHandler)},unmakeSuggestable:function(k){i(k,"keydown",e.keyDownHandler)}};return e}());(function(){var e=Inpl.Mail,f=e.DOM,d=e.UI,c=new Gettext({domain:"inpl_mail_ui_windowtitle",locale_data:e.L10n}),g=function(n){return c.gettext(n)},j=g("Poczta w Interii"),b=0,k=0,m="";function l(){var n="";if(b||k){n=g("Nowe:")+" ";if(b){n+=c.strargs(g("Poczta (%1)"),[b])}if(b&&k){n+=", "}if(k){n+=c.strargs(g("Ding (%1)"),[k])}}else{if(m.length>0){n=m}}if(n.length>0){n+=" - "}document.title=n+j}d.WindowTitle={init:function(){f.addEvent(window,"focus",d.WindowTitle.clearNotifications)},clearNotifications:function(){k=0;b=0;l()},setDingCount:function h(n){if(n!=="10+"){n=parseInt(n,10)}if(n>10){k="10+"}else{k=n}l()},setMailCount:function i(n){if(n!=="10+"){n=parseInt(n,10)}if(n>10){b="10+"}else{b=n}l()},setText:function a(n){m=n;l()}}}());Inpl.Mail.Blacklist=(function(){var b=Inpl.Mail,c=[];function a(e){var d;for(d=0;d<c.length;d++){if(e===c[d]){return d}}return false}return{init:function(d){if(d.length){c=d.sort()}},checkEmail:function(d){var e;for(e=0;e<c.length;e++){if(d===c[e]){return true}}return false},removeEmail:function(e){var f=b.Blacklist.checkEmail(e),d;if(f){d=a(e);c=((d>1)?(c.slice(0,d)+","):""+c.slice(d+1)).split(",")}},addEmailWithCheck:function(d,f){var e=this;b.ContactsWarnList.doAction(d,"Czy na pewno dodać ten adres do zablokowanych?",e.addEmail.bind(e,d,f))},addEmail:function(d,f){var e=b.Blacklist.checkEmail(d);if(!e){b.Network.ajax({url:"/html/addtoblack,email,"+d,onSuccess:function(g){g=b.Network.parseResponse(g);if(g.status){c.push(d);c.sort();if(f&&typeof f.success==="function"){f.success(g)}}else{if(f&&typeof f.fail==="function"){f.fail(g)}}}})}}}}());Inpl.Mail.UploadAvatar=(function(){var a=Inpl.Mail;function b(f,e,d,g,h){var c;this.suffix=f;this.avatarImageDiv=$("avatar-image_"+f);this.changeText=e;this.addText=d;this.deleteNode=g;this.chooseNode=h;a.DOM.addEvent(g,"click",this.deleteAvatar.bind(this));c=a.DOM.getStyle((a.DOM.elmsByClass("avatarUploadLink")[0]),"color");g.style.color=c;h.style.color=c;this.avatarLinks()}b.prototype={noAvatar:function(){a.DOM.addClass(this.avatarImageDiv,"dummy_contact")},avatarUploaded:function(f,g){var e,d,c;$("hasAvatar_"+this.suffix).value="true";this.displayImage=1;e=$("avatar_"+this.suffix);if(e){e.value=f}a.DOM.removeClass(this.avatarImageDiv,"dummy_contact");d=$("avatar-image-uploaded"+this.suffix);if(d){this.avatarImageDiv.removeChild(d)}c=this.addNewAvatarImage(g);this.avatarImageDiv.appendChild(c);this.avatarLinks()},currentAvatar:function(e){var c,d;$("hasAvatar_"+this.suffix).value="true";this.displayImage=1;a.DOM.removeClass(this.avatarImageDiv,"dummy_contact");c=this.addNewAvatarImage(e);d=$("avatar-image-uploaded"+this.suffix);if(d){this.avatarImageDiv.replaceChild(c,d)}else{this.avatarImageDiv.appendChild(c)}this.avatarLinks()},deleteAvatar:function(){$("avatar_"+this.suffix).value=0;this.avatarImageDiv.removeChild($("avatar-image-uploaded"+this.suffix));a.DOM.addClass(this.avatarImageDiv,"dummy_contact");$("hasAvatar_"+this.suffix).value="false";this.displayImage=0;this.avatarLinks()},addNewAvatarImage:function(c){return a.DOM.createElement("img",{src:c,id:"avatar-image-uploaded"+this.suffix})},avatarLinks:function(){if(this.displayImage){this.deleteNode.style.display="inline";this.chooseNode.innerHTML=this.changeText+" &raquo;"}else{this.deleteNode.style.display="none";this.chooseNode.innerHTML=this.addText+" &raquo;"}}};return b}());(function(){var s=Inpl.Mail,t=Inpl.LoadableModules,m=s.Tools,E=s.DOM,w=s.UI,C=E.createElement,h=E.addEvent,b=E.removeEvent,f=new Gettext({domain:"inpl_mail_composition",locale_data:s.L10n}),e=function(T){return f.gettext(T)},J=/\.(pcx|ico|cur|xbm|tga|targa|bmp|gif|ras|xpm|pnm|pbm|pgm|ppm|ani|jpeg|jpe|jpg|wbmp|tiff|tif|png)$/gi,g=/[a-z0-9!#$%&'*+=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/gi,o=false,L=0,I=["jpeg","jpg","png","bmp","gif"],D=";",P=C("textarea",{value:"\n-- \n"}).value,u="-- \n",F="\n\n",K=25,x=e("Nowa wiadomość"),q=416;var N={ajax:function(V,X){var U="/html/gallery",Z="post",Y="";var W={mId:V,state:X};if(window.XMLHttpRequest){var T=new XMLHttpRequest()}else{var T=new ActiveXObject("Microsoft.XMLHTTP")}if(Z=="post"){this.ajaxPost(T,U,W,Y)}},ajaxPost:function(U,T,V,X){var W="mId="+V.mId+"&state="+V.state;U.open("POST",T,true);U.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");U.setRequestHeader("X-Requested-With","XMLHttpRequest");U.setRequestHeader("X-HTTP-Method-Override","PUT");U.setRequestHeader("X-XSRF-TOKEN",s.env.uid);U.send(W);U.onreadystatechange=function(){if(U.readyState===4&&U.status===200){var Y=JSON.parse(U.response);if(!Y.status){X(V.id,V.isStarred)}}else{if(U.readyState===4){X(V.id,V.isStarred)}}}}};function Q(T){return document.createTextNode(T)}function A(T){T.addToInput()}function B(T){return T.id}function i(U){var T=0;return m.decodeEntities(m.stripTags(U.replace(/<li>|<p>|<br\s*\/?>/ig,function(V){T+=1;if(/<p>/ig.test(V)){return(T>1)?"\n\n":""}else{if(/<li>/ig.test(V)||V==="<li>"){return(s.browser.gecko||T>1&&!s.browser.ie)?"\n* ":"* "}else{return"\n"}}})))}function k(T){return T.replace(/</g,"&lt;").replace(/\r\n/g,"<br/>").replace(/\n/g,"<br/>")}function z(X,W,ab){var Y=e("Wiadomość graficzna"),U=e("Wiadomość tekstowa"),Z=e("Wyślij wiadomość graficzną"),V=e("Wyślij wiadomość tekstową"),aa=document.createDocumentFragment();function T(ag,af,ae,ad){var ac;return{href:"#mode-switch",tabIndex:2,innerHTML:ag,className:ad,title:af,onclick:function(ah){ab.switchMode(ae);E.preventDefault(ah||window.event);switch(ae){case"stationery":ac="nS06D3u_bwXqnhMvZiRfU5a2fcApHIciAXxPiJJJwvn.p7";break;case"video":ac="Bx2ab_O4fwbfio1KIGvTrJaE3y4ppa_JK3QHBmb.6Ej.T7";break;default:if(this.innerHTML==U){ac="nS06D3u_bwaE5Fz23TYTT5a235gpHK_VAZIHRxImQOj.67"}else{ac="B70wC_NIk_2JFXavoJzf6pa2P6IpHG7Gy1lXGxbaGHz.W7"}break}s.Tools.hitGemius(ac);return false}}}if(!E.hasClass(X.lastChild,"simpleMessage")){aa.appendChild(C("a",T(e("Papeterie"),e("Wyślij papeterię"),"stationery","")));aa.appendChild(C("a",T((W=="html")?Y:U,(W=="html")?Z:V,undefined,"swSeparate simpleMessage")));X.appendChild(aa)}else{if(W=="html"){X.lastChild.innerHTML=Y;X.lastChild.title=Z}else{X.lastChild.innerHTML=U;X.lastChild.title=V}}}function r(T){var W,V,U;if(T.email){V=this.value.match(g);if(!V){V=[""]}W=" "+V.join(" ")+" ";U=this.value.trim();if(U.charAt(U.length-1)!==";"&&U.length!==0){U+="; "}else{if(U.length!==0){U+=" "}}if(W.indexOf(" "+T.email+" ")<0){U+=T.getRfcString()+"; "}this.value=U;if(this.grow){this.grow()}E.setSelectionRange(this,U.length,U.length)}}function M(T){T=T||event;if(T.keyCode===13){E.preventDefault(T)}}function d(){E.addClass(this,"focus")}function H(){E.removeClass(this,"focus")}function y(W,U,T){var V=C("textarea",{id:W,accessKey:U,tabIndex:T});h(V,"keypress",M);h(V,"focus",d);h(V,"blur",H);w.makeGrowable(V);return V}function S(){w.RichTooltip.hide()}function j(U,V){var T=new FileReader();T.onload=function(){V.onmouseover=function(){var W=C("div",{className:"upload-preview",childNodes:C("img",{src:T.result,alt:"Podgląd załącznika"})});w.RichTooltip.show(W)};V.onmouseout=S};T.readAsDataURL(U)}function G(){s.Composition.lastActiveInput=this}function O(W,V,T){var U=y(W,V,T);h(U,"focus",G);U.addAddress=r;if(s.browser.supports.dnd){w.DnD.makeDropTarget(U,function(X){if(X.relatedContact){_gaq.push(["b._trackEvent","Drag and drop","Dodanie odbiorcy wiadomości"]);U.addAddress(X.relatedContact)}})}U.onkeyup=function(X){s.ContactList.suggestContacts(this,A);this.grow()};return U}function a(){try{this.contentWindow.document.getElementsByTagName("input")[0].focus()}catch(T){}}function c(){var U=s.UI.ModalDialogs,T=this,V;if(T.contentChanged){T.show();V=U.createModalDialog({title:e("Prośba o potwierdzenie"),message:e('Czy zapisać wiadomość w folderze "Kopie robocze"?'),createButtons:function(){return[C("button",{innerHTML:e("Tak"),className:"saveT",onclick:function(){$("saveT_nav1").click();V.hide()}}),C("button",{innerHTML:e("Nie"),className:"removeBtn",onclick:function(){V.hide();T.close()}}),C("button",{innerHTML:e("Anuluj"),className:"writeBtn",onclick:function(){V.hide()}})]}},U.prototypes.alertDialog);V.enqueue()}else{T.close()}}function l(Z){var Y=[],X=0,U,T=Z.length,aa,W,V=function(ab){var ae=Z.substr(ab),af,ad,ac="";while(true){af=ae.indexOf(";");ad=ae.indexOf(",");if((af<ad||ad==-1)&&af!=-1){ac+=ae.substring(0,af+1);ae=ae.substr(af+1)}else{if(ad!=-1){ac+=ae.substring(0,ad+1);ae=ae.substr(ad+1)}else{ac+=ae;break}}if(ac&&ac.indexOf("@")!=-1){break}}return ac};while(X<T){U=V(X);X+=U.length+1;U=U.trim();if(U.charAt(U.length-1)==","||U.charAt(U.length-1)==";"){U=U.substring(0,U.length-1)}if(U.indexOf("<")>=0){aa=U.substring(U.indexOf("<")+1,U.indexOf(">")).trim();W=U.substring(0,U.indexOf("<")-1).trim();if(W.match(/".*"/g)){W=W.substring(1,W.length-1)}}else{aa=U.trim();W=aa}if(aa){Y.push(new s.Contact({email:aa,name:W}))}}return Y}function v(V,aa,ac,W,U,Y,ad,ab,ae,T,X){this.messageId=V||null;this.content=aa||"\n";this.initialSingatureId=v.defaultSignatureId;this.initialSingatureId=v.defaultSignatureId;this.subject=ac||"";this.attachments=[];this.uploads=[];this.adrTo=W;this.adrCC=U;this.adrBCC=Y;this.stationery=ad;this.priority=v.MSG_PRIORITY.NORMAL;if(ae!==undefined){this.priority=parseInt(ae,10)}this.requireConfirm=!!T;this.htmlNodes={};this.size=0;this.tab=null;this.editor=null;this.params={};this.type=ab;this.isSending=false;var Z=new s.UI.Bubble({content:s.DOM.createElement("div",{innerHTML:"Wszystkie wysłane wiadomości będą automatycznie zapisywane!"}),prefName:"saveAllMailBubble",hideCheckbox:true,closeButtonSilent:true,closeText:"Nie wyświetlaj więcej tego komunikatu."});Z.open(document.getElementById("fbu_2"),"left",false,false);v.instances.push(this)}v.instances=[];v.lastActiveInput=null;v.MSG_TYPE={PLAIN:0,HTML:1};v.SEND_MODE={SEND:1,DRAFT:2,DRAFT_SILENT:4,SEND_SAVE:3};v.MSG_PRIORITY={LOW:5,NORMAL:3,HIGH:1};v.signatures=null;v.prototype={destroy:function(){var U,W=v.instances,V=["tarNewMail_%t%_m-inpl-emoticons","tarNewMail_%t%_mcolor","tarNewMail_%t%_mstyle"],T=this.tab.id;if(this.stationeryBubble){this.stationeryBubble.close();this.stationeryBubble=null}w.RichTooltip.hide();V.forEach(function(X){X=X.replace(/\%t\%/g,T);var Y=$(X);if(Y){Y.parentNode.removeChild(Y)}});for(U in this.htmlNodes){if(this.hasOwnProperty(U)){delete this.htmlNodes[U]}}this.editor.relatedComposition=null;for(U in this){if(this.hasOwnProperty(U)){delete this[U]}}W.splice(W.indexOf(this),1);return null},appendUploadForm:function(){var Y=this,X=this.htmlNodes.attBlock,aa=this.tab.id+"-"+(L++),W,Z,U,T=s.browser.ios,V=s.browser.iosVersion&&s.browser.iosVersion[0]>=6;if(!T||V){W=C("div",{className:"attach-iframe-box",childNodes:[C("span"),C("iframe",{src:"/html/addattach,markmsg,"+this.messageId+",attId,"+aa+",theme,"+w.Theme.currentTheme.id+",uid,"+m.getUid(),className:"attupload-iframe attach",frameBorder:"0",allowTransparency:true,scrolling:"no",height:"25px",tabIndex:2,onfocus:a})]})}Z=C("span",{href:"#",className:"att-purge",childNodes:[C("span"),C("a",{innerHTML:e("Usuń wszystkie załączniki »"),onclick:Y.purgeAttachments.bind(Y,false)})]});U=C("div",{id:"iframe_"+aa,className:"att-operations",childNodes:(T&&!V)?Z:[W,Z]});X.appendChild(U);X.style.display="block"},promptForSignature:function(T){var U=w.ModalDialogs;var V=U.createModalDialog({title:e("Nowy podpis"),acceptLabel:e("Zatwierdź"),onBeforeAccept:function(){var W,Z=v.signatures,Y=this.nameInput,X=this.bodyTar;Y.value=Y.value.trim();if(!Y.value||!X.value){w.showNotice(e("Nazwa i tekst podpisu muszą być wypełnione"),"error overlay-notice");if(!Y.value){Y.focus()}else{X.focus()}return false}else{if(Y.value.length>50){w.showNotice(e("Nazwa podpisu jest zbyt długa"),"error overlay-notice");Y.focus();return false}}for(W in Z){if(Z.hasOwnProperty(W)){if(Z[W].name==Y.value){w.showNotice(e("Podpis o tej nazwie już istnieje"),"error overlay-notice");return false}}}return true},onAccept:T?function(){T(this.nameInput.value,this.bodyTar.value)}:undefined,createInnerDiv:function(){this.nameInput=C("input",{className:"text",id:"signature-prompt-name_"+(new Date).getTime()});this.bodyTar=C("textarea",{id:"signature-prompt-body_"+(new Date).getTime()});return C("div",{childNodes:[C("fieldset",{className:"signature-prompt-fs impexForm",childNodes:[C("label",{innerHTML:e("Nazwa:"),htmlFor:this.nameInput.id}),this.nameInput,C("label",{innerHTML:e("Tekst:"),htmlFor:this.bodyTar.id}),this.bodyTar]})]})}},U.prototypes.confirmationDialog);V.enqueue()},createSignatureSelector:function(){var W=v.signatures,T,U,V=this;U=[C("option",{value:-1,innerHTML:e("brak")})].concat(Object.keys(W).map(function(X){return C("option",{value:X,childNodes:[document.createTextNode(W[X].name)],selected:X==v.defaultSignatureId})})).concat([C("option",{value:-99,innerHTML:"————————",disabled:true}),C("option",{value:-2,innerHTML:e("nowy podpis")})]);T=C("select",{className:"signature-select",childNodes:U});T.onchange=function(){if(window.event&&this.value==-99){this.selectedIndex=0}switch(parseInt(this.value)){case -2:_gaq.push(["b._trackEvent","NowaWiadomość","Podpis","nowy podpis"]);break;case -1:_gaq.push(["b._trackEvent","NowaWiadomość","Podpis","brak podpisu"]);break;default:_gaq.push(["b._trackEvent","NowaWiadomość","Podpis","podpis użytkownika"]);break}if(this.value>-2){V.setSignature(this.value)}else{this.selectedIndex=0;V.promptForSignature(function(X,Y){var Z=(new Date()).getTime();v.signatures[Z]={name:X,value:Y};V.setSignature(Z);T.insertBefore(C("option",{innerHTML:X,value:Z}),T.lastChild.previousSibling);T.selectedIndex=T.options.length-3;v.defaultSignatureId=Z;s.Network.ajax({url:"/html/addsignature",post:{name:X,value:Y},onSuccess:function(aa){aa=s.Network.parseResponse(aa);if(!aa.status){s.UI.showNotice(e("Nie udało się zapisać nowego podpisu."),"error")}}})})}};return C("label",{className:"signature-select-label",childNodes:[document.createTextNode(e("Podpis:")),T]})},setSignature:function(W){var T=this.htmlNodes,aa,ab="",ac="",Y="------ ",X=false,V="",Z,U=u;if(W>0){V=u+v.signatures[W].value+F}if(this.type===v.MSG_TYPE.HTML){aa=this.editor.getContent();if(aa==="<html/>"){aa+="<br/>"}U=k(U);if(W>0){V=k(V)}}else{aa=T.bodyTar.value}X=aa.indexOf(Y);if(X===-1){Y='Od: "';X=aa.indexOf(Y)}if(X===-1){ab=aa}else{ab=aa.substring(0,X);ac=aa.substring(X)}Z=ab.indexOf(U);if(Z>=0){ab=ab.substring(0,Z)}ab+=V;if(this.type===v.MSG_TYPE.HTML){this.editor.setContent(ab+ac);if(s.browser.ie){E.setSelectionRange(this.editor.getBody(),0,0)}}else{T.bodyTar.value=ab+ac}},createAttElement:function(T){var X=this,U=T.name,V=T.size,W=T.index;var Y=[C("span",{className:"attIcon"}),C("span",{className:"attName",childNodes:[C("a",{href:s.env.uploadUrl+"/html/getattach,mid,"+this.messageId+",mpid,"+W+",uid,"+m.getUid()+",/"+encodeURIComponent(U)+"?f="+encodeURIComponent(U),title:U,childNodes:[Q(m.truncateString(U,60,undefined,"m"))],onmouseover:this.getAttMouseOverHandler(),onmouseout:S,onclick:function(Z){if(X.isSending){return E.preventDefault(Z||event)}s.disableBeforeUnload=true;return true}})]}),C("span",{className:"attMeta",innerHTML:" ("+V+")"}),C("a",{className:"attDelLink",innerHTML:e("usuń")+" »",onclick:function(){X.deleteAttach(T.index,this,U);o=true}})];return C("div",{className:"attach",title:U,childNodes:Y})},createAddrButton:function(T){var U=this;return C("button",{className:"addCnt2Msg",title:e("Wybierz odbiorców z Kontaktów"),tabIndex:3,onclick:function(){U.chooseContacts();s.Tools.hitGemius(s.Tools.getGemiusByAlias("UNCATEGORISED","NEW_MESSAGE_TO"))},innerHTML:"<span></span> "+T+":"})},showAttachments:function(Y){var ab=document.createDocumentFragment(),W=Y.attach?Y.attach.list:null,V=this.attachments,T=this.htmlNodes.attBlock,aa=false,U=[],X=this;if(W&&W.forEach){W.forEach(function(ac){var ad=ac.name.split(".").pop();V.push(ac);if(I.indexOf(ad.toLowerCase())>-1){X.htmlNodes.attItemsImagesBlock.appendChild(this.createAttElement(ac));aa=true}else{U.push(ac)}},this);if(document.querySelector(".attPublicGalleryPanel")){var Z=document.querySelector(".attachListImages")}U.forEach(function(ac){this.htmlNodes.attItemsBlock.appendChild(this.createAttElement(ac))},this)}if(W&&W.length>1){s.DOM.removeClass(T,"hide-att-purge")}T.style.display="block";this.setTotalSize(Y.attach?Y.attach.totalSize:0);if(Y.gallery&&Y.gallery.state!=undefined){X.galleryState=Y.gallery.state}if(aa){this.galleryPannel(X.galleryState)}},getAttMouseOverHandler:function p(){var T=this;return function(){var U;if(!T.isSending&&this.href.match(J)){U=C("div",{className:"upload-preview",childNodes:C("img",{src:this.href.replace(",uid",",min,1,nc,1,uid"),alt:"Podgląd załącznika"})});w.RichTooltip.show(U)}}},createUploadProgress:function(W,V,ab){var Z=V.parentNode.parentNode.previousSibling,aa=Z.id+"@"+W.id,Y=this,X=C("span",{id:aa+"_fill",className:"upload-progress-fill"}),U=C("span",{className:"upload-progress-chart",childNodes:[X]}),T=C("div",{id:aa,className:"attach uploading",childNodes:[C("span",{title:W.name,childNodes:[Q(m.truncateString(W.name,60,null,"m")+" ")]}),C("span",{className:"attMeta",innerHTML:"("+m.bytesToHRSize(W.size)+") "}),U,C("a",{href:"#",innerHTML:e("anuluj »"),fileId:W.id,onclick:function(){ab.cancelUpload(this.fileId,false);ab.startUpload();this.parentNode.parentNode.removeChild(this.parentNode);Y.uploads.splice(Y.uploads.indexOf(ab.inplUploadId),1);this.onclick=null;ab=null;return false}})]});X.style.width="0px";return T},appendUploadFragment:function(U,T){U.parentNode.parentNode.previousSibling.appendChild(T)},updateUploadProgress:function(U,T,V){$(V.parentNode.parentNode.previousSibling.id+"@"+U.id+"_fill").style.width=T+"px"},beginUpload:function(af,aa,ag,ai,Z){var ab=this,V,Y,ac,T,X,ah,W=e("(przesyłanie<blink>…</blink>)"),ad=this.uploads,ae=this.attachments.totalSize;ab.tab.contentChanged=true;aa=aa.substr(aa.lastIndexOf("\\")+1);X=aa;V=ai&&ai.files&&Object.prototype.toString.call(ai.files)==="[object FileList]";if(ai&&ai.files&&Object.prototype.toString.call(ai.files)==="[object FileList]"){Y=ai.files.item?ai.files.item(0):ai.files[0];if(Y){if(Y.hasOwnProperty("fileName")&&!Y.fileName){return false}if(ai.files.length>K){w.showNotice(Gettext.strargs(f.ngettext("W jednej chwili można przesłać maksymalnie %1 załącznik. Wybierz mniejszą liczbę załączników","W jednej chwili można przesłać maksymalnie %1 załączników. Wybierz mniejszą liczbę załączników",K),K)+"\n","error");return false}if("size" in Y&&(ae+Y.size)>s.env.maxMessageSize){s.UI.showNotice("Nie można dodać kolejnych załączników. Maksymalny rozmiar wysyłanej wiadomości wynosi 100MB.","error");return false}if(ai.files.length>1){X=Gettext.strargs(f.ngettext("Przesyłanie nowego załącznika","Przesyłanie %1 nowych załączników",ai.files.length),ai.files.length)}if(Array.prototype.reduce&&Y.size){W="("+s.Tools.bytesToHRSize(Array.prototype.reduce.call(ai.files,function(aj,ak){return aj+ak.size},0))+")"}}else{return false}}if(Z){Z.parentNode.parentNode.style.display="none"}ad.push(ag);ac=this.htmlNodes.attItemsBlock;ah=C("span",{title:X,childNodes:Q(m.truncateString(X,60,null,"m"))});if(V&&window.FileReader&&ai.files.length===1){Y=ai.files.item?ai.files.item(0):ai.files[0];if(Y.type.indexOf("image/")===0&&Y.size<1048576){j(Y,ah)}}T=C("div",{id:"attach_"+ag,className:"attach uploading",childNodes:[ah,Q(" "),C("span",{className:"attMeta",innerHTML:W}),C("a",{href:"#",className:"attDelLink",innerHTML:e("usuń »"),onclick:function(){ab.cancelUpload(ag);T.parentNode.removeChild(T);Z.parentNode.removeChild(Z);ac=null;T=null;return false}})]});ac.appendChild(T);ab.appendUploadForm();try{af.forms[0].submit()}catch(U){w.showNotice(e("Błąd podczas dodawania załącznika"),"error")}return true},isAlreadySendGallery:false,galleryState:0,finishUpload:function(W,ae,af,ap){var ai,am,ah,Z,V,ak=W.data,aq=ak.attachments||ak.files,X=this.htmlNodes,ag=this.uploads,U=this.attachments,aj,ad,ac=aq[0].attId,ao=0;Z=ae.parentNode.parentNode;am=Z.previousSibling;if(!W.status){w.showNotice(e("Błąd podczas przesyłania załącznika:")+" "+W.msg,"error");am.innerHTML="";return}for(ai=0,aj=U.length;ai<aj;ai++){if(U[ai].deleted){ao+=m.HRSizeToBytes(U[ai].size)}}if(ak.allSize){this.setTotalSize(ak.allSize-ao)}if(af&&ag.indexOf(ac)>=0){ag.splice(ag.indexOf(ac),1)}var T=false;for(ai=0,aj=aq.length;ai<aj;ai++){var Y=this;ah=this.createAttElement(aq[ai]);var ab=aq[ai].name.split(".").pop();if(ap){V=document.getElementById(am.id+"@"+ap.id);if(V){V.parentNode.replaceChild(ah,V)}}else{if(af){var an=ab.toLowerCase();if(I.indexOf(an)>-1){Y.htmlNodes.attItemsImagesBlock.appendChild(ah);T=true;if(document.querySelector(".attPublicGalleryPanel")&&aa){var al=document.querySelector(".attachListImages");al.className=al.className+" isFiles"}}}}U.push(aq[ai])}if(T){Y.galleryPannel()}for(ai=0,aj=aq.length;ai<aj;ai++){ah=this.createAttElement(aq[ai]);var ab=aq[ai].name.split(".").pop();if(ap){V=document.getElementById(am.id+"@"+ap.id);if(V){V.parentNode.replaceChild(ah,V)}}else{if(af){var an=ab.toLowerCase();if(I.indexOf(ab.toLowerCase())==-1){var aa=true;if(document.querySelector(".attPublicGalleryPanel")){var al=document.querySelector(".attachListImages");if(al.className.indexOf("isFiles")==-1){al.className=al.className+" isFiles"}}this.htmlNodes.attItemsBlock.appendChild(ah)}}}U.push(aq[ai])}if(af){ad=$("iframe_"+ac);if(ad){ad.parentNode.removeChild(ad)}ad=$("attach_"+ac);if(ad){ad.parentNode.removeChild(ad);ad=null}}if(U.length>1){s.DOM.removeClass(X.attBlock,"hide-att-purge")}S()},galleryPannel:function(U){var T=this;if(U!==undefined){T.galleryState=U}else{T.galleryState=1}if(s.env.publicGalleryEnabled===1){if(!T.htmlNodes.attItemsImagesBlock.parentNode.parentNode.querySelector(".attPublicGalleryPanel")){var V=document.querySelector(".activeBodyTab .composition-attachments ");V.parentNode.insertBefore(C("span",{className:"attPublicGalleryPanel",id:"publicGalleryPanel"+T.messageId,childNodes:[C("div",{className:"galleryButton"+(T.galleryState==0?" btnGalleryOff":""),id:"galleryButton_"+T.messageId,childNodes:[C("p",{innerHTML:"Opcje"})],onclick:function(){T.showGalleryPopupMenu()}})]}),V);document.body.appendChild(C("div",{className:"popupMenu",id:"inpl_public_gallery_menu_567"}));T.changeGalleryVisibility()}}else{var V=document.querySelector(".activeBodyTab .composition-attachments ");V.className+=" composition-attachments--notGallery";T.galleryState=0}},calculateHeight:function(){var U=this.htmlNodes.promoBlock,T=w.Theme.currentTheme.id==="g"?80:100;return Math.max(150,document.documentElement.clientHeight-(E.findPos(this.htmlNodes.bodyBlock)[1]+(U?U.offsetHeight:0)+$("bottomContent").offsetHeight+$("footer").offsetHeight+T))},cancelUpload:function(T){this.uploads.splice(this.uploads.indexOf(T),1)},openStationeryChooser:function n(W){W=parseInt(W,10)||0;var T=this,X="#apply-stationery_";function V(Y){Y.apply(T)}function U(Z){Z=Z||event;var Y=Z.target||Z.srcElement,aa;if(Y.parentNode.href){Y=Y.parentNode}if(Y.href&&Y.href.indexOf(X)>=0){aa=Y.href.split(X)[1];s.Stationery.getStationery(aa,V)}E.preventDefault(Z)}if(this.stationeryBubble){this.stationeryBubble.close();this.stationeryBubble=null}Inpl.LoadableModules.require("Inpl.Mail.Stationery",function(){var ad=s.Stationery,Z=s.UI.Scrollable,ac=T.tab.id,ae=T.htmlNodes,aa=ae.stationeryChooser,ab=$("tarNewMail_"+ac+"_c").tBodies[0],Y=E.elmsByClass("mceBody",ab)[0];if(!aa){aa=ae.stationeryChooser=C("div",{className:"stationery-chooser",innerHTML:""});ab.insertBefore(C("tr",{className:"stationery-td",childNodes:C("td",{childNodes:aa})}),Y)}else{aa.innerHTML=""}aa.scrollLeft=0;E.addClass(aa.scrollLeftBtn,"scrollable-inactive");E.removeClass(aa.scrollRightBtn,"scrollable-inactive");ad.loadThumbnails(aa,W,U,function(){Z.apply(aa,true,"<a href='#' class='scLeft'><b></b></a>","<a href='#' class='scRight'><b></b></a>",Z.wrapModes.BEFORE)})})},closeStationeryChooser:function R(){var T=this.htmlNodes.stationeryChooser,U=T.parentNode;T.innerHTML="";[T.scrollLeftBtn,T.scrollRightBtn,T].forEach(function(V){if(V.parentNode){V.parentNode.removeChild(V)}});if(U.className=="scrollable-wrapper"){U.parentNode.removeChild(U)}delete this.htmlNodes.stationeryChooser},applyStationery:function(T){var U=this;s.Stationery.getStationery(T,function(V){V.apply(U)})},openEmoticons:function(){var U=this,T=U.tab.id;window.setTimeout(function(){s.DOM.dispatchClickEvent(window,document.getElementById("tarNewMail_"+T+"_interiaemoticons").firstChild)},500)},deleteAttach:function(U,T){var X=this,V,W=T.parentNode,aa=this.attachments,Y=aa.length;for(V=0;V<Y;V++){if(aa[V].index===U){aa[V].deleted=true;X.setTotalSize(aa.totalSize-m.HRSizeToBytes(aa[V].size));break}}s.DOM.addClass(W,"att-deleted");function Z(){X.undeleteAttach(U,this)}if(T){T.innerHTML=e("przywróć »");T.onclick=Z}},undeleteAttach:function(V,U){var X=this,W,Z=this.attachments,Y=Z.length;for(W=0;W<Y;W++){if(Z[W].index===V){Z[W].deleted=false;X.setTotalSize(Z.totalSize+m.HRSizeToBytes(Z[W].size));break}}s.DOM.removeClass(U.parentNode,"att-deleted");function T(){X.deleteAttach(V,this)}if(U){U.innerHTML=e("usuń »");U.onclick=T}},purgeAttachments:function(V){var U=this,X=this.attachments,W=this.htmlNodes;function T(){var Z,Y,ab=s.DOM.elmsByClass("attach",W.optBlock),aa=W.attItemsImagesBlock.parentNode.parentNode;X.splice(0,X.length);for(Z=ab.length-1;Z>=0;Z-=1){Y=ab[Z];if(Y.tagName.toLowerCase()==="div"){Y.parentNode.removeChild(Y)}}if(aa.querySelector(".attPublicGalleryPanel")){aa.removeChild(aa.querySelector(".attPublicGalleryPanel"))}s.DOM.addClass(W.attBlock,"hide-att-purge");U.setTotalSize(0);w.showNotice(e("Wszystkie załączniki zostały usunięte"),"info")}if(V){T()}else{if(X.length){w.ModalDialogs.confirm({title:e("Potwierdź usunięcie wszystkich załączników"),message:e("Czy na pewno usunąć wszystkie załączniki? Operacji tej nie będzie można cofnąć!"),acceptLabel:e("Usuń"),onAccept:T})}else{w.showNotice(e("Do tej wiadomości nie są dołączone żadne załączniki"),"info")}}},chooseContacts:function(){var V=this,U,W={To:this.htmlNodes.adrTo,CC:this.htmlNodes.adrCC,BCC:this.htmlNodes.adrBCC},T={};for(U in W){if(W.hasOwnProperty(U)){T[U]=l(W[U].value)}}if(T.To.length===0&&T.CC.length===0&&T.BCC.length===0){T=null}s.ContactList.choose(e("Wybierz odbiorców"),{To:e("Do: "),CC:e("Kopia: "),BCC:e("Kopia ukryta: ")},function(Y){var X,Z;for(X in W){if(W.hasOwnProperty(X)){V.tab.contentChanged=true;Z=W[X];Z.value=Y[X].length>0?Y[X].join(D+" ")+D+" ":"";if(Y[X].length>0&&X!=="To"){V.showAdditionalField(X)}Z.grow();E.setSelectionRange(Z,Z.value.length,Z.value.length)}}},T)},makeButtons:function(T){var V=this,U=[{ident:"sendT",label:e("Wyślij"),title:e("Wyślij wiadomość"),gemiusClickId:"B706EeNIbz2._lz22OETT5a2HbcpHMbxYd8.tDoj6zr.07",cmd:function(){V.sendIfValid(v.SEND_MODE.SEND);m.hitGFK()}},{ident:"saveT",label:e("Zapisz"),title:e("Zapisz wiadomość w Kopiach roboczych"),gemiusClickId:"nS2QbXu_oyTq.mwiZtviVpZW3y4pLK_JK2cHBj73aDP.g7",cmd:function(){V.sendIfValid(v.SEND_MODE.DRAFT);s.Folders.retrieve();m.hitGFK()}},"|",{ident:"cancelBtn",label:e("Anuluj"),title:e("Rezygnuj z pisania wiadomości"),gemiusClickId:"B72aceNIfz4pGkOFWCCfv5a2PzgpHG_6AXw3EOp6WEf.27",cmd:function(){V.tab.safeClose()}}];if(T){U.forEach(function(W){W.disabled=true})}w.injectButtons(U,"nav1");U.forEach(function(W){W.tabIndex=1});if(!T){U[0].gemiusClickId=".c0wDWrRkyS09Nx9hWAS.KSd35iGLa_VEGgnjxWtgF3.57";U[1].gemiusClickId="B72QbeNIoyTfoMyL6MWKTJZWHSEpLMb9YPWlerqsU9L.s7";U[3].gemiusClickId=".c2acWrRfz4aQkOFjiUX4KSdfSqGLYcuEL4vA5TGgwP.q7"}w.injectButtons(U,this.htmlNodes.bottomIconsSpan);w.injectButtons(null,"bottIco")},createFieldRevealingLink:function(T,U){var V=this;return C("span",{innerHTML:'<a tabindex="2" href="#" title="'+U+'">'+U+"</a>",onclick:function(){if(T==="BCC"){s.Tools.hitGemius("nS2Qa3u_o_5KPaYFrs6fzpZWfSopLIcuYd9PSznzQ47.U7")}else{if(T==="CC"){s.Tools.hitGemius(".W2ab2thfwdUSY2MPVpbIqQ9HSGGPcb9cAE.9Q0zk0f.37")}}return V.showAdditionalField(T)}})},createConfirmBlock:function(){var T=this;return C("label",{title:e("Ustaw potwierdzenie odczytu wiadomości"),childNodes:[Q(e("Potwierdzenie odczytu:")),C("select",{tabIndex:2,childNodes:[C("option",{value:1,innerHTML:e("tak"),selected:T.requireConfirm}),C("option",{value:0,innerHTML:e("nie"),selected:!T.requireConfirm})],onchange:function(){T.requireConfirm=!!parseInt(this.value,10);switch(parseInt(this.value)){case 1:_gaq.push(["b._trackEvent","NowaWiadomość","Potwierdzenie odczytu","Potwierdzenie odczytu- tak"]);break;case 0:_gaq.push(["b._trackEvent","NowaWiadomość","Potwierdzenie odczytu","Potwierdzenie odczytu - nie"]);break}}})]})},createPriorityBlock:function(){var V=this,U=v.MSG_PRIORITY,T=[[e("niski"),U.LOW,V.priority>U.NORMAL],[e("normalny"),U.NORMAL,V.priority==U.NORMAL],[e("wysoki"),U.HIGH,V.priority<U.NORMAL]];return C("label",{title:e("Ustaw priorytet wiadomości"),childNodes:[Q(e("Priorytet:")),C("select",{tabIndex:2,childNodes:T.map(function(W){return C("option",{innerHTML:W[0],value:W[1],selected:W[2]})}),onchange:function(){V.priority=parseInt(this.value,10);switch(parseInt(this.value)){case 5:_gaq.push(["b._trackEvent","NowaWiadomość","Priorytet","niski"]);break;case 3:_gaq.push(["b._trackEvent","NowaWiadomość","Priorytet","normalny"]);break;case 1:_gaq.push(["b._trackEvent","NowaWiadomość","Priorytet","wysoki"]);break}}})]})},open:function(aF){var ay=this,aB,at,T=[],ac="",aI=s.Tabs.nextId,V=this.htmlNodes,an=C("div",{className:"composition"}),X=C("div",{className:"composition-head"}),ad=C("ul",{className:"composition-fields"}),Z=[],ag,au,ak,af,U,aC,aq,Y,aJ,aL,aj,W,ar,aM,ap,aA,aH,aw,ab,al,aE,aK,aa,ae,av,aD,am;V.spanHideLiCC=this.createFieldRevealingLink("CC",e("Dodaj pole Kopia (DW)"));V.spanHideLiBCC=this.createFieldRevealingLink("BCC",e("Dodaj pole Kopia ukryta (UDW)"));V.spanHideSep=C("span",{className:"spanHideSep",innerHTML:"|"});ak=ad.appendChild(C("li",{id:"hideLi_"+aI,className:"hideLi",childNodes:[V.spanHideLiCC,V.spanHideSep,V.spanHideLiBCC]}));ar=C("label",{innerHTML:e("Od")+":",htmlFor:"emFrom_"+aI});V.adrFrom=aM=C("select",{id:"emFrom_"+aI,className:"addFrom2Msg",tabIndex:1});aJ=s.env.aliases;aq=s.Prefs.get("defaultAccount");aJ.forEach(function(aN){au=C("option",{value:aN.emailAddress,childNodes:[document.createTextNode((aN.displayName||aN.emailAddress.split("@")[0])+" <"+aN.emailAddress+">")],selected:(function(){if(aN.emailAddress===aq){Y=true;return true}return false})()});au.setAttribute("data-ext-acc-type","alias");au.setAttribute("data-ext-acc-id",aN.id);aM.appendChild(au)});U=s.env.vsmtp.accountList;aC=s.env.vsmtp.defaultAccount;U.forEach(function(aN){au=C("option",{value:aN.id,childNodes:[document.createTextNode(aN.displayName+" <"+aN.emailAddress+">")],selected:(function(){if(aN.id==aq){Y=true;return true}return false})()});au.setAttribute("data-ext-acc-type","account");au.setAttribute("data-ext-acc-id",aN.id);aM.appendChild(au)});if(!Y&&!isNaN(parseInt(aC,10))){E.nodeListToArray(aM).forEach(function(aN){if(aN.value==aC){aN.selected=true;Y=true}})}if(!Y&&isNaN(parseInt(aC,10))){E.nodeListToArray(aM).forEach(function(aN){if(aN.value==s.env.ownEmail){aN.selected=true;Y=true}})}if(!Y){E.nodeListToArray(aM).forEach(function(aN){if(aN.value==0){aN.selected=true}})}if(aJ.length+U.length===1){aw=s.env.vsmtp.accountList[0];aA=C("span",{className:"select-account-list select-account-list--single",innerHTML:(aw.displayName?aw.displayName+" ":"")+"&lt;<i class='single-account-address'>"+aw.emailAddress+"</i>&gt;"});E.addClass(ar,"select-account-single-label")}else{aA=C("span",{className:"select-account-list select-account-list--multiple",childNodes:[aM]})}if(aJ.length){aH=C("a",{className:"manage-aliases-link manage-aliases-link--manage",href:"https://ustawienia.interia.pl/poczta/konta-zewnetrzne",innerHTML:"Zarządzaj listą adresów »",onclick:function(){_gaq.push(["b._trackEvent","Aliasy","Nowa wiadomość - przy nadawcy","Zarządzaj listą adresów po dodaniu aliasu"])}})}else{if(s.Aliases.getAliasPromotionEnabled()){aH=C("span",{className:"manage-aliases-link manage-aliases-link--add",childNodes:[C("i",{className:"manage-aliases-link-caption",innerHTML:"Zmień adres na lepszy!"}),C("i",{className:"manage-aliases-link-link",innerHTML:"Sprawdź!"}),C("i",{className:"manage-aliases-link-arrow",innerHTML:"»"})],onclick:function(){s.Aliases.showNewAliasDialog();_gaq.push(["b._trackEvent","Aliasy","Nowa wiadomość - przy nadawcy","klik - sprawdź"])}})}else{aH=C("span")}}ap=C("li",{className:"select-account",childNodes:[ar,aA,aH]});ad.insertBefore(ap,ak);this.htmlNodes.fromSelect=aM;ab=this.createAddrButton(e("Do"));V.adrTo=al=O("emTo_"+aI,"D",1);if(this.adrTo){al.value=this.adrTo}aE=C("li",{childNodes:[ab,C("span",{childNodes:[al]})]});ad.insertBefore(aE,ak);aK=this.createAddrButton(e("DW"));V.adrCC=aa=O("emCC_"+aI,"C",1);V.CCSendLi=ae=C("li",{childNodes:[aK,C("span",{childNodes:[aa]})],style:{display:"none"}});ad.insertBefore(ae,ak);av=this.createAddrButton(e("UDW"));V.adrBCC=aD=O("emBCC_"+aI,"U",1);V.BCCSendLi=am=C("li",{childNodes:[av,C("span",{childNodes:[aD]})],style:{display:"none"}});ad.appendChild(am);V.subjectInput=aL=y("compose-subject_"+aI,null,1);aj=C("li",{className:"compose-field-li",childNodes:[C("label",{innerHTML:e("Temat:"),htmlFor:"compose-subject_"+aI}),C("span",{childNodes:[aL]})]});aL.value=this.subject||"";ad.appendChild(aj);X.appendChild(ad);al.onchange=aa.onchange=aD.onchange=aL.onchange=function(){ay.tab.contentChanged=true};function ah(){var aN=this.value.trim();if(aN!==""){ay.tab.setTitle(aN)}else{ay.tab.setTitle(x)}}E.addEvent(aL,"change",ah);an.appendChild(X);V.optBlock=X.appendChild(C("div",{className:"composition-options"}));V.optBlock.appendChild(C("div",{className:"linkOptMsg",childNodes:[ay.createConfirmBlock(),C("span",{className:"pipe",innerHTML:"|"}),ay.createPriorityBlock()]}));V.optBlock.lastChild.appendChild(C("span",{className:"pipe",innerHTML:"|"}));V.signatureSelector=V.optBlock.lastChild.appendChild(ay.createSignatureSelector()).lastChild;V.attBlock=V.optBlock.appendChild(C("div",{className:"composition-attachments hide-att-purge"}));V.attItemsImagesBlock=V.attBlock.appendChild(C("div",{className:"attachListImages",id:"atts_"+this.messageId}));V.attItemsBlock=V.attBlock.appendChild(C("div",{className:"attachList",id:"atts_"+this.messageId}));V.modeSwitcherA=V.optBlock.appendChild(C("div",{id:"mode-switcher-"+aI,className:"mode-switcher"}));z(V.modeSwitcherA,"html",ay);V.bodyBlock=an.appendChild(C("div",{className:"composition-body"}));af=document.createDocumentFragment();V.bodyTar=V.bodyBlock.appendChild(C("textarea",{className:"tarNewMail",rows:25,cols:68,name:"content",id:"tarNewMail_"+aI,tabIndex:1}));h(V.bodyTar,"change",function(){ay.tab.contentChanged=true});af.appendChild(an);V.bottomIconsSpan=C("span",{className:"compose-bottom-icons"});af.appendChild(C("div",{className:"bottomIcons toolbar",childNodes:[V.messageSizeDiv=C("div",{className:"message-size"}),V.bottomIconsSpan]}));this.setTotalSize(0);if(this.adrCC){aa.value=this.adrCC}if(this.adrBCC){aD.value=this.adrBCC}function ao(){ay.makeButtons();s.InfoBox.showById("composition",ay)}aB=this.tab=new s.Tabs.Tab(this.subject||x,af,ao,this.destroy.bind(this));aB.contentChanged=false;aB.safeClose=c;aB.show();this.appendUploadForm();if(this.adrCC){this.showAdditionalField("CC")}if(this.adrBCC){this.showAdditionalField("BCC")}function ax(aN){if(aN){s.DOM.setSelectionRange(V.bodyTar,0,0)}V.adrTo.focus()}function ai(aO){if(aO.setSelectionRange){aO.focus();aO.setSelectionRange(0,0)}else{if(aO.createTextRange){var aN=aO.createTextRange();aN.collapse(true);aN.moveEnd("character",0);aN.moveStart("character",0);aN.select()}}}if(this.type===v.MSG_TYPE.HTML){T=ay.content.match("inpl-mail-template_[1-9]([0-9])?");if(T&&T[0]){ac=T[0];at=parseInt(ac.replace(/inpl\-mail\-template_/g,""),10);s.Stationery.getStationery(at,function(aN){ay.stationery=aN})}if(ay.content.indexOf("inpl-mail-stationery-content")>0){var aG={b_25:29,b_25_extra:29,b_21:1,"04":2,"11a":3,"11b":3,"11c":3,b_20:4,b_8:5,b_12:6,b_5:7,"17":8,b_14:9,"14":10,b_13:11,"13":12,b_3:13,"15":14,"01a":15,"01b":15,"01c":15,"03":16,b_16a:17,b_16b:17,b_7:18,"12":19,b_17:20,"02":21,b_4:22,"16":23,b_6:24,b_23:25,"08":26,b_26:27,"09":28,"06":30,b_24:31,"07":32,b_27:33,b_1:34,b15:35,b_2:36,"10":37,b_10:38,b_9:39,b_11:40,b_19:41,b_18:42,b_22:43},az;Z=ay.content.match(/data-inpl-stationery=\"([0-9a-z_]*).png\"/gi);Z.forEach(function(aO,aN){Z[aN]=aO.replace(/data-inpl-stationery=\"/gi,"").replace(/.png\"/gi,"")});for(az=Z.length-1;az>=0;az--){if(aG[Z[az]]){at=aG[Z[az]];s.Stationery.getStationery(at,function(aN){ay.stationery=aN});break}}ag=ay.content.replace(/<body(.*)id=\"inpl-mail-stationery-content\"(>|( style=\"(.*);\")>)/gi,"");ag=ag.substring(0,ag.lastIndexOf("</div>"));ag="<body>"+ag+"</body>";ay.content=ag}ay.initEditor(ay.content,function(){var aO=ay.editor,aP=ay.calculateHeight(),aQ=aO.getIfr();aQ.height=aP;aQ.style.height=aP+"px";aQ.tabIndex=1;function aN(){if(at>0&&at<56){E.addClass(aO.getBody(),"stationery inpl-mail-template_"+at);E.addClass(aO.getDoc().documentElement,"inpl-mail-template_"+at);s.Stationery.setBodyHeight(ay.editor)}ay.setupBubble()}if(ay.initialSingatureId>=0){if(!punymce.isPre534WebKit){aN();ay.setSignature(ay.initialSingatureId)}else{aO.onInit.add(function(){aN();ay.setSignature(ay.initialSingatureId)})}}else{aN()}if(aF){aF(ay)}if(ay.opt&&ay.opt!=="f"){if(!punymce.isPre534WebKit){ay.setFocusToMailBody()}else{aO.onInit.add(function(){ay.setFocusToMailBody()})}}else{ax(1)}})}else{W=this.calculateHeight();this.htmlNodes.bodyTar.style.height=W+"px";V.bodyTar.value=this.content;if(ay.initialSingatureId>=0){ay.setSignature(ay.initialSingatureId)}if(this.opt&&this.opt!=="f"){ai(V.bodyTar)}else{ax(0)}if(aF){aF(ay)}ay.setupBubble()}},setupBubble:function(){},setFocusToMailBody:function(){var V=this,T=V.editor;function U(){E.setSelectionRange(T.getBody(),0,0);T.getWin().focus()}if(T&&V.type==v.MSG_TYPE.HTML){if(!s.browser.gecko||s.browser.gecko>=2){U()}else{setTimeout(U,1000)}}else{V.htmlNodes.bodyTar.focus()}},getInlineAttachmentIds:function(){var V,U="inpl-inline-attachment",Y=[],T=this.editor.getDoc(),Z=E.elmsByClass(U,T),X,W;for(V=Z.length;V--;){X=Z[V];imgElemId=X.id;if(imgElemId&&imgElemId.indexOf(U)===0){Y.push(imgElemId.replace(U+"_",""))}}return Y},sendIfValid:function(W){var U=this,V=U.htmlNodes,T={to:V.adrTo.value.trim()||"",cc:V.adrCC.value.trim()||"",bcc:V.adrBCC.value.trim()||"",subject:V.subjectInput.value.trim()||""},X=this.attachments;if(W==v.SEND_MODE.DRAFT_SILENT){U.send(W)}if((!T.to&&!T.cc&&!T.bcc)&&W!==v.SEND_MODE.DRAFT&&W!==v.SEND_MODE.DRAFT_SILENT){w.showNotice(e("Proszę podać odbiorcę wiadomości!"),"info");U.isSending=false;V.adrTo.focus();return}if((X.totalSize)>s.env.maxMessageSize){w.showNotice(e("Przekroczono maksymalny rozmiar wiadomości."),"error");U.isSending=false;return}if(!T.subject&&W!==v.SEND_MODE.DRAFT&&W!==v.SEND_MODE.DRAFT_SILENT){w.ModalDialogs.confirm({message:e("Czy chcesz wysłać wiadomość bez tematu?"),onAccept:U.send.bind(U,W),acceptLabel:"Wyślij"})}else{U.send(W)}},send:function(X){var Y=this,W,V,T,U=this.uploads,ab=X;if(X===4){X=2}if(!this.isSending){Y.isSending=true;function Z(ad,ae){ad=s.Network.parseResponse(ad);if(ad.status){if(Y.opt==="ra"||Y.opt==="r"){s.MessageList.getMessageFromAll(Y.repliedMsgId).forEach(function(aj){var af=s.DOM.elmsByClass("msg-status",aj.relatedNode)[0],ai=s.DOM.hasClass(af,"msg-status-re"),ah=s.DOM.hasClass(af,"msg-status-fwd-re"),ag=s.DOM.hasClass(af,"msg-status-fwd");if(!ai&&!ah&&!ag){s.DOM.addClass(af,"msg-status-re")}else{if(!ai&&!ah&&ag){s.DOM.removeClass(af,"msg-status-fwd");s.DOM.addClass(af,"msg-status-fwd-re")}}})}else{if(Y.opt==="f"){s.MessageList.getMessageFromAll(Y.repliedMsgId).forEach(function(aj){var af=s.DOM.elmsByClass("msg-status",aj.relatedNode)[0],ai=s.DOM.hasClass(af,"msg-status-re"),ah=s.DOM.hasClass(af,"msg-status-fwd-re"),ag=s.DOM.hasClass(af,"msg-status-fwd");if(!ai&&!ah&&!ag){s.DOM.addClass(af,"msg-status-fwd")}else{if(ai&&!ah&&!ag){s.DOM.removeClass(af,"msg-status-re");s.DOM.addClass(af,"msg-status-fwd-re")}}})}}V.forEach(function(ak){if(!ak){return}ak=ak.trim();if(!ak.length){return}try{var ah=ak.match(g)[0],ag="",aj=ak.indexOf(" <"+ah+">"),af=s.ContactList.getByField("email",ah,true,true),al=s.ContactList.getByField("email",ah,false,true)||af;if(aj>=0){ag=ak.substring(0,aj).replace(/"/g,"")}if(af&&ag){af.name=ag}if(!al){s.ContactList.autoInsertedList.push(new s.Contact({name:ag,email:ah,id:s.ContactList.autoInsertedId--}))}}catch(ai){console.log(ak.match(g));console.log(ai)}});switch(X){case v.SEND_MODE.SEND:T=e("Wiadomość została wysłana");break;case v.SEND_MODE.DRAFT:T=e('Wiadomość została zapisana w folderze "Kopie robocze"');break;case v.SEND_MODE.SEND_SAVE:T=e('Wiadomość została wysłana i zapisana w folderze "Wysłane"');break}w.showNotice(T,"success");Y.attachments.length=0;Y.uploads.length=0;Y.isSending=false;if(Y.relatedMsgList){Y.relatedMsgList.refresh()}s.MessageList.instances.forEach(function(af){if(af.folder===2){af.refresh()}});if(ab===v.SEND_MODE.DRAFT_SILENT){var ac={id:ad.data.messageId};Y.tab.close();v.editMessage(ac,"edit");setTimeout(function(){document.getElementById("attPublicGalleryBlockBackground").remove()},1000)}else{Y.tab.close()}}else{w.showNotice(ad.msg,"error");Y.isSending=false}}function aa(){var ag,af,ai=Y.htmlNodes,ah,ac=Y.attachments.filter(function(aj){return !aj.deleted}),ae;ah=ac.map(function(aj){return aj.index});if(Y.type===v.MSG_TYPE.HTML){ah=ah.concat(Y.getInlineAttachmentIds())}ag={from:ai.adrFrom.value||0,to:ai.adrTo.value||"",cc:ai.adrCC.value||"",bcc:ai.adrBCC.value||"",subject:ai.subjectInput.value||"",content:"",mid:Y.messageId,opt:Y.opt||"",optSend:X||"",prior:Y.priority||"",confirm:Y.requireConfirm?1:0,attachments:ah,extAccType:ai.adrFrom.options[ai.adrFrom.selectedIndex].getAttribute("data-ext-acc-type"),extAccId:ai.adrFrom.options[ai.adrFrom.selectedIndex].getAttribute("data-ext-acc-id"),isGallery:Y.galleryState};V=[ag.to,ag.cc,ag.bcc].join(D).split(D);af=Y.editor;function ad(ak){var aj;if(af&&Y.type===v.MSG_TYPE.HTML){aj=af.getDoc().body;if(af.inplOnBeforeSend){af.inplOnBeforeSend()}if(!ak){aj.contentEditable="inherit"}af.inpl_prepareContent(X);if(Y.stationery&&X!==v.SEND_MODE.DRAFT){ae=af.getDoc().getElementById("ieCheat");if(ae){ae.parentNode.removeChild(ae)}ag.content=s.Stationery.applyBeforeSend(Y.stationery,af.getDoc())}else{ag.content=ak||E.getOuterHTML(aj)}ag.cntType="html"}else{ag.content=ak||ai.bodyTar.value;ag.cntType="plain"}if(Y.galleryState==1&&Y.type===v.MSG_TYPE.HTML){if(ag.content.indexOf("--")!=-1){ag.content=ag.content.replace("--","<public_gallery_body> <br> --")}else{ag.content=ag.content.replace("</body>","<br><public_gallery_body></body>")}}s.Network.ajax({url:"/html/sendmail",timeout:65000,onSuccess:Z,post:ag})}ad()}X=X||v.SEND_MODE.SEND;if(X===v.SEND_MODE.DRAFT){s.Folders.getById(-1).needsRefresh=true}if(U.length>0){Y.makeButtons(true);Inpl.Network.onShowProgress();W=setInterval(function(){if(U.length===0){clearInterval(W);Inpl.Network.onHideProgress();aa()}},1000)}else{aa()}}},setTotalSize:function(T){this.attachments.totalSize=T;this.htmlNodes.messageSizeDiv.innerHTML=f.strargs(e("Całkowity rozmiar: %1 ze %2"),["<b class=totalSize>"+m.bytesToHRSize(T)+"</b>",s.Tools.bytesToHRSize(s.env.maxMessageSize)])},showAdditionalField:function(W){W=W.toUpperCase();var V=this.htmlNodes,T=V["spanHideLi"+W],U=V[W+"SendLi"];V.spanHideSep.style.display=T.style.display="none";U.style.display="block";U.getElementsByTagName("textarea")[0].focus();if((W==="CC"&&V.spanHideLiBCC.style.display==="none")||((W==="BCC"&&V.spanHideLiCC.style.display==="none"))){T.parentNode.style.display="none"}return false},setEditorMode:function(V){var X,W=this.htmlNodes.bodyTar,T=this.editor;if(V){try{W.style.visibility="hidden";W.value=k(W.value);T.show()}catch(U){console.log(U);w.showNotice(e("Zmiana formatu wiadomości mogła się nie powieść"),"error")}}else{X=i(T.getBody().innerHTML);T.hide();W.value=X;W.style.visibility="visible";s.DOM.setSelectionRange(W,0,0)}},switchMode:function(T){var aa=this.editor,ab=this,Y=this.htmlNodes.modeSwitcherA,ad,U=ab.htmlNodes.stationeryChooser,X,V=["class","style","vlink","link","alink","text"];T=T||"";function ac(){z(Y,"html",ab);X=aa.getBody();V.forEach(function(af,ae){X.setAttribute(af,"");X.removeAttribute(af)});if(ab.htmlNodes.stationeryChooser){ab.closeStationeryChooser()}ab.setEditorMode(false);ab.type=v.MSG_TYPE.PLAIN;s.Prefs.set("useRichEditor",false);ab.changeGalleryVisibility()}function W(ae){function af(){z(Y,"text",ab);ab.setEditorMode(true);ab.type=v.MSG_TYPE.HTML;s.Prefs.set("useRichEditor",true);if(ae){ae()}}if(!aa){ad=ab.htmlNodes.bodyTar;ad.style.visibility="hidden";ad.value=ad.value.replace(/</g,"&lt;");ab.initEditor(undefined,af)}else{af()}}function Z(){if(T=="stationery"&&(!U||U&&U.style.display=="none")){ab.openStationeryChooser()}else{if(T=="video"&&ab.editor){ab.editor.commands.inplRecordVideo()}}}if(T){if(this.type===v.MSG_TYPE.PLAIN){W(Z)}else{Z()}}else{if(this.type===v.MSG_TYPE.HTML){if(!this.opt&&!this.tab.contentChanged){ac()}else{w.ModalDialogs.confirm({message:e("Zmiana trybu pracy edytora spowoduje utratę formatowania. Kontynuować?"),onAccept:ac})}}else{W()}}ab.changeGalleryVisibility();return false},initEditor:function(U,W){var V=!window.punymce,T=this;if(s.browser.ie&&V){document.body.appendChild(C("i",{id:"__ie_onload"}))}t.require("punymce",function(){t.require("punymce.plugins.InteriaMail",function(){t.require("punymce.plugins.InteriaEmoticons",function(){if(V){punymce.Event._pageInit()}var X,Y=s.browser,aa=T.tab.id,Z,ab={id:"tarNewMail_"+aa,toolbar:"bold,italic,underline,strike,increasefontsize,decreasefontsize,ul,ol,indent,outdent,left,center,right,style,removeformat,textcolor,inpluploadimage,link,unlink,editsource,interiaemoticons,inplstationery",plugins:"Image,Link,TextColor,EditSource,Entities,InteriaMail,InteriaEmoticons,InteriaUrls",protect:{list:[/<(script|noscript|style)[\u0000-\uFFFF]*?<\/(script|noscript|style)>/g]},interiaemoticons:{auto_convert:false},spellcheck:true,content_css:s.env.staticUrl+"/css/"+s.env.msgCssFile};if(Y.webkit||Y.ie||Y.opera){ab.plugins+=",ForceBlocks"}if(Y.ie){ab.plugins+=",Paste"}else{ab.width="100%; -intpl-ignore:";ab.min_width="auto"}ab.max_width=5000;if(!U){U=k(T.htmlNodes.bodyTar.value)}X=new punymce.Editor(ab);X.relatedComposition=T;Z=$(ab.id+"_f");Array.forEach($(ab.id+"_tb").getElementsByTagName("a"),function(ac){ac.tabIndex=-1;E.addEvent(ac,"click",function(){_gaq.push(["b._trackEvent","Pisanie wiadomości","Edytor HTML","Klik w opcje"])})});if(punymce.isIE){Z.style.width="100%"}z(T.htmlNodes.modeSwitcherA,"text",T);if(!punymce.isPre534WebKit){X.setContent(U)}else{X.onInit.add(function(){X.setContent(U+"<br>")})}if(s.browser.ie&&s.browser.ie<8){X.resizeBy(0,1);setTimeout(function(){Z.contentWindow.scrollTo(0,0)},100)}T.editor=X;_gaq.push(["b._trackEvent","Pisanie wiadomości","Edytor HTML","Odsłona"]);if(W){W()}})})})},promoFrameDeleted:function(U){var W=0,X,V=this,T;if(U){V.htmlNodes.promoBox=null;W=this.calculateHeight();if(V.type===v.MSG_TYPE.HTML){T=V.editor;if(T){X=T.getIfr();X.height=W;X.style.height=W+"px";s.Stationery.setBodyHeight(T)}}else{V.htmlNodes.bodyTar.style.height=W+"px"}}m.hitGemius("bQCbGwulJFE.ob5nkZaeWsVHfe.BTocyzs5fjFnco53.M7")},showGalleryPopupMenu:function(){var Y=this,V=[e("Zobacz jak wygląda galeria"),e("Wyłącz galerię dostępną pod linkiem"),e("Dowiedz się więcej o galerii")],W=document.getElementById("inpl_public_gallery_menu_"+Y.messageId);if(o){var U=document.createElement("div");U.id="attPublicGalleryBlockBackground";document.getElementById("tabs").appendChild(U);Y.sendIfValid(v.SEND_MODE.DRAFT_SILENT);o=false}if(!Y.isAlreadySendGallery){var T=document.getElementById("inpl_public_gallery_menu_"+Y.messageId);if(!T&&Y.galleryState!=0){N.ajax(Y.messageId,1);Y.isAlreadySendGallery=true}}var aa=V.map(function(ad){return{label:ad}});aa[0].specialElement=C("a",{target:"_blank",onclick:function(){m.hitGemius("nS07Mnu_FJCJlomagY.cmJZWP4MpLG7MPqca_a7OxEv.s7")},href:"/next/gallery/preview?uid="+Inpl.Mail.env.uid+"&mId="+Y.messageId});aa[1].specialElement=C("a",{onclick:function(){var ad=document.getElementById("galleryButton_"+Y.messageId);if(Y.galleryState===1){N.ajax(Y.messageId,0);Y.galleryState=0;ad.className+="btnGalleryOff";m.hitGemius("ncebkHusJFq.4VN9qSvhfHZHfStZ4odE1CSYRFHIbx..47")}else{if(Y.galleryState===0){Y.galleryState=1;N.ajax(Y.messageId,1);ad.className=ad.className.replace("btnGalleryOff","")}}},href:"#"});aa[2].specialElement=C("a",{target:"_blank",onclick:function(){m.hitGemius(".c2bkmrRJJGvfLmuKTGcBKSdfQuGLYc0ueHy3aBULyv.L7")},href:"http://info.poczta.interia.pl/pomoc/artykuly,2209523"});if(!W){var ac=document.getElementById("galleryButton_"+this.messageId);new s.UI.PopupMenu(aa,"inpl_public_gallery_menu_"+this.messageId,false,ac.id).show(ac);var Z=document.querySelector("#inpl_public_gallery_menu_"+this.messageId+" ul .ctxMLiEnabled:nth-child(2) a"),X=document.querySelector("#inpl_public_gallery_menu_"+this.messageId+" ul .ctxMLiEnabled:nth-child(1)"),ab=document.getElementById("inpl_public_gallery_menu_"+this.messageId);ab.style.left=s.DOM.findPos(ac)[0]-142+"px";if(Y.galleryState===1){Z.innerHTML="Wyłącz galerię dostępną pod linkiem";document.querySelector("#inpl_public_gallery_menu_"+this.messageId+" ul .ctxMLiEnabled:nth-child(2)").className="ctxMLiEnabled";X.className="ctxMLiEnabled"}else{if(Y.galleryState===0){Z.innerHTML="Włącz galerię dostępną pod linkiem";X.className="ctxMLiEnabled galleryOff";document.querySelector("#inpl_public_gallery_menu_"+this.messageId+" ul .ctxMLiEnabled:nth-child(2)").className="ctxMLiEnabled turnGallery"}}}else{s.UI.PopupMenu.hideAll()}},changeGalleryVisibility:function(){var T=this;var U=document.getElementById("publicGalleryPanel"+T.messageId);if(U){if(T.type===v.MSG_TYPE.HTML){E.removeClass(U,"publicGalleryPanel--hidden")}else{U.className=U.className+" publicGalleryPanel--hidden"}}}};v.getById=function(T){return v.instances.filter(function(U){return U.messageId===T})[0]||null};v.composeNew=function(U){U=U||{};var T=U.mailto||null,V;if(U.forwardAttachments){V={};V.opt="att";V.attach=JSON.stringify(U.forwardAttachments.map(function(W){return{mid:W.mid,mpid:W.mpid}}))}else{if(U.forwardMessages||U.forwardThreads){V=V||{};V.opt="fmsg";if(U.forwardMessages){V.messages=U.forwardMessages.map(B).join("*")}if(U.forwardThreads){V.threads=U.forwardThreads.map(B).join("*")}}}s.Network.ajax({url:"/html/newmsg",post:V,onSuccess:function(W,Z){W=s.Network.parseResponse(W,true);if(!W){w.alert(e("Utworzenie nowej wiadomości nie powiodło się z powodu błędu po stronie serwera.")+"\n\n"+e("Prosimy spróbować ponownie później. Jeśli problem będzie się powtarzał, prosimy o kontakt z Biurem Obsługi Klienta."));return}if(!W.status){w.alert(W.msg,e("Przepraszamy. Operacja niedostępna."),false,false,"htmlText");return}var aa=W.data,af="",ab="",X="",ae="",ai=null,ah=U.src?m.decodeEntities(U.src.getSubject()):"",ag,Y,ac;if(T){T=m.parseMailtoURL(T);ab=T.to;ae=T.bcc;X=T.cc;if(T.subject){ah=T.subject}if(T.body){af=s.Prefs.get("useRichEditor")?k(T.body):T.body}}ag=new v(aa.messageId,af,ah,ab,X,ae,ai,(s.Prefs.get("useRichEditor")&&!s.browser.webkitMobile)?v.MSG_TYPE.HTML:v.MSG_TYPE.PLAIN);ag.open((U.callbackFn)?U.callbackFn:"");if(aa.attach&&aa.attach.list&&aa.attach.list.length>0){ag.showAttachments(aa)}if(U.openStationery){window.setTimeout(function(){ag.openStationeryChooser(0)},500)}else{if(U.forceVideoMode){window.setTimeout(function(){ag.switchMode("video")},500)}else{if(typeof U.setStationery==="number"){window.setTimeout(function(){s.Stationery.getStationery(U.setStationery,function(aj){aj.apply(ag)})},500)}else{if(U.openEmoticons){ag.openEmoticons()}}}}Y=s.Tabs.list;ac=0;for(var ad=0;ad<Y.length;ad++){if(Y[ad].title==="Nowa wiadomość"){ac++}}switch(ac){case 0:case 1:break;case 2:case 3:_gaq.push(["b._trackEvent","Zakładki","Nowa wiadomość","Otworzone "+ac+" zakładki jednocześnie"]);break;default:_gaq.push(["b._trackEvent","Zakładki","Nowa wiadomość","Otworzone 4 lub więcej zakładek jednocześnie"])}}})};v.editMessage=function(Z,X,W){var aa=Math.max(500,q),V,Y,T,U="";switch(X){case"res":V="r";break;case"resAll":V="ra";break;case"forw":V="f";break;case"edit":V="e";break}if(Z&&Z.id){Y=Z.id;T=Z.folderId;if(Z.mpid){U=",mpid,"+Z.mpid}}s.Network.ajax({url:(Z?"/html/optmail,ans,1":"/html/optmail")+",folder,"+T+",mesg,"+Y+",aj,1,opt,"+V+U+",height,"+aa+",imgProtectedStatus,"+(Z.allowExternalContent?0:2),timeout:60000,onSuccess:function(an,ar){var ab,al,ad,au,ai,aq={adrTo:"",adrCC:"",adrBCC:""},ac=null,aw,av,ap,am,ak,ag,aj=false,ay=[],ax,ao,az,ah,at,af=new Array("Niedziela","Poniedziałek","Wtorek","Środa","Czwartek","Piątek","Sobota");try{an=s.Network.parseResponse(an);if(!an){w.alert(e("Utworzenie nowej wiadomości nie powiodło się z powodu błędu po stronie serwera.")+"\n\n"+e("Prosimy spróbować ponownie później. Jeśli problem będzie się powtarzał, prosimy o kontakt z Biurem Obsługi Klienta."));return}if(!an.status){w.alert(an.msg,e("Przepraszamy. Operacja niedostępna.3 2",false,false,"htmlText","htmlText"));return}ad=an.data;if(V==="e"&&Z.id!=ad.mid){s.MessageList.getMessageFromAll(Z.id).forEach(function(aA){aA.id=ad.mid})}ao=s.Prefs.get("attachOnReply")||ad.opt==="f"||ad.opt==="e";if(ad.trf==="HARD"||ad.trf==="SOFT"){w.alert(e("Wysyłanie wiadomości zostało zablokowane z powodu przekroczenia limitu transferu."),e("Przekroczony limit transferu"));return false}ad.subject=m.decodeEntities(ad.subject);ad.org_fromRfcString=ad.org_fromRfcString||"";if(V==="ra"&&T==2){aq.adrTo=ad.cc;aq.adrCC="";aq.adrBCC=ad.bcc}else{aq.adrTo=ad.to;aq.adrCC=ad.cc;aq.adrBCC=ad.bcc}al=ad.isHtml?v.MSG_TYPE.HTML:v.MSG_TYPE.PLAIN;if(s.browser.ios){al=v.MSG_TYPE.PLAIN}if(ad.opt==="r"||ad.opt==="ra"){if(ao){az=ad.org_date.replace(/</g,"&lt;").replace(/>/g,"&gt;").split(" ");at=az[0].split("-");ah=new Date(at[0],at[1]-1,at[2]);if(al===v.MSG_TYPE.HTML){au="<br/><br/>"+Gettext.strargs(e("Od: %1"),ad.org_fromRfcString.replace(/</g,"&lt;").replace(/>/g,"&gt;"))+"<br/>"+Gettext.strargs(e("Do: %1"),ad.org_to.replace(/</g,"&lt;").replace(/>/g,"&gt;"))+"<br/>"+Gettext.strargs(e("Wysłane: %1 %2 %3"),[az[1],af[ah.getDay()],az[0]])+"<br/>"+Gettext.strargs(e("Temat: %1"),ad.org_subject.replace(/</g,"&lt;").replace(/>/g,"&gt;"))+ad.body}else{au="\n\n"+Gettext.strargs(e("Od: %1"),ad.org_fromRfcString)+"\n"+Gettext.strargs(e("Do: %1"),ad.org_to)+"\n"+Gettext.strargs(e("Wysłane: %1 %2 %3"),[az[1],af[ah.getDay()],az[0]])+"\n"+Gettext.strargs(e("Temat: %1"),ad.org_subject)+"\n\n"+i(ad.body)}}ad.body=au}else{if(ad.opt==="f"){ai=e("------ Wiadomość oryginalna ------")+"\n"+e("Temat: ")+ad.org_subject+"\n"+e("Data: ")+ad.org_date+"\n"+e("Nadawca: ")+(ad.isHtml?ad.org_fromRfcString.replace(/</g,"&lt;").replace(/>/g,"&gt;"):ad.org_fromRfcString)+"\n"+e("Adresat: ")+ad.org_to+"\n";if(ad.org_cc){ai+=e("DW: ")+ad.org_cc+"\n"}if(al===v.MSG_TYPE.HTML){au="<br/><br/>"+k(ai)+"<br/>"+ad.body}else{au="\n\n"+ai+"\n"+i(ad.body)}ad.body=au}else{ad.body=ad.isHtml?ad.body:i(ad.body)}}if(ao&&ad.isHtml&&al===v.MSG_TYPE.HTML){if(s.browser.ie){ad.body=ad.body.replace(/<(\w+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)</gi,function(aA){return aA.substring(0,aA.length-1)+"><"})}}ab=new v(ad.mid,ad.body,ad.subject,aq.adrTo,aq.adrCC,aq.adrBCC,ac,al,ad.priority,ad.confirm);ab.opt=ad.opt;ab.open();ab.showAttachments(ad);ab.repliedMsgId=Y;ab.relatedMsgList=W;ap=s.env.vsmtp.accountList;ax=s.env.aliases;if(ap&&ap.length){ay=ay.concat(ap)}if(ax&&ax.length){ay=ay.concat(ax)}ag=ad.org_popId;ak=ab.htmlNodes.fromSelect;for(av=0;av<ap.length;av++){if(ap[av].popId==ag&&ap[av].responseFrom=="this"){for(aw=0;aw<ak.length;aw++){if(ak[aw].value==ap[av].id){ak[aw].selected=true;aj=true;break}}break}}if(aj==false){am=[ad.org_fromRfcString,ad.org_to,ad.org_cc,ad.cc,ad.bcc].join(";").toLowerCase();for(av=0;av<ay.length;av++){if(am.match(new RegExp("\\b"+ay[av].emailAddress.toLowerCase()+"\\b","g"))&&ay[av].responseFrom=="this"){for(aw=0;aw<ak.length;aw++){if(ak[aw].innerHTML.match(g)[0]==ay[av].emailAddress){ak[aw].selected=true;break}}break}}}}catch(ae){if(console){console.log(ae)}}return true}})};s.Composition=v}());Inpl.Mail.ContactList=(function(){var j,c=Inpl.Mail,g=c.DOM,a=c.Tools,i=g.createElement,l=g.addEvent,n=g.removeEvent,k=new Gettext({domain:"inpl_mail_contactlist",locale_data:c.L10n}),p=function(t){return k.gettext(t)},e=10,f=5,h="contact-chooser-add",d="contact-chooser-add-all",m=null,o;function b(t){return document.createTextNode(t)}function r(t,v){v=v||{};if(t==="@restore"){t="main";v=m}var u={main:[{ident:"addContBtn",label:p("Dodaj kontakt"),title:p("Dodaj nowy kontakt"),cmd:function(){c.ContactList.showAddContactDialog();c.Tools.hitGemius(c.Tools.getGemiusByAlias("UNCATEGORISED","CONTACTS_ADD_CONTACT"))}},{ident:"editContBtn",label:p("Edytuj kontakt"),title:p("Edytuj wybrany kontakt"),cmd:function(){j.editMultiple(j.getChecked());c.Tools.hitGemius(c.Tools.getGemiusByAlias("UNCATEGORISED","CONTACTS_EDIT_CONTACT"))},disabled:!v.showCntOpts},{ident:"removeContT",label:p("Usuń kontakt"),title:p("Usuń zaznaczone kontakty"),cmd:function(){j.deleteMultiple(j.getChecked());c.Tools.hitGemius(c.Tools.getGemiusByAlias("UNCATEGORISED","CONTACTS_REMOVE_CONTACT"))},disabled:!v.showCntOpts},{ident:"removeContFromGroup",label:p("Usuń z grupy"),title:p("Usuń zaznaczone kontakty z grupy kontaktów"),cmd:function(){j.removeFromGroup(j.getChecked())},disabled:v.disableRemoveFromGroup||!v.showCntOpts},"|",{ident:"addGroupBtn",label:p("Dodaj grupę"),title:p("Dodaj nową grupę kontaktów"),cmd:function(){c.CntGroups.showAddGroupDialog();c.Tools.hitGemius(c.Tools.getGemiusByAlias("UNCATEGORISED","CONTACTS_ADD_GROUP"))}},{ident:"editGroupBtn",label:p("Edytuj grupę"),title:p("Edytuj grupę kontaktów"),cmd:function(){c.CntGroups.showEditGroupDialog();c.Tools.hitGemius(c.Tools.getGemiusByAlias("UNCATEGORISED","CONTACTS_EDIT_GROUP"))},disabled:!v.showGrpOpts},{ident:"removeGroupBtn",label:p("Usuń grupę"),title:p("Usuń grupę kontaktów"),cmd:function(){c.UI.ModalDialogs.confirm({message:p("Czy na pewno usunąć grupę?"),onAccept:c.CntGroups.delGroup.bind(c.CntGroups)});c.Tools.hitGemius(c.Tools.getGemiusByAlias("UNCATEGORISED","CONTACTS_REMOVE_GROUP"))},disabled:!v.showGrpOpts},"|",{ident:"impexT",label:p("Import/Eksport"),title:p("Zaimportuj/Wyeksportuj wszystkie kontakty"),menuitems:[{label:p("Importuj kontakty…"),cmd:function(){j.showImportWizard();c.Tools.hitGemius(c.Tools.getGemiusByAlias("UNCATEGORISED","CONTACTS_IMPORT_EXPORT"))}},{label:p("Eksportuj kontakty…"),cmd:j.showExportWizard}]}],importCnt:[{ident:"impContT",label:p("Importuj"),cmd:function(){if(!$("importContactsForm").file.value){$("contactsFile_error").innerHTML=p("Wybierz plik z książką adresową");c.UI.showNotice(p("Nie wskazano pliku z książką adresową!"),"error")}else{$("importContactsForm").submit()}}},{ident:"cancelBtn",label:p("Anuluj"),cmd:function(){c.Tabs.closeActiveTab()}}],exportCnt:[{ident:"expContT",label:p("Eksportuj"),cmd:function(){var w=$("exportContactsForm");w.action=w.action+",uid,"+c.Tools.getUid();w.submit()}},{ident:"cancelBtn",label:p("Anuluj"),cmd:function(){c.Tabs.closeActiveTab()}}],newContact:[{ident:"saveT",label:p("Zapisz"),title:p("Zapisz kontakt"),cmd:v.saveCmd||function(){$("submitAddContactForm").click()}},{ident:"cancelBtn",label:p("Anuluj"),title:p("Zrezygnuj z dodawania kontaktu"),cmd:function(){c.Tabs.closeActiveTab()}}]};u.editContact=[u.newContact[0],{ident:"removeContT",label:p("Usuń kontakt"),title:p("Usuń aktualny kontakt"),cmd:v.deleteCmd?function(){c.UI.ModalDialogs.confirm({message:p("Czy na pewno usunąć ten kontakt?"),onAccept:v.deleteCmd})}:null},u.newContact[1]];c.UI.injectButtons(u[t],"nav1");if(t==="main"){c.UI.injectButtons(null,"bottIco")}else{c.UI.injectButtons(u[t],"bottIco")}if(t==="main"){m=v}}function q(u){try{u=c.Network.parseResponse(u);if(!u.status){c.UI.showNotice(u.msg,"error");return false}c.ContactList.activeContact=null;c.ContactList.needsRefresh=true;if(j.managerTab&&c.Tabs.activeId===j.managerTab.id){r("main");c.CntGroups.showContacts(c.CntGroups.activeId,true);c.CntGroups.drawListTable()}}catch(t){console.log(t)}return true}function s(v){var x,w,y,u=[],t="aąäbcćdeęfghijklłmnńoóöpqrsśtuüvwxyzźż#";u=t.split("").map(function(z){return{chr:z,used:false}});for(x=0;x<v.length;x++){for(w=0;w<t.length;w++){y=(v[x].getDisplayName().charAt(0)||v[x].email.charAt(0)).toLowerCase();if(y===u[w].chr){u[w].used=true;v[x].sortedAs=y}else{if(t.indexOf(y)<0){u[u.length-1].used=true;v[x].sortedAs="#"}}}}return u}j={list:[],autoInsertedId:-1,lastRule:"",showGroupList:"block",useAlphabet:true,makeButtons:r,addEmailToBlackList:function(t){var y=g.elmsByClass("blockSender",""),x=c.UI,u,w,v;v={success:function(z){x.showNotice(Gettext.strargs(p("Dodano adres %1 do listy zablokowanych"),t));for(u=0;u<y.length;u++){w=y[u];if(g.hasClass(w,t)){w.innerHTML="<span></span>"+p("Odblokuj nadawcę");w.setAttribute("title",p("Usuń nadawcę z zablokowanych"))}}},fail:function(z){x.showNotice(z.msg,"error")}};c.ContactsWarnList.verify(t,function(z){if(z){c.Blacklist.addEmailWithCheck(t,v)}else{x.ModalDialogs.confirm({title:p("Zablokuj nadawcę"),message:p("Czy na pewno chcesz zablokować otrzymywanie wiadomości od tego nadawcy?"),acceptLabel:p("Tak"),cancelLabel:p("Nie"),onAccept:function(){c.Blacklist.addEmail(t,v)}})}})},addEmailToWhiteList:function(t){c.Network.ajax({url:"/html/addtowhite,email,"+t,onSuccess:function(u){u=c.Network.parseResponse(u);if(u.status){c.UI.showNotice(Gettext.strargs(p("Adres %1 został dodany do listy zaufanych"),t))}else{c.UI.showNotice(u.msg,"error")}}})},removeEmailFromBlackList:function(t){var w=g.elmsByClass("blockSender",""),u,v;c.Network.ajax({url:"/html/removefromblack,email,"+t+",uid,"+c.Tools.getUid()+"?inpl_network_request=true",onSuccess:function(x){x=c.Network.parseResponse(x);if(x.status){c.Blacklist.removeEmail(t);c.UI.showNotice(Gettext.strargs(p("Usunięto adres %1 z listy zablokowanych"),t));for(u=0;u<w.length;u++){v=w[u];if(g.hasClass(v,t)){v.innerHTML="<span></span>"+p("Zablokuj nadawcę");v.setAttribute("title",p("Dodaj do zablokowanych"))}}}else{c.UI.showNotice(x.msg,"error")}}})},getByField:function(y,w,t,u){var v=t?j.autoInsertedList:j.list,x;if(u){w=w.toLowerCase();x=function(z){return z[y].toLowerCase()===w}}else{x=function(z){return z[y]===w}}return v.filter(x)[0]||null},getById:function(t){return this.getByField("id",t)},handleEditResponse:function(x,z){var v,u,w,y,t;x=c.Network.parseResponse(x);if(x===null||x===undefined){c.UI.showNotice(p("Podczas wysyłania formularza wystąpił błąd. Prosimy spróbować ponownie później."),"error");return false}Array.forEach(g.elmsByClass("showErrorCom"),function(A){A.className="errorCom"});if(x.status===true){j.needsRefresh=true;t=j.autoInsertedList;if(z){z="_"+z}else{z=""}u=new c.Contact({email:$("email"+z).value,firstName:$("firstName"+z).value,lastName:$("lastName"+z).value,name:Inpl.Mail.Tools.htmlEntities($("name"+z).value),phone:$("phone"+z).value,messenger:$("messenger"+z).value,note:$("note"+z).value,id:$("contId"+z).value,score:0,group:undefined});if(!u.name){u.name=Inpl.Mail.Tools.htmlEntities([u.firstName,u.lastName].join(" ").trim())}if(!u.id){u.id=x.data.cntId;j.list.push(u)}else{for(w=0;w<j.list.length;w++){if(String(j.list[w].id)===String(u.id)){j.list[w]=u;break}}}for(w=t.length;w--;){if(t[w].email===u.email){delete t[w]}}y=$("emailAdr");if(y){y.value=""}if(x.data.newGroups){for(w=x.data.newGroups.length-1;w>=0;w--){c.CntGroups.list.push(new c.CntGroups.Group({id:x.data.newGroups[w].id,name:x.data.newGroups[w].name}))}}j._sidebar.updateView();c.UI.showNotice(p("Kontakt został zapisany."),"success");c.Tabs.closeActiveTab();if(j.managerTab){j.managerTab.show()}return true}else{switch(x.code){case 1902:case 1407:v=$("email_error_"+z);v.innerHTML=x.msg;v.className="showErrorCom";c.UI.showNotice(p("Niepoprawne dane w formularzu!"),"error");break;default:c.UI.showNotice(x.msg,"error")}}return false},checkOption:function(v,t){v=v||window.event;var u=v.target||v.srcElement;if(u.tagName==="LI"){if(!c.DOM.hasClass(u,"checked")){c.DOM.addClass(u,"checked")}else{c.DOM.removeClass(u,"checked")}}if(t){t(u.parentNode)}},choose:function(W,K,A,T){K=K||{To:p("Odbiorca: ")};W=W||p("Wybierz kontakty");var N=0,u=c.CntGroups.list,P,M,R,Q,S,D,C,z,G,I,H,F={},t={},J={},U,x,y,L;for(R in K){if(K.hasOwnProperty(R)){N++}}function v(X){var Y=X.getUnquotedRfcString("##"),Z=i("span",{innerHTML:"&nbsp;&nbsp;&nbsp;"});Y=Y.split("##");return i("li",{title:X.getRfcString(),id:X.id,childNodes:[b(Y[0]),Z,b(Y[1])]})}function B(X){if(X.tagName==="UL"){if(g.elmsByClass("checked",X).length){if(X.id==="selContactList"){Array.forEach(g.elmsByClass(h),function(Y){Y.disabled=false})}else{$(X.id+"del").disabled=false;$(X.id+"delAll").disabled=false}}else{if(X.childNodes.length){if(X.id==="selContactList"){Array.forEach(g.elmsByClass(h),function(Y){if(g.hasClass(Y,d)){Y.disabled=false}else{Y.disabled=true}})}else{$(X.id+"delAll").disabled=false;$(X.id+"del").disabled=true}}else{if(X.id==="selContactList"){Array.forEach(g.elmsByClass(h),function(Y){Y.disabled=true})}else{$(X.id+"delAll").disabled=true;$(X.id+"del").disabled=true}}}}}function O(Z,X){var Y=i("label");Y.appendChild(b(X));Y.setAttribute("for",Z);return Y}function E(Y){if(M.childNodes.length){c.DOM.removeChildren(M)}Y.map(v).forEach(function(Z){M.appendChild(Z);c.DOM.addEvent(Z,"click",function(aa){j.checkOption(aa,B)})});var X=!Y.length;Array.forEach(g.elmsByClass(h),function(Z){Z.disabled=X})}function V(X){var Y=X.options;if(g.elmsByClass("checked",M)){if(parseInt(X.options[Y.length-1].value,10)!==-2){X.appendChild(i("option",{value:-2,innerHTML:p("(lista zmodyfikowana)")}))}X.selectedIndex=Y.length-1;Y[Y.length-1].disabled=true}}S=i("div",{className:"overlay",id:"contactChooser"});D=i("h2",{innerHTML:"<span></span>"+W});S.appendChild(D);P=j.list.slice();z=i("table");G=i("tbody");I={};for(R in K){if(K.hasOwnProperty(R)){I[R]=i("tr")}}H=i("td",{rowSpan:3});M=i("ul",{id:"selContactList"});C=i("select",{id:"contact-chooser-filter",childNodes:[i("option",{value:-1,innerHTML:p("Wszystkie kontakty")})].concat(u.map(function(X){return i("option",{value:X.id,childNodes:[b(X.name)]})}))});C.onchange=function(){var X,Y=parseInt(this.options[this.selectedIndex].value,10);if(Y>=0){X=c.CntGroups.getById(Y);if(X){X.getMembers_async(E)}}else{if(Y===-1){E(j.list)}}if(parseInt(C.options[C.options.length-1].value,10)===-2){C.removeChild(C.lastChild)}};function w(X){var Y=F[X],Z=[i("button",{id:"sel"+X+"del",onclick:function(){c.UI.moveOptions(F[X],M,false,B);V(C);return false},innerHTML:p("« Usuń")}),i("button",{id:"sel"+X+"delAll",onclick:function(){c.UI.moveOptions(F[X],M,true,B);V(C);return false},innerHTML:p("« Usuń wszystkie")})];return i("td",{childNodes:[i("button",{id:"sel"+X+"add",className:h,onclick:function(){c.UI.moveOptions(M,F[X],false,B);return false},innerHTML:p("Dodaj »")}),i("br"),i("button",{id:"sel"+X+"addAll",className:h+" contact-chooser-add-all",onclick:function(){c.UI.moveOptions(M,F[X],true,B);return false},innerHTML:p("Dodaj wszystkie »")}),i("br"),Z[0],i("br"),Z[1]]})}x=function(X){if(X.id==="selBCCdel"||X.id==="selCCdel"||X.id==="selTodel"){X.disabled=true}};y=function(X){if(!g.hasClass(X,h)){X.disabled=true}};L=function(Z,Y){var X=(Z.getDisplayName()||Z.email).toLowerCase(),aa=(Y.getDisplayName()||Y.email).toLowerCase();return((X<aa)?-1:((X>aa)?1:0))};for(R in K){if(K.hasOwnProperty(R)){F[R]=i("ul",{className:"selRecList",id:"sel"+R});t[R]=i("td");J[R]=w(R);if(T&&T[R]&&T[R].length){for(Q=0;Q<T[R].length;Q++){U=v(T[R][Q]);F[R].appendChild(U);g.addEvent(U,"click",function(X){j.checkOption(X,B)});Array.forEach(J[R].getElementsByTagName("button"),x)}}else{Array.forEach(J[R].getElementsByTagName("button"),y)}}}P.sort(L);E(P);H.appendChild(O("contact-chooser-filter",p("Wyświetl: ")));H.appendChild(C);H.appendChild(O("selContactList",p("Lista kontaktów:")));H.appendChild(M);I.To.appendChild(H);for(R in K){if(K.hasOwnProperty(R)){t[R].appendChild(O(F[R].id,K[R]));t[R].appendChild(F[R]);I[R].appendChild(J[R]);I[R].appendChild(t[R]);G.appendChild(I[R])}}z.appendChild(G);S.appendChild(z);S.appendChild(i("div",{className:"overlayButtons",childNodes:[i("button",{className:"okBtn",onclick:function(){c.UI.hideOverlay();var Y={},X,Z;for(X in F){if(F.hasOwnProperty(X)){Y[X]=[];for(Z=0;Z<F[X].childNodes.length;Z++){Y[X].push(F[X].childNodes[Z].title)}}}if(A){A(Y)}return false},innerHTML:p("Zatwierdź")}),i("button",{className:"cancelBtn",onclick:function(){c.UI.hideOverlay();return false},innerHTML:p("Anuluj")})]}));c.UI.showOverlay(S,null,true)},createCtxMenu:function(){j.contextMenu=new c.UI.AttachableCtxMenu([{label:p("Edytuj"),cmd:function(){j.editMultiple(j.contextMenu.getActiveItems())}},{label:p("Usuń"),cmd:function(){j.deleteMultiple(j.contextMenu.getActiveItems())}},{label:p("Wyślij wiadomość"),cmd:function(){c.Composition.composeNew({mailto:j.contextMenu.getActiveItems().reduce(function(u,t){return u+t.getRfcString()+"; "},"mailto:")})}},"-",{label:p("Historia korespondencji"),cmd:function(){j.contextMenu.getActiveItems().forEach(function(t){t.openHistoryTab()})}}]);j.contextMenu.getActiveItems=function(){var u=j.getChecked(),t,v;if(!u||!u.length){v=this.contextNode.firstChild.cid||this.contextNode.firstChild.firstChild.cid;t=j.getById(v);return[t]}else{return u}}},drawListTable:function(y,v,t,M,K){var J,B,H,N,F,E="";if(!M){M=j.list;j.useAlphabet=true;j.groupTmpList=null}else{j.groupTmpList=M}try{B=$("cnt-list");if(y!=="init"&&B){B.innerHTML=""}if(K){E=K.toLowerCase()}function G(){if(g.hasClass(this,"act")){j.drawListTable()}else{j.filterByInitial(this.innerHTML,100)}return false}if(j.useAlphabet&&j.list.length){H=i("div",{id:"cnt-initials",title:p("Wyświetl kontakty na wybraną literę"),childNodes:[i("input",{type:"checkbox",id:"cnt-check-all",onclick:(function(){return function(){var P,O=c.UI.keepCheckedState(this,$("contact-items")),Q=O.length;j.markCnt=Q;O.forEach(function(R){g.addClass(R,"active")});if(this.checked){j.makeButtons("main",{showCntOpts:true});for(P=0;P<Q;P++){c.DOM.addClass(O[P].parentNode.parentNode,"active")}}else{j.makeButtons("main");for(P=0;P<Q;P++){c.DOM.removeClass(O[P].parentNode.parentNode,"active")}}}}())})]});N=s(j.list,"name");F=i("div");for(J=0;J<N.length;J++){if(N[J].used){F.appendChild(i("a",{href:"#cnt_"+N[J].chr,className:N[J].chr===E?"act":"",onclick:G,innerHTML:N[J].chr}));F.appendChild(i("wbr"))}}H.appendChild(F)}function x(){this.relatedContact.edit()}if(M.length>0){if(!v&&v!==0){v=1}if(!t||t>M.length){t=M.length}o=i("ul",{className:"cnt-items",id:"contact-items"});if(j.contextMenu){j.contextMenu.attachTo(o,"li","a0")}for(J=v-1;J<t;J++){if(M[J]&&M[J]!==null){var D=i("li",{id:"contact-li_"+M[J].id,cid:M[J].id}),w=i("div",{cid:D.cid,className:"cntData",innerHTML:'<div class=hCheck><input type=checkbox id="contact-cbox_'+M[J].id+'" value=1 onclick="Inpl.Mail.ContactList.mark(this.parentNode.parentNode.relatedContact, true)"></div>',ondblclick:x,relatedContact:M[J]}),A=M[J].getDisplayName(),C=i("div",{className:"cntTData",innerHTML:'<div title="'+A+'">'+c.Tools.truncateString(A,20)+'</div><span title="'+M[J].email+'">&lt;'+c.Tools.truncateString(M[J].email,25)+"&gt;</span>"});l(C,"click",function(O){return function(P){P=P||window.event;if(P&&P.ctrlKey){j.mark(O)}else{j.markAsSelected(O)}(new c.ContactView(O)).showInfo()}}(M[J]));w.appendChild(C);D.appendChild(w);o.appendChild(D)}}if(H){B.appendChild(H)}B.appendChild(o)}else{B.innerHTML="<ul class='cnt-items noContacts'><li>"+p("Brak kontaktów")+"</li></ul>"}var z=i("div",{id:"contactFullInfo",innerHTML:M.length?'<div class="noContactSelected">'+p("Wybierz kontakt aby zobaczyć szczegóły")+"</div>":'<div class="noContactSelected">'+p("Aby dodać nowy kontakt, wybierz przycisk „Dodaj kontakt”")+"</div>"});var L=$("cnt-details");if(L){L.parentNode.removeChild(L)}L=i("td",{id:"cnt-details",childNodes:[z]});B.parentNode.appendChild(L);var u=Math.max($("sidebar").offsetHeight-$("outerTabHeaderCont").offsetHeight-$("cnt-header").offsetHeight,document.documentElement.clientHeight-g.findPos(L)[1]-$("footer").offsetHeight-$("bottomContent").offsetHeight-5);L.style.height=u+"px";if(o){o.style.height=(u-20)+"px"}}catch(I){console.log(I);return false}return true},updateSizing:function(){var t=$("contact-items");if(t){t.style.height=Math.max(430,$("cnt-list").offsetHeight-(2+t.offsetTop))+"px"}},manage:function(){c.CntGroups.activeId=-1;function u(){if(c.ContactList.needsRefresh){c.ContactList.needsRefresh=false;c.ContactList.manage();return}if(m){r("@restore")}else{r("main")}}function t(){c.CntGroups.activeId=-1;delete j.managerTab}j.retrieve("/html/getcontacts,all,1",function(){var w,v=i("td",{id:"groups"});m=null;j.activeContact=null;w=document.createDocumentFragment();w.appendChild(i("div",{id:"cnt-header",childNodes:[i("span",{id:"contacts-grp-head",childNodes:[i("a",{href:"#",className:"asc",innerHTML:p("Grupy")+"<i></i>",onclick:function(){c.CntGroups.doSortGroups("name",this)}})]}),i("span",{id:"contacts-items-head",childNodes:[i("a",{href:"#",className:"asc",innerHTML:p("Kontakty")+"<i></i>",title:p("Posortuj kontakty alfabetycznie"),onclick:function(){j.doSortContacts("name",this)}})]}),i("span",{id:"contacts-details-head",innerHTML:p("Szczegóły")})]}));w.appendChild(i("table",{id:"cnt-table",cellSpacing:0,childNodes:[i("tbody",{childNodes:[i("tr",{childNodes:[v,i("td",{id:"cnt-list",childNodes:[i("table",{id:"contactList"})]})]})]})]}));if(!j.managerTab){j.managerTab=new c.Tabs.Tab(p("Kontakty"),w,u,t,{isBorderless:true})}else{c.CntGroups.showContacts(c.CntGroups.activeId,true,function(){c.CntGroups.drawListTable()})}j.managerTab.show()});return false},counter:function(u,t){if(t||!j.markCnt){j.markCnt=u}else{j.markCnt=j.markCnt+u}},resetCounter:function(){j.counter(0,true)},mark:function(t,v){var w="contact-cbox_"+t.id,u=$(w);if((!v&&!u.checked)||(v&&u.checked)){if(!c.DOM.hasClass(u,"active")){c.DOM.addClass(u.parentNode.parentNode,"active")}u.checked="checked";c.ContactList.counter(1)}else{c.ContactList.unMark(w)}if(c.ContactList.markCnt&&c.ContactList.markCnt>0){if(c.ContactList.activeContact&&!$("contact-cbox_"+c.ContactList.activeContact.id)){c.ContactList.activeContact=null}c.ContactList.activeContact=t;r("main",{showCntOpts:true,disableRemoveFromGroup:c.CntGroups.activeId<0})}else{r("main")}},markAsSelected:function(t){j.deactivate();j.activeContact=t;j.mark(t);j.clearCheckAll()},unMark:function(t){if(typeof t==="string"){t=$(t)}if(t){c.DOM.removeClass(t.parentNode.parentNode,"active");t.checked=""}j.counter(-1)},drawLiListContacts:function(v,t){var x=j.list.slice(),u=[],w;x.sort(function(B,A){var z=B.name.toLowerCase(),C=A.name.toLowerCase();return((z<C)?-1:((z>C)?1:0))});if(v&&v instanceof Array){x=x.filter(function(z){for(var y=0;y<v.length;y++){if(v[y].id===z.id){return false}}return true})}x.map(function(y){w=i("li",{id:y.id,title:y.email,innerHTML:(y.name||y.email)});u.push(w);g.addEvent(w,"click",function(z){j.checkOption(z,t)})});return u},clearCheckAll:function(){var t=$("cnt-check-all");if(t){t.checked=false}},deactivate:function(){if(j.markCnt>0){j.list.forEach(function(t){try{j.unMark("contact-cbox_"+t.id)}catch(u){}})}j.resetCounter()},sortContacts:function(v,w,t){var u=(w?1:-1),x;if(!j.groupTmpList){x=j.list}else{x=j.groupTmpList}x.sort(function(z,y){var A=z[v].toLowerCase(),B=y[v].toLowerCase();return u*A.localeCompare(B)});if(t){t.className=w?"asc":"desc"}j.sortContacts.currentSort=[v,w];if(j.managerTab){j.drawListTable(null,null,null,x)}},doSortContacts:function(u,t){if(j.sortContacts.currentSort&&j.sortContacts.currentSort[0]===u){j.sortContacts(u,!j.sortContacts.currentSort[1],t)}else{j.sortContacts(u,true,t)}},deleteMultiple:function(t){var u;if(t.length>1){u=p("Czy usunąć nieodwracalnie zaznaczone kontakty?")}else{u=k.strargs(p('Czy usunąć nieodwracalnie kontakt "%1?"'),[t[0].getDisplayName()||t[0].email])}c.UI.ModalDialogs.confirm({message:u,onAccept:function(){j.deleteContact(t.map(function(v){return v.id}).join("*"))}})},editMultiple:function(u){var t=u.length;function v(){u.forEach(function(w){w.edit()})}if(t<10){v()}else{c.UI.ModalDialogs.confirm({message:k.strargs(p("Na pewno edytować %1 kontaktów?"),[t]),onAccept:v})}},removeFromGroup:function(u,t){var v;t=t||c.CntGroups.activeId;if(u.length>1){v=p("Czy na pewno usunąć zaznaczone kontakty z grupy?")}else{v=k.strargs(p('Czy na pewno usunąć kontakt "%1" z grupy?'),u[0].getDisplayName()||u[0].email)}u.forEach(function(w){w.group=w.group.filter(function(x){return x!=t})});c.UI.ModalDialogs.confirm({message:v,onAccept:function(){c.Network.ajax({url:"delcontact",post:{conid:u.map(function(x){return x.id}).join("*"),gid:t},onSuccess:q});j.useAlphabet=false;try{j._sidebar.updateView();c.CntGroups.showContacts(c.CntGroups.activeId,true,function(){c.CntGroups.drawListTable()})}catch(w){}}})},deleteContact:function(z){if(!z&&z!==0){z=j.getCheckedIds().join("*")}if(!z){return}var w,u,y=(""+z).split("*"),t=y.length,v=j.list,x=j.list.length;c.Network.ajax({url:"delcontact",post:{conid:z},onSuccess:q});for(u=0;u<t;u++){for(w=0;w<x;w++){if(v[w]&&v[w].id===parseInt(y[u],10)){v.splice(w,1)}}}j._sidebar.updateView();if(j.managerTab&&(c.Tabs.activeId===j.managerTab.id)){c.CntGroups.showContacts(c.CntGroups.activeId,true,function(){c.CntGroups.drawListTable()})}},getChecked:function(){var t=[];if(j.markCnt&&j.markCnt>0){t=j.list.filter(function(u){var v=$("contact-cbox_"+u.id);return v&&v.checked})}return t},getCheckedIds:function(){return j.getChecked().map(function(t){return t.id})},filterByInitial:function(v){var u,t=v.toLowerCase();if(t!=="#"){u=j.list.filter(function(w){return(w.getDisplayName().charAt(0).toLowerCase()===t||w.email.charAt(0).toLowerCase()===t)})}else{u=j.list.filter(function(w){return w.sortedAs===t})}u.sort(function(x,w){var z=x.getDisplayName().toLowerCase(),y=w.getDisplayName().toLowerCase();if(z<y){return -1}else{if(z>y){return 1}else{return 0}}});j.useAlphabet=true;j.drawListTable(null,null,null,u,v)},search:function(t){t=t.toLowerCase();return j.list.filter(function(u){return u.email.toLowerCase().indexOf(t)>=0||u.name.toLowerCase().indexOf(t)>=0})},suggestContacts:function(w,E,O){var C=w.value,F,J=false,v=[],x=-1,t=[],u=[],B=0,G,N,L;if(!w||!E){throw new Error("suggestContacts arguments missing")}if(!w.suggestDiv){w.suggestDiv=document.body.appendChild(i("div",{className:"contact-suggestions popupMenu"}))}F=w.suggestDiv;function A(){F.parentNode.removeChild(F);F=w.suggestDiv=w.onkeydown=null;return false}function M(S){var R,P,U,T=S.length,Q;for(R=0;R<T;R++){Q=S[R];P=Q.email.toLowerCase().indexOf(C);U=Q.name.toLowerCase().indexOf(C);if(P>=0||U>=0){J=true;if(P===0||U===0){t.push(Q)}else{u.push(Q)}}}}if(j.lastRule===C){return null}j.lastRule=C;j.sortList=[];N=C.lastIndexOf(";");L=C.lastIndexOf(",");if(N!==-1||L!==-1){C=(N>L)?C.substr(N+1):C.substr(L+1)}C=C.trim();if(C){C=C.toLowerCase();F.innerHTML="";var H=document.createElement("ul");H.innerHTML='<li class="ctxmenu-section-header">'+p("––––––––––––––––– Kontakty –––––––––––––––––")+"</li>";M(j.list);M(j.autoInsertedList);j.sortList=t.concat(u);u=t=null;j.sortList.sort(function(Q,P){return P.score-Q.score});if(j.sortList.length>e){B=j.sortList.length-e;j.sortList.length=e}if(!j.sortList.length){H.removeChild(H.firstChild)}else{j.sortList.forEach(function(P){var Q=i("a",{href:"#",childNodes:[document.createTextNode(P.getUnquotedRfcString())]});Q.clickHandler=function(){if(E){E(P)}A();return false};l(Q,"click",Q.clickHandler);v.push(Q);H.appendChild(i("li",{childNodes:[Q]}))})}if(B){H.appendChild(i("li",{innerHTML:p("…i inne (wpisz kolejny znak).")}))}if(!O){H.appendChild(i("li",{className:"ctxmenu-section-header",innerHTML:p("–––––––––––––––––– Grupy ––––––––––––––––––")}));var y=0,K,D=c.CntGroups.list,I;for(I=0,G=0;I<D.length;I++){if(D[I].name.toLowerCase().indexOf(C)>=0){if(G<f){J=true;K=i("a",{href:"#",childNodes:[document.createTextNode(D[I].name)]});v[v.length]=K;H.appendChild(i("li",{childNodes:[K]}));K.clickHandler=(function(P){return function(){P.copyEmails(c.Composition.lastActiveInput);return false}}(D[I]));l(K,"click",K.clickHandler);G++}else{y++}}}if(!G){H.removeChild(H.lastChild)}if(y){H.appendChild(i("li",{innerHTML:p("…i inne (wpisz kolejny znak).")}))}}var z=c.DOM.findPos(w);F.style.left=(z[0])+"px";F.style.top=(z[1]+w.offsetHeight)+"px";F.appendChild(H);if(J){F.style.display="block"}else{F.style.display="none"}l(w,"blur",function(P){setTimeout(function(){var Q=w.suggestDiv;if(Q){Q.parentNode.removeChild(Q);Q=w.suggestDiv=null}n(w,arguments.callee)},500)});w.onkeydown=function(Q){if(!Q){Q=event}var P=x;switch(Q.keyCode){case 38:if(P>0){x--}break;case 40:if(P<v.length-1){x++}break;case 13:if(v.hasOwnProperty(P)){v[P].clickHandler()}break;case 27:return A();default:return null}if(P>=0&&P<v.length&&P!=x){v[P].className=""}if(v[x]){v[x].className="current"}return false}}else{return A()}return null},retrieve:function(u,t){var v;c.Network.ajax({url:u,onSuccess:function w(y,A){if(t&&typeof t==="function"){t()}var z,x=$("contactList");y=c.Network.parseResponse(y);if(y.status){if(x!==null){while(x.hasChildNodes()){x.removeChild(x.firstChild)}}z=y.data;c.Tools.constructArrayElements(Inpl.Mail.Contact,z);j.list=z;v=$("contacts-items-head").firstChild;j.sortContacts("name",!g.hasClass("asc",v),v);c.CntGroups.drawListTable($("groups"))}else{c.UI.showNotice(y.msg,"error");j.managerTab.close()}}})},populateInitialContacts:function(u,t){t=t||"alpha";c.Tools.constructArrayElements(Inpl.Mail.Contact,u);j.list=u;j.sortContacts.apply(j,j.sortContacts.currentSort);j._sidebar.updateView(Number.POSITIVE_INFINITY,t)},populateInitialAutoContacts:function(t){c.Tools.constructArrayElements(Inpl.Mail.Contact,t);j.autoInsertedList=t},finalizeImport:function(){$("contactsFile_error").innerHTML="";c.UI.showNotice(p("Kontakty zostały zaimportowane"),"success");j.manage();j.importTab.close();delete j.importTab},showImportWizard:function(){function u(){r("importCnt")}function t(){delete j.importTab}if(!j.importTab){j.importTab=new c.Tabs.Tab(p("Import"),i("div",{innerHTML:'<div id="importAdr"><form class=impexForm id=importContactsForm enctype="multipart/form-data" action="/html/adrimport,uid,'+c.Tools.getUid()+'" target=hiddenFrame method=post><fieldset><legend>'+p("Import kontaktów")+"</legend><p>"+p("Skorzystaj z możliwości importu kontaktów zapisanych jako plik CSV.")+"</p><p>"+p("Wyszukaj plik, a następnie zaimportuj go na konto:")+'</p><input type=hidden name=MAX_FILE_SIZE value=512000><input id=import-file-input type=file name=file><span id=contactsFile_error class=showErrorCom></span></fieldset></form><iframe style="display:none" frameBorder="0" name="hiddenFrame" src="about:blank"></iframe></div>'}),u,t)}j.importTab.show()},showExportWizard:function(){function u(){r("exportCnt")}function t(){delete j.exportTab}if(!j.exportTab){j.exportTab=new c.Tabs.Tab(p("Eksport"),i("div",{innerHTML:'<div id=exportAdr><form class=impexForm id=exportContactsForm action="/html/adrexport" method=post><fieldset><legend>'+p("Eksport kontaktów")+"</legend><p>"+p("Skorzystaj z możliwości eksportu kontaktów w formie pliku CSV.")+"</p><p>"+p("Zaznacz program pocztowy, a następnie wyeksportuj kontakty:")+"</p><input type=hidden name=all value=1><input type=radio name=application value=interia checked id=r_interia> <label for=r_interia>INTERIA.PL</label><br><input type=radio name=application value=OutlookE id=r_outlooke> <label for=r_outlooke>Outlook Express</label><br><input type=radio name=application value=Outlook2003 id=r_moutlook> <label for=r_moutlook>Microsoft Outlook</label><br><input type=radio name=application value=Thunderbird id=r_thunderbird> <label for=r_thunderbird>Thunderbird</label><br><input type=radio name=application value=Gmail id=r_gmail> <label for=r_gmail>Gmail</label><br></fieldset></form></div>"}),u,t)}j.exportTab.show()},showAddContactDialog:function(){c.Network.checkSession(function(){Inpl.Mail.Contact.prototype.edit.call({})});return false},addContactSimple:function(u,t){t=t||u.split("@")[0];c.Network.ajax({url:"/html/addcontact,nick,1?email="+encodeURIComponent(u)+"&name="+encodeURIComponent(t),onSuccess:function(v){v=c.Network.parseResponse(v);Array.forEach(g.elmsByClass("showErrorCom"),function(w){w.className="errorCom"});if(v.status&&v.data){c.ContactList.list.push(new c.Contact({id:v.data.cntId,name:t,email:u}));c.UI.showNotice(p("Dodano nowy kontakt."),"success")}else{c.UI.showNotice(v.msg,"error")}j._sidebar.updateView()}});return true},init:function(t,u){j.createCtxMenu();j._sidebar=new c.ContactsSidePanel();j._sidebar.render($("side-contacts"));if(t){j.populateInitialContacts(t,c.Prefs.get("contactsView"))}if(u){j.populateInitialAutoContacts(u)}}};j.sortContacts.currentSort=["name",true];return j}());(function(){var d=Inpl.Mail,k=d.DOM,e=d.Tools,b=k.createElement,h=k.addEvent,l=k.removeEvent,i=0,a=new Gettext({domain:"inpl_mail_contact",locale_data:d.L10n}),j=function(m){return a.gettext(m)};function f(n,o){var m,p=n.childNodes;if(n.id){n.id+="_"+o}if(n.htmlFor){n.htmlFor+="_"+o}if(n.hasChildNodes()){for(m=p.length;m--;){f(p[m],o)}}}function g(m){m=m||"";return function(n){return d.ContactList.handleEditResponse(n,m)}}function c(m){var n;this.id=null;this.email="";this.firstName="";this.lastName="";this.messenger="";this.name="";this.note="";this.phone="";this.avatar="";this.score=0;for(n in m){if(m.hasOwnProperty(n)){this[n]=m[n]}}}c.prototype={sortedAs:"#",getDisplayName:function(){if(this.name){return this.name.split("@")[0]}return this.getFullName().split("@")[0]},getFullName:function(){if(this.firstName&&this.lastName){return this.firstName+" "+this.lastName}else{if(this.lastName){return this.lastName}else{if(this.firstName){return this.firstName}else{return""}}}},getRfcString:function(o,n){n=n===undefined?'"':n;o=o||" ";var p="",m=this.name;if(m){p=n+m.split("@")[0]+n+o+"<"+this.email.trim()+">"}else{if(this.email){p=this.email}}return p},getUnquotedRfcString:function(m){return this.getRfcString(m,"")},getPictureURL:function(m){if(this.avatar){return d.env.uploadUrl+"/getcontactphoto,cid,"+this.id+",uname,"+this.id+",uid,"+Inpl.Mail.Tools.getUid()+"?c="+(new Date()).getTime()}return null},composeMail:function(){d.Composition.composeNew({mailto:"mailto:"+this.getRfcString()})},isMemberOfGroup:function(m){if(!this.group){return undefined}return this.group.some(function(n){return n==m},this)},createSidebarLiElement:function(n){var m,o,r,t,q,p,s=this.getRfcString();m=document.createElement("li");o=b("a",{className:"sideCntLink sidebarItem",href:"mailto:"+s,cid:this.id,title:this.email,childNodes:[document.createTextNode(this.name||this.email)]});if(n&&this.name){q=b("a",{className:"adrMail sideCntLink sidebarItem",href:"mailto:"+s,cid:this.id,childNodes:[document.createTextNode("<"+this.email+">")]});p=[o,b("br"),q]}else{p=[o]}t=b("div",{childNodes:p,relatedContact:this});m.appendChild(t);if(d.browser.supports.dnd){d.UI.DnD.makeDraggable(t)}r=b("a",{id:"f"+this.id,className:"editCntIcon menu-activator",href:"#editCnt_"+this.id,innerHTML:"&nbsp;",title:j("Wyświetl opcje kontaktu"),relatedCid:this.id});m.appendChild(r);return m},addToInput:function(o){try{var p=d.Tabs.activeId,n,m=this.getRfcString(),s,r;if(o){n=o}else{n=d.Composition.lastActiveInput||$("emTo_"+p)}if(n.value===""){n.value=m+"; "}else{if(n.value.indexOf(m)===-1){if((n.value.lastIndexOf(";")>n.value.lastIndexOf(","))){s=n.value.lastIndexOf(";");r=";"}else{s=n.value.lastIndexOf(",");r=","}n.value=n.value.substr(0,s);if(n.value.substr(n.value.length-2)!=="; "&&n.value!==""){n.value+=r+" "+m+"; "}else{n.value+=m+"; "}}}if(n.grow){n.grow()}k.setSelectionRange(n,n.value.length,n.value.length)}catch(q){return false}return true},openHistoryTab:function(){var n,m=this.email;n=new d.MessageList({searchf:m},a.strargs(j("Historia: %1"),m));n.openInTab()},edit:function(s){if(this&&this.tab){this.tab.show();return false}var t,y=this.id||"new"+i++,r,o=false,v=this,p=j("Nowy kontakt"),w="newContact",m,q,n=b("div",{id:"addContactAdv",innerHTML:'<form class="cnt-add-form impexForm" id="addContactForm" action="/html/addcontact,fast,1,uid,'+d.Tools.getUid()+'" method="post"><fieldset><legend>'+j("Informacje podstawowe")+'</legend><input id="contId" name="contId" type="hidden" value=""><table class="cnt-add-table"><tr class="even"><td class="firstCol"><label for="name">'+j("Nazwa&nbsp;wyświetlana:")+'</label></td><td><input class=text name=name id=name value="" maxlength=65></td><td class="threCol"><div id="name_error" class="errorCom"></div></td></tr><tr><td class="firstCol"><label for="firstName">'+j("Imię:")+'</label></td><td><input class="text" name="firstName" id="firstName" maxlength="32" value=""></td><td></td></tr><tr class="even"><td class="firstCol"><label for="lastName">'+j("Nazwisko:")+'</label></td><td><input class="text" name="lastName" id="lastName" maxlength="32" value=""></td><td></td></tr><tr><td class="firstCol"><label for="email">'+j("Adres e-mail<b>*</b>:")+'</label></td><td><input type=email class="text" name="email" id="email" value=""></td><td><div id="email_error" class="errorCom"></div></td></tr><tr class="even"><td class="firstCol"><label for="note" id="contGroupLabel">'+j("Grupy kontaktów:")+'</label></td><td id="tdGroupList"></td><td></td></tr><tr><td class=firstCol><label>'+j("Zdjęcie:")+"</label></td><td colspan=2><div id=avatar-image class=avatar-image-div></div><div class=avatar-upload-group><div class=help>"+j("Możesz wysłać plik GIF, JPEG lub PNG.")+"<br>"+j("Maksymalny rozmiar to 640x480 pikseli.")+'</div><div class=avatar-upload-div id="divPictureUpload"><input type=hidden name=hasAvatar id=hasAvatar value=false><input type=hidden name=avatar id=avatar value=""><input type=hidden name=uname id=uname value=""><a class="avatarUploadLink" style="display:none">&nbsp;</a><div id=divPictureUploadHead><div> </div></div><div id=divUploadIFrame> </div></div></div></td></tr></table></fieldset><fieldset><legend><a id="cnt-form-details-switch" class="legend-details-link" href="#" title="'+j("Pozostałe dane o kontakcie")+'" onclick="Inpl.Mail.UI.switchTableDisplay(this.parentNode.nextSibling, this)">'+j("Informacje dodatkowe")+' <span></span></a></legend><table class="cnt-add-table" id="cnt-form-details" style="display: none"><tr class="even"><td class="firstCol"><label for="phone">'+j("Telefon:")+'</label></td><td><input type=tel class=text name=phone id=phone value=""></td><td></td></tr><tr><td class="firstCol"><label for="messenger">'+j("Komunikator:")+'</label></td><td><input class="text" name="messenger" id="messenger" value=""></td><td></td></tr><tr class="even"><td class="firstCol"><label for="note" id="noteLabel">'+j("Notatki:")+'</label></td><td><textarea name="note" rows="9" cols="32" id="note"></textarea></td><td></td></tr></table></fieldset><input type="submit" id="submitAddContactForm" class="submitAddContactForm" name="name" value="dodaj"></form>'}),u=n.getElementsByTagName("input");for(r=u.length;r--;){u[r].value=""}f(n,y);n.style.display="block";k.addEvent(n.getElementsByTagName("form")[0],"change",function(){v.tab.contentChanged=true});if(this instanceof c){p=this.getDisplayName()||j("Edycja kontaktuu");w="editContact"}function x(z){return function(){d.ContactList.makeButtons(w,{saveCmd:function(){var B=k.nodeListToArray(k.elmsByClass("contactEditCreateGroup",$("addContactForm_"+z))||[]),C,D=false,E=false,A=[];for(C=B.length-1;C>=0;C--){if(!B[C].value){d.UI.showNotice(j("Jeśli chcesz stworzyć nową grupę, musisz podać jej nazwę!!"),"error");E=true;break}D=D||d.CntGroups.list.some(function(F){return F.name===B[C].value});if(D){d.UI.showNotice(j("Grupa o podanej nazwie już istnieje!"),"error");break}if(A.some(function(F){return B[C].value==F})){d.UI.showNotice(j("Nie można stworzyć dwóch grup o tej samej nazwie!"),"error");D=true;break}A.push(B[C].value)}if(!E&&!D){$("submitAddContactForm_"+z).click()}},deleteCmd:function(){d.ContactList.deleteContact(v.id);v.tab.close()}})}}this.tab=new d.Tabs.Tab(p,n,x(y),function(){if(v){delete v.tab}});this.tab.show();$("name_"+y).focus();$("divUploadIFrame_"+y).innerHTML='<iframe id="avatar-upload-frame_'+y+'" width=296 scrolling=no class=addcontFrame allowTransparency=true frameBorder=0 name=addcontFrame src="/html/addcontactphoto,cid,'+(this.id||0)+",avatar,"+(this.avatar||0)+",suffix,"+(y||"")+",uid,"+Inpl.Mail.Tools.getUid()+'">';if(this instanceof c){$("contId_"+y).value=this.id;$("uname_"+y).value=this.id;$("name_"+y).value=e.decodeEntities(this.name);$("firstName_"+y).value=e.decodeEntities(this.firstName);$("lastName_"+y).value=e.decodeEntities(this.lastName);$("email_"+y).value=this.email;$("phone_"+y).value=this.phone;$("messenger_"+y).value=this.messenger;$("note_"+y).value=e.decodeEntities(this.note)}else{$("uname_"+y).value=y}$("tdGroupList_"+y).innerHTML="";t=this.group||null;if(t){for(r=0;r<t.length;r+=1){q=r+1;m=d.CntGroups.drawSelectGroup("contFormGroupList_"+y+"_"+q,"listGroup_"+q,t[r],"disabled");$("tdGroupList_"+y).appendChild(m)}}d.CntGroups.multipleSelectGroup("contFormGroupList_"+y,"listGroup","tdGroupList_"+y);Inpl.Network.assign("addContactForm_"+y,{onSuccess:g(y)});if(this.phone||this.messenger||this.note){d.UI.switchTableDisplay($("cnt-form-details_"+y),$("cnt-form-details-switch_"+y));o=true}if(s){if(["phone","messenger","note"].indexOf(s)>=0&&!o){d.UI.switchTableDisplay($("cnt-form-details_"+y),$("cnt-form-details-switch_"+y))}$(s+"_"+y).focus()}return this.tab}};c.getDummyAvatar=function(){return'<span class="dummy_contact">&nbsp;</span>'};Inpl.Mail.Contact=c}());(function(){var d=Inpl.Mail,h=d.DOM,e=d.Tools,c=h.createElement,f=h.addEvent,i=h.removeEvent,k=function(l){return document.createTextNode(l)},a=new Gettext({domain:"inpl_mail_contactview",locale_data:d.L10n}),g=function(l){return a.gettext(l)};function j(l){this.contact=l}var b=j.prototype;b.showInfo=function(){if(!Inpl.Mail.ContactList.managerTab){throw new Error("ContactList tab not available")}var q=this,m=d.CntGroups,r=this.contact,t,n,o,s="",p=[["fullName",g("Imię i nazwisko")],["email",g("Adres e-mail")],["phone",g("Telefon")],["messenger",g("Komunikator")],["note",g("Notatki")]];try{o=$("contactFullInfo");o.relatedContact=r;n=r.avatar?'<img alt="" src="'+r.getPictureURL()+'">':d.Contact.getDummyAvatar();s+="<div class=cnt-details-lead>"+n+(r.name?r.name:r.getFullName())+"</div>";o.innerHTML=s;o.appendChild(c("dl",{childNodes:p.map(function(y){var x=document.createDocumentFragment(),z=y[0],w=y[1],v=z=="fullName"?r.getFullName():r[z],u;x.appendChild(c("dt",{innerHTML:w+":"}));u=c("dd",{className:z});if(v){switch(z){case"note":u.innerHTML=v.replace(/\n/g,"<br>");break;case"email":u.innerHTML='<a title="'+g("Kliknij, aby wysłać wiadomość do tej osoby")+'" href=""></a>';u.firstChild.href="mailto:"+r.getRfcString();u.firstChild.appendChild(k(v));u.firstChild.onclick=function(){r.composeMail();return false};break;default:u.appendChild(k(v))}}else{u.appendChild(c("a",{innerHTML:g("edytuj")+" »",href:"#",onclick:function(){r.edit(z=="fullName"?"firstName":z)}}))}x.appendChild(u);return x})}));if(r.group&&r.group[0]){t=r.group;d.ContactList.showGroupList="none";o.appendChild(c("div",{className:"cnt-switch-ctr",childNodes:[c("a",{id:"cnt-groups-switch",href:"#",className:"hideGroupBlock",innerHTML:g("Lista grup")}),c("ul",{id:"groupListInfo",className:"hiddenGroupListInfo",childNodes:t.map(function(v){var u=m.getById(v).name;if(u.length>30){u=u.substr(0,30)+"…"}return c("li",{innerHTML:u})})})]}))}o.appendChild(c("div",{className:"cnt-switch-ctr",childNodes:[c("a",{id:"cnt-hist-switch",className:"showHistory",href:"#",innerHTML:g("Pokaż historię korespondencji")+" »",onclick:q.contact.openHistoryTab.bind(q.contact)})]}));if($("cnt-groups-switch")){f($("cnt-groups-switch"),"click",function(u){u=u||event;if(d.ContactList.showGroupList=="block"){d.ContactList.showGroupList="none";$("cnt-groups-switch").className="hideGroupBlock"}else{d.ContactList.showGroupList="block";$("cnt-groups-switch").className="showGroupBlock"}$("groupListInfo").style.display=d.ContactList.showGroupList;d.ContactList.updateSizing();h.preventDefault(u)})}d.ContactList.updateSizing()}catch(l){console.log(l)}};d.ContactView=j}());(function(){var d=Inpl.Mail,g=d.DOM,k=d.Composition,i=d.ContactList,b=new Gettext({domain:"inpl_mail_contactssidepanel",locale_data:d.L10n}),h=function(l){return b.gettext(l)},f=g.addEvent,j=g.removeEvent,c=g.createElement;function e(q){q=q||event;var p=q.target||q.srcElement,o=d.Composition.lastActiveInput,n=p.relatedCid,m,l=p;g.preventDefault(q);g.stopPropagation(q);if(n){m=d.ContactList.getById(n)}if(o&&o.id.split("_")[1]!=d.Tabs.activeId){o=$("emTo_"+d.Tabs.activeId)}while(l!==document.body){if(l.relatedContact){m=l.relatedContact;break}l=l.parentNode}if(m){if(p.href.indexOf("#editCnt")>-1){Inpl.Mail.ContactList.contextMenu.show(p,q,"side-ctx-menu",(p.offsetLeft+p.offsetWidth)+"px",(p.offsetTop-$("ful_my").scrollTop)+"px")}else{d.ContactList.contextMenu.hide();if(o){o.addAddress(m);o.focus();k.lastActiveInput=o}else{m.composeMail()}}}d.Tools.hitGemius(d.Tools.getGemiusByAlias("SIDEBAR","CONTACTS"));return false}function a(){this.htmlNodes={}}a.prototype={render:function(q){var p=this,l,o,n,r=document.createDocumentFragment(),m=h("Szukaj kontaktów…");this.htmlNodes.renderTarget=q;r.appendChild(c("h2",{childNodes:[c("a",{className:"side-cnt-manage",href:"#contacts",onclick:function(){i.manage();_gaq.push(["b._trackEvent","Menu boczne","Kontakty","Otwarcie"])},title:h("Kontakty"),childNodes:[c("span"),document.createTextNode(h("Kontakty"))]})]}));r.appendChild(c("button",{className:"sideBtn side-cnt-new",title:h("Dodaj nowy kontakt"),onclick:function(){i.showAddContactDialog();_gaq.push(["b._trackEvent","Menu boczne","Kontakty","Nowy - klik"])},innerHTML:h("nowy")+"&nbsp;»"}));n=this.htmlNodes.searchForm=r.appendChild(c("div",{className:"side-contacts-search",childNodes:[c("form",{className:"side-contacts-search-form",onsubmit:function(){return false},method:"post",innerHTML:'<label for="side-cnt-search">'+h("Szukaj kontaktów:")+' </label><input type=search id="side-cnt-search" name="cnotName" class="sideInput sidebarItem" placeholder="'+m+'" value="">'})]}));l=n.firstChild.firstChild.nextSibling;if(!d.browser.supports.placeholder){g.addPlaceholderSupport(l)}g.selectOnFocus(l);f(l,"keyup",function(){var s=l.value;if(s){p.search(s)}else{p.showAllContacts()}});this.htmlNodes.filterAllA=c("a",{className:"sidebarItem",href:"#",onclick:function(){p.showAllContacts();_gaq.push(["b._trackEvent","Menu boczne","Kontakty","Wszystkie - klik"]);return false},title:h("Wszystkie kontakty"),innerHTML:h("Wszystkie")});this.htmlNodes.filterFreqA=c("a",{className:"sidebarItem",href:"#",onclick:function(){p.showFrequentContacts();_gaq.push(["b._trackEvent","Menu boczne","Kontakty","Często używane - klik"]);return false},title:h("10 najczęściej używanych kontaktów"),innerHTML:h("Często używane")});this.htmlNodes.filterSwitch=r.appendChild(c("div",{className:"sidebarItem side-cnt-filterswitch",childNodes:[this.htmlNodes.filterAllA,c("span",{innerHTML:"|"}),this.htmlNodes.filterFreqA]}));o=this.htmlNodes.listElement=c("ul",{className:"side-cnt-list"});f(o,"click",e);d.ContactList.contextMenu.attachTo(o,"li","side-ctx-menu");r.appendChild(o);q.appendChild(r)},search:function(n){var m=i.search(n),l=this.htmlNodes.listElement;g.removeChildren(l);if(!m.length){l.appendChild(c("li",{className:"side-no-contacts disableCtxmenu",innerHTML:h("Brak pasujących kontaktów")}))}else{m.forEach(function(o){l.appendChild(o.createSidebarLiElement(true))})}},updateView:function(m,l){var q,n,r,p=this.htmlNodes.renderTarget,o=this.htmlNodes.listElement;o.innerHTML="";l=l||d.Prefs.get("contactsView");if(m){this.maxItems=m}r=i.list.slice();if(r.length){if(l==="freq"){r=r.filter(function(s){return s.score>0});r.sort(function(t,s){var u,v;if(t&&s){u=parseFloat(t.score,10);v=parseFloat(s.score,10);if(u<v){return 1}else{if(u>v){return -1}else{return 0}}}else{return 0}});d.DOM.addClass(this.htmlNodes.filterFreqA,"act");d.DOM.removeClass(this.htmlNodes.filterAllA,"act");d.Prefs.set("contactsView","freq")}else{d.DOM.removeClass(this.htmlNodes.filterFreqA,"act");d.DOM.addClass(this.htmlNodes.filterAllA,"act");d.Prefs.set("contactsView","alpha")}if(r.length){for(n=0;n<r.length&&n<this.maxItems;n+=1){if(r[n]!==null){q=r[n].createSidebarLiElement();o.appendChild(q)}}}else{o.appendChild(c("li",{className:"side-no-contacts disableCtxmenu",innerHTML:h("brak używanych kontaktów")}))}o.style.display=this.htmlNodes.searchForm.style.display=this.htmlNodes.filterSwitch.style.display=""}else{if(!d.ContactList.list.length){o.style.display=this.htmlNodes.searchForm.style.display=this.htmlNodes.filterSwitch.style.display="none"}}p.appendChild(o)},showContacts:function(){if(d.Prefs.get("contactsView")==="freq"){this.showFrequentContacts()}else{this.showAllContacts()}},showAllContacts:function(){this.updateView(Number.POSITIVE_INFINITY,"alpha");return false},showFrequentContacts:function(){this.updateView(20,"freq");return false}};d.ContactsSidePanel=a}());(function(e){var h,b=e.Mail,f=b.UI,g=b.Prefs,c="cntWarnListActive",a=new Gettext({domain:"inpl_mail_inlineimageuploader",locale_data:e.Mail.L10n}),d=function(i){return a.gettext(i)};b.ContactsWarnList=h={items:null,loadItems:function(i,l){var k=this,j=g.get(c);if(!j){this.items=null;if(typeof i==="function"){i()}return}if(k.items){if(typeof i==="function"){i()}}else{b.Network.ajax({url:"/html/cntwarnlist",onSuccess:function(m){m=b.Network.parseResponse(m);if(m.status){k.items=m.data;if(typeof i==="function"){i()}}else{if(typeof l==="function"){l()}}}})}},verify:function(m,l){var k,j=g.get(c),i=this.items;if(!j){l(false);return}if(!Array.isArray(m)){m=[m]}if(i!==null){k=i.filter(function(n){if(n.email){return m.some(function(o){return n.email===o})}else{if(n.regexp){return m.some(function(o){return(new RegExp(n.regexp)).test(o)})}else{return false}}});if(k.length){l(true,k[0])}else{l(false)}}else{this.loadItems(this.verify.bind(this,m,l))}},doAction:function(k,j,i,n){var m=this,l=g.get(c);if(!l){if(typeof i==="function"){i(k)}return}m.verify(k,function(p,o){if(p){m.showDialog({content:n,contact:o,question:j,onAccept:function(){if(typeof i==="function"){i(k)}}})}else{if(typeof i==="function"){i(k)}}})},handleCheckbox:function(){var i=$("warnlist-checkbox"),j=!i.checked;g.set(c,j?1:0,true);if(!j){this.items=null}},showDialog:function(k){k=k||{};var i=b.DOM.createElement,m=this,p,n=k.contact,l=k.question,j=k.onAccept,q=n.url?d("<p>Otrzymujesz wiadomości od %1, ponieważ jesteś użytkownikiem tego serwisu.</p><p>Jeśli nie chcesz już otrzymywać takich maili, <a href='%2' target=_blank>zmień ustawienia powiadomień</a> w ramach swojego konta w %1 lub zapoznaj się z informacjami, które mogą być zawarte w tej wiadomości.</p>"):d("<p>Otrzymujesz wiadomości od %1, ponieważ jesteś użytkownikiem tego serwisu.</p><p>Jeśli nie chcesz już otrzymywać takich maili, zmień ustawienia powiadomień w ramach swojego konta w %1 lub zapoznaj się z informacjami, które mogą być zawarte w tej wiadomości.</p>"),o=k.content||q;p=f.ModalDialogs.createModalDialog({additionalClass:"contacts-warnlist-alert",title:d("Wskazówka"),message:Gettext.strargs(o,[n.name,n.url])+"<p>"+l+"</p>",createButtons:function(){return[i("button",{innerHTML:d("Ok"),className:"okBtn",onclick:function(){m.handleCheckbox();if(typeof j==="function"){j()}p.hide()}}),i("button",{innerHTML:d("Anuluj"),className:"cancelBtn",onclick:function(){p.hide()}})]},createFooter:function(){return i("div",{className:"overlay-footer",innerHTML:"<label><input type=checkbox id=warnlist-checkbox>"+d("Nie pokazuj więcej tego komunikatu")+"</label>"})}},f.ModalDialogs.prototypes.richAlertDialog);p.enqueue()}}}(Inpl));(function(){var e=Inpl.Mail,d=e.UI,h=e.DOM,f=e.Tools,c=h.createElement,b=new Gettext({domain:"inpl_mail_printpreview",locale_data:e.L10n}),i=function(k){return b.gettext(k)},j=[{ident:"closeBtn",label:i("Zamknij"),cmd:function(){e.Tabs.closeActiveTab()}}];function g(){d.injectButtons(j,"nav1");d.injectButtons(j,"bottIco")}function a(k){this.folderId=k.folderId||1;this.msgId=k.msgId;this.mpid=k.mpid;this.threadId=k.threadId;this.mode=k.mode||a.SHOW_MESSAGE;this.allowExternalContent=k.allowExternalContent||false;this.voucherCode=k.voucherCode;if(!this.msgId&&!this.threadId){throw new Error("PrintPreview requires a message or a thread")}}a.SHOW_MESSAGE=1;a.SHOW_THREAD=2;a.prototype={open:function(){var p,m,n,k=e.Tabs,l,o;o="printView_"+((!e.browser.opera&&!e.browser.chrome)?k.nextId:this.msgId+(new Date()).getTime());m=c("div",{className:"viewEm print-preview",innerHTML:'<iframe frameBorder=0 name="'+o+'" id="'+o+'" class="printView" src="about:blank"></iframe>'});switch(this.mode){case a.SHOW_MESSAGE:l={folder:this.folderId,mesg:this.msgId,view:"print",uid:f.getUid()};if(this.mpid){l.mpid=this.mpid}if(this.voucherCode){l.voucherCode=this.voucherCode}p=f.preparePost("/html/getmail,imgProtectedStatus,"+(this.allowExternalContent?"0":"1"),l,o);break;case a.SHOW_THREAD:p=f.preparePost("/html/thread,imgProtectedStatus,"+(this.allowExternalContent?"0":"1"),{thId:this.threadId,folder:this.folderId,print:1,view:"print_"+k.nextId,uid:f.getUid()},o);break}if(!e.browser.opera&&!e.browser.chrome){n=new k.Tab(i("Podgląd wydruku"),m,g);n.show();e.Tools.prepareFrameCheck($(o),n)}p.submit()}};Inpl.Mail.PrintPreview=a}());Inpl.Mail.CntGroups=(function(){var e=Inpl.Mail,i,l=e.ContactList,k=e.DOM,d=e.UI,f=e.Tools,b=k.createElement,h=k.addEvent,a=new Gettext({domain:"inpl_mail_cntGroups",locale_data:e.L10n}),j=function(p){return a.gettext(p)},n=k.removeEvent,g=0;function c(){return g++}function o(q,p){if(q.name<p.name){return -1}else{if(q.name>p.name){return 1}}return 0}function m(q){var p;for(p in q){if(q.hasOwnProperty(p)){if(p==="name"){this.name=f.decodeEntities(q.name).trim()}else{if(p==="id"){this.id=parseInt(q.id,10)}else{this[p]=q[p]}}}}}m.prototype={getMembers:function(){var p=l.list,t,s,r,q=[];for(s=0;s<p.length;s++){t=p[s];if(!t.group){throw new Error("No group bindings")}for(r=0;r<t.group.length;r++){if(t.group[r]==this.id){q.push(t)}}}return q},getMembers_async:function(p){if(typeof p!=="function"){return}e.Network.ajax({url:"cntgroup,gid,"+this.id,onSuccess:function(r){r=e.Network.parseResponse(r);var q=[];if(r.status){r.data.forEach(function(t){var s=l.getById(t.cid);if(s){q.push(s)}})}else{d.showNotice(r.msg,"error")}p(q)}})},edit:function(){var r=this,q=this.id;function s(){i.makeButtons("editGroup",{grpDeleteCmd:function(){d.ModalDialogs.confirm({message:j("Czy na pewno usunąć grupę?"),onAccept:function(){i.delGroup(q)}})}})}function p(){delete r.tab}if(!this.tab){this.tab=new e.Tabs.Tab(this.name,i.createGroupForm(this),s,p)}this.tab.show()},copyEmails:function(p){try{var r=e.Tabs.activeId,q=p||$("emTo_"+r),u=q.value.lastIndexOf(","),t=q.value.lastIndexOf(";");if(u==-1&&t==-1){q.value=""}else{q.value=q.value.substr(0,Math.max(u,t)+1)}this.getMembers_async(function(v){var w=v.map(function(x){return x.getRfcString()});if(q.value){q.value+=" "}q.value+=w.join("; ")+"; ";q.focus();if(q.grow){q.grow()}})}catch(s){console.log(s);return false}return true}};i={Group:m,activeId:-1,makeButtons:function(p,r){r=r||{};var q={group:[{ident:"saveT",label:j("Zapisz"),title:j("Zapisz utworzoną grupę"),cmd:function(){k.elmsByClass("submitAddGroupForm",e.Tabs.getActiveTab().bodyElement)[0].click()}},{ident:"cancelBtn",label:j("Anuluj"),title:j("Zrezygnuj z dodawania grupy"),cmd:function(){e.Tabs.closeActiveTab()}}]};q.editGroup=[q.group[0],{ident:"removeGroupBtn",label:j("Usuń grupę"),title:j("Usuń tę grupę"),cmd:r.grpDeleteCmd},q.group[1]];d.injectButtons(q[p],"nav1");d.injectButtons(q[p],"bottIco")},addGroup:function(q,v,u){var r,t,w,s,p=k.nodeListToArray($("contactsGroupList_"+u).childNodes);q=e.Network.parseResponse(q);if(q.status){s=q.data;t=s.grpId;w=s.grpName;p.forEach(function(x){l.getById(parseInt(x.id,10)).group.push(t)});i.list.push(new m({id:t,name:w}));e.Tabs.closeActiveTab();if(l.managerTab){r=$("groups");r.innerHTML="";l.managerTab.show();i.drawListTable(r)}d.showNotice(j("Grupa została dodana"),"success")}else{d.showNotice(q.msg,"error")}},updateGroup:function(q,p,w,v){var u,r,x,t,s=k.nodeListToArray($("contactsGroupList_"+w).childNodes);q=e.Network.parseResponse(q);if(q.status){t=q.data;r=t.grpId;x=t.grpName;v.name=x;l.list.forEach(function(y){y.group=y.group.filter(function(z){return z!=r})});s.forEach(function(z){var y=l.getById(parseInt(z.id,10));y.group.push(r)});u=$("groups");u.innerHTML="";e.Tabs.closeActiveTab();if(l.managerTab){l.managerTab.show();i.showContacts(this.activeId)}i.drawListTable(u);d.showNotice(j("Grupa została uaktualniona"),"success")}else{d.showNotice(q.msg,"error")}},delGroup:function(s){var r,q;s=s||i.activeId;function p(t){var v,u;t=e.Network.parseResponse(t);if(t.status){d.showNotice(a.strargs(j("Grupa %1 została usunięta"),q),"success");v=i.getById(t.data.grpId);try{v.getMembers().forEach(function(x){var y=l.getById(x.id),z=v.id;y.group=y.group.filter(function(A){return A!=z})})}catch(w){}i.list.splice(i.list.indexOf(v),1);u=$("groups");u.innerHTML="";i.drawListTable(u);l.makeButtons("main");i.showContacts(-1);k.addClass($("allcontacts"),"active")}else{d.showNotice(t.msg,"error")}}r=i.getById(s);q=r.name;if(r.tab){e.Tabs.getById(r.tab).close()}e.Network.ajax({url:"delgroup,gid,"+s,onSuccess:p});return true},getById:function(q){var p=i.list.filter(function(r){return r.id===q});return p[0]||null},drawListTable:function(w,q,z,p){var y,D,r,u,E,x,s;if(!w){w=$("groups");w.innerHTML=""}try{y=b("ul",{id:"groupList",width:"100%"});if(!z&&z!==0){z=0}if(!p||p>this.list.length){p=this.list.length-1}D=document.createElement("li");D.id="allcontacts";if(this.activeId==-1){D.className="active"}D.innerHTML='<a href="#" class="groupName" title="'+j("Wszystkie kontakty")+'">'+j("Wszystkie")+'</a> <span class="members">(<b>'+l.list.length+"</b>)</span>";h(D,"click",function(){l.useAlphabet=true;i.activate(-1);i.showContacts(-1)});y.appendChild(D);function v(F){l.useAlphabet=false;i.showContacts(this.relatedGroup.id);i.activate(this.id);k.preventDefault(F)}function C(F){if(this.relatedGroup){this.relatedGroup.edit()}}for(u=z;u<=p;u++){if(this.list[u]){E=this.list[u].name;if(E.length>20){E=E.substr(0,19)+"…"}x=b("a",{href:"#",className:"groupName",title:this.list[u].name,childNodes:[document.createTextNode(E)]});s=b("span",{className:"members",innerHTML:"(<b>"+this.list[u].getMembers().length+"</b>)"});r=b("li",{id:"cg_"+this.list[u].id,relatedGroup:this.list[u],childNodes:[x,s],className:this.list[u].id==this.activeId?"active":""});r.relatedGroup=this.list[u];if(p===u){r.className="last"}h(r,"click",v);h(r,"dblclick",C);y.appendChild(r)}}w=w||$("groups");w.innerHTML="";w.appendChild(y);var B=$("contact-items"),A=$("cnt-initials");if(B&&A){y.style.height=B.offsetHeight+A.offsetHeight+"px"}}catch(t){console.log(t)}if(!this.list.length){w.style.display="none";$("contacts-grp-head").style.display="none"}else{w.style.display="";$("contacts-grp-head").style.display=""}},drawSelectGroup:function(w,r,t,u){var v=b("div"),q=r||"",s,p;u=u||"";if(u!=="disabled"){s=[b("option",{value:"none",innerHTML:this.list.length?" -> "+j("wybierz grupę")+" <- ":j("brak")})]}else{s=[]}this.list.forEach(function(y){var x;if(u!=="disabled"||(y&&y.id==t)){x=b("option",{id:w+"__"+y.id,value:y.id,title:y.name,childNodes:[document.createTextNode(y.name)]});if(y&&y.id==t){x.selected=true}s.push(x)}});if(u!=="disabled"){s.push(b("option",{disabled:"disabled",value:"-99",innerHTML:"————————"}));s.push(b("option",{id:w+"__0000",value:"new",className:"newCntGroup",innerHTML:j("nowa grupa")}))}p=b("select",{id:w,name:"listGroup["+q+"]",childNodes:s});v.appendChild(p);v.appendChild(b("a",{href:"#",onclick:function(){if(this.parentNode.parentNode.childNodes.length>1){this.parentNode.parentNode.removeChild(this.parentNode)}else{this.previousSibling.selectedIndex=0}return false},innerHTML:j("usuń »"),title:j("Usuń wybraną grupę")}));if(p.selectedIndex===0&&u!=="disabled"){v.lastChild.style.display="none"}return v},multipleSelectGroup:function(s,q,v){var u=1,t,r,w=$(v),p=w.childNodes,x;x=p.length?p[(p.length)-1].firstChild:"";u=parseInt(x.id?x.id.replace(/contFormGroupList_.+_/ig,""):0,10)+1;t=s+"_"+u;r=q+"_"+u;w.appendChild(this.drawSelectGroup(t,r));h($(t),"change",function(E){var z,B,A=s+"_new_"+u,F,D=this,C=D.nextSibling,y=D.selectedIndex;F=D.parentNode;if(y===0){C.style.display="none"}else{C.style.display=""}if(e.browser.ie&&e.browser.ie<8&&D.options[y].value==-99){y+=1}if(D.options[y].value=="new"){if(F.lastChild.id!=A){D.parentNode.removeChild(D);B=b("input",{name:"newGroup[listGroup_"+u+"]",id:A,className:"text contactEditCreateGroup"});F.appendChild(B);F.appendChild(C);B.focus()}}else{if(F.lastChild.id===A){F.removeChild(F.lastChild);if(F.lastChild.tagName=="BR"){F.removeChild(F.lastChild)}}}if(y!==0){z=!Array.some(p,function(G){var H=G.firstChild;return !!(H&&H.type=="select-one"&&H.options[H.selectedIndex].value==="none")});if(z){i.multipleSelectGroup(s,q,v)}}})},showContacts:function(p,v,y){var t=null,x=null,s,r,q;function w(D,E){var B,A,z=[];try{if(E!="object"){D=e.Network.parseResponse(D);if(D.status){B=D.data;A=l.list;for(s=0;s<B.length;s++){for(r=0;r<A.length;r++){if(A[r]&&A[r].id==B[s].cid){z.push(A[r]);break}}}}}else{z=D.data}l.drawListTable(null,t,x,z);if(y){y()}}catch(C){console.log(C)}}if(p>=0){q=false;if(!v){try{w({status:true,data:i.getById(p).getMembers()},"object");q=true}catch(u){q=false}}if(v||!q){e.Network.ajax({url:"cntgroup,gid,"+p,onSuccess:w})}}else{l.drawListTable(null,t,x)}},activate:function(q){var p;if(q!==-1){p=$(q)}else{p="allcontacts"}if(this.activeId===null){this.activeId=p.relatedGroup.id}this.deactivate();if(q!==-1){this.activeId=p.relatedGroup.id}else{this.activeId=-1}k.removeClass(p,"hover");k.addClass(p,"active");if(q!=-1){l.makeButtons("main",{showGrpOpts:true})}else{l.makeButtons("main")}},deactivate:function(){var p;if(this.activeId===-1){p=$("allcontacts")}else{p=$("cg_"+this.activeId)}if(p){k.removeClass(p,"active")}},sortGroups:function(r,s,p){var q=(s?1:-1);i.list.sort(function(u,t){var v=u[r].toLowerCase(),w=t[r].toLowerCase();return q*v.localeCompare(w)});if(p){p.className=s?"asc":"desc"}i.sortGroups.currentSort=[r,s];i.drawListTable()},doSortGroups:function(q,p){if(i.sortGroups.currentSort&&i.sortGroups.currentSort[0]==q){i.sortGroups(q,!i.sortGroups.currentSort[1],p)}else{i.sortGroups(q,true,p)}},init:function(p){if(Array.isArray(p)){f.constructArrayElements(i.Group,p);i.list=p.sort(o)}else{i.list=[]}},createGroupForm:function(y){var p,v,r="",w="",z=c(),s,t=[],u;function x(A){if(A.tagName==="UL"){if(A.id==="cntList_"+z){if(k.elmsByClass("checked",A).length){$("addCntToGroup_"+z).disabled=false;$("addAllCntToGroup_"+z).disabled=false}else{if(A.childNodes.length){$("addCntToGroup_"+z).disabled=true;$("addAllCntToGroup_"+z).disabled=false}else{$("addCntToGroup_"+z).disabled=true;$("addAllCntToGroup_"+z).disabled=true}}}else{if(A.id==="contactsGroupList_"+z){if(k.elmsByClass("checked",A).length){$("remCntToGroup_"+z).disabled=false;$("remAllCntToGroup_"+z).disabled=false}else{if(A.childNodes.length){$("remCntToGroup_"+z).disabled=true;$("remAllCntToGroup_"+z).disabled=false}else{$("remCntToGroup_"+z).disabled=true;$("remAllCntToGroup_"+z).disabled=true}}}}}}if(y){v=y.id;s=y.getMembers();r=f.decodeEntities(y.name);s.map(function(A){var C=A.email,B=A.name||C;u=b("li",{id:A.id,title:C,innerHTML:B});t.push(u);k.addEvent(u,"click",function(D){l.checkOption(D,x)})});w=l.drawLiListContacts(s,x)}else{w=l.drawLiListContacts("",x);v=""}function q(D){var A=k.nodeListToArray($("contactsGroupList_"+z).childNodes),C=[],E=$("groupName_"+z).value,B=v?v:"";A.map(function(F){C.push(parseInt(F.id,10))});D=D||window.event;k.preventDefault(D);e.Network.ajax({url:"/html/addgroup,uid,"+f.getUid(),onSuccess:function(F,G){if(B){i.updateGroup(F,G,z,y)}else{i.addGroup(F,G,z)}return false},post:{contactsGroupList:C,gname:E,gid:B}});return false}p=b("form",{id:"addGroupForm_"+z,method:"post",className:"cnt-addgrp-form impexForm",childNodes:[b("fieldset",{childNodes:[b("table",{className:"addGroup",childNodes:[b("tbody",{childNodes:[b("tr",{childNodes:[b("td",{colSpan:3,childNodes:[b("label",{htmlFor:"groupName_"+z,className:"groupNameLabel",innerHTML:j("Nazwa grupy:")}),b("input",{className:"text groupName",id:"groupName_"+z,name:"gname",value:r})]})]}),b("tr",{childNodes:[b("td",{childNodes:[b("label",{htmlFor:"cntList_"+z,innerHTML:j("Lista kontaktów:")}),b("br"),b("ul",{id:"cntList_"+z,className:"groupSelectList",childNodes:w})]}),b("td",{childNodes:[b("input",{type:"button",disabled:true,className:"button addCntToGroup",id:"addCntToGroup_"+z,title:j("Dodaj wybrane kontakty do grupy"),name:"addCntToGroup",onclick:function(){d.moveOptions($("cntList_"+z),$("contactsGroupList_"+z),false,x);return false},value:j("dodaj »")}),b("input",{type:"button",className:"button addAllCntToGroup",id:"addAllCntToGroup_"+z,title:j("Dodaj wszystkie kontakty do grupy"),name:"addAllCntToGroup",onclick:function(){d.moveOptions($("cntList_"+z),$("contactsGroupList_"+z),true,x);return false},value:j("dodaj wszystkie »")}),b("input",{disabled:true,type:"button",className:"button remCntToGroup",id:"remCntToGroup_"+z,title:j("Usuń wybrane kontakty z grupy"),name:"remCntToGroup",onclick:function(){d.moveOptions($("contactsGroupList_"+z),$("cntList_"+z),false,x);return false},value:j("« usuń")}),b("input",{disabled:t.length?false:true,type:"button",className:"button remAllCntToGroup",id:"remAllCntToGroup_"+z,title:j("Usuń wszystkie kontakty z grupy"),name:"remAllCntToGroup",onclick:function(){d.moveOptions($("contactsGroupList_"+z),$("cntList_"+z),true,x);return false},value:j("« usuń wszystkie")})]}),b("td",{childNodes:[b("label",{htmlFor:"contactsGroupList_"+z,innerHTML:j("Kontakty w grupie:")}),b("br"),b("ul",{id:"contactsGroupList_"+z,className:"contactsGroupList groupSelectList",childNodes:t})]})]})]}),b("tfoot",{childNodes:[b("tr",{childNodes:[b("td",{colSpan:3,childNodes:[b("button",{className:"submitAddGroupForm",id:"submitAddGroupForm_"+z,name:"name",innerHTML:j("Dodaj grupę"),onclick:q})]})]})]})]})]})]});return p},showAddGroupDialog:function(){function p(){i.makeButtons("group")}(new e.Tabs.Tab(j("Nowa grupa"),i.createGroupForm(),p)).show()},showEditGroupDialog:function(p){(p||i.getById(i.activeId)).edit()}};i.sortGroups.currentSort=["name",true];return i}());Inpl.Mail.Tabs=(function(e){var k=20,d=Inpl.Mail,f=d.Tools,i=d.DOM,b=i.createElement,g=i.addEvent,j=i.removeEvent,a=new Gettext({domain:"inpl_mail_tabs",locale_data:d.L10n}),h=function(m){return a.gettext(m)},l;if(!e){e=1}function c(n,r,s,m,o){o=o||{};this.title=n;this.id=l.nextId;l.nextId+=1;if(l.list.length===0){l.htmlNodes.tabsHeader.innerHTML=""}var p=this,u,t=b("span");this.headerElement=b("li",{className:"tabHeader",onclick:function(){var v,y,w,x;x=!(l.activeId===p.id);p.show();if(x){v="Zakładki",y="Przeklikiwanie pomiędzy zakładkami",w="";if(typeof p.msgList==="object"){if(typeof p.msgList.folder==="string"&&p.msgList.folder.length){w="Foldery wirtualne"}else{if(typeof p.msgList.folder==="number"){if(typeof p.msgList.thread==="number"){w="Wątek"}else{if(p.msgList.folder===0){w="Wyniki wyszukiwania"}else{if(p.msgList.folder===1){w="Folder Odebrane"}else{if(p.msgList.folder===2){w="Folder Wysłane"}else{if(p.msgList.folder===-1){w="Folder Kopie robocze"}else{if(p.msgList.folder===3){w="Folder Kosz"}else{if(p.msgList.folder===-2){w="Folder Spam"}else{w="Foldery użytkowników"}}}}}}}}else{y="BŁĄD!";w="Id folderu nie jest ani stringiem ani numerem: "+p.msgList.folder}}}else{if(typeof p.mail==="object"){w="Wiadomość"}else{if(p.contentChanged===true||p.contentChanged===false){w="Okno pisania nowej wiadomości"}else{if(p.title==="Kontakty"){w="Kontakty"}else{if(p.title==="Nowy kontakt"){w="Nowy kontakt"}else{if(p.title==="Załączniki"){w="Załączniki"}else{w="Inna zakładka"}}}}}}if(y){_gaq.push(["b._trackEvent",v,y,w])}}}});if(n&&!(n instanceof Array)){t.appendChild(document.createTextNode(f.truncateString(n,k)));t.title=n}else{t.appendChild(document.createTextNode("(tab#"+this.id+")"));t.title="tab#"+this.id;if(!r){r=document.createTextNode(n)}}if(o.isPermanent){i.addClass(this.headerElement,"tab-permanent");this.headerElement.appendChild(b("div",{childNodes:[t]}))}else{u=b("button",{innerHTML:"<span>"+h("Zamknij kartę")+"</span>",title:h("Zamknij kartę")});g(u,"click",function(v){if(!d.browser.ie||d.browser.ie>=9){v.stopPropagation()}p.safeClose()});this.headerElement.appendChild(b("div",{childNodes:[t,u]}))}this.bodyElement=b("div",{className:"tabBody"+(o.isBorderless?" tab-body-borderless":"")});try{this.bodyElement.appendChild(r)}catch(q){console.log("Invalid object passed as content to Tab constructor:"+typeof r)}d.Tabs.list.push(this);l.htmlNodes.tabBodyCont.appendChild(this.bodyElement);l.htmlNodes.tabsHeader.appendChild(this.headerElement);if(typeof m==="function"){this.onAfterClose=m}if(typeof s==="function"){this.onAfterOpen=s}}c.prototype={toString:function(){return this.id},show:function(){var m=l.htmlNodes.tabHeaderCont,q=l.getById(l.activeId),p,o=this.headerElement,n=this.bodyElement;d.InfoBox.hide();if(q&&typeof q.onBeforeHide==="function"){if(!q.onBeforeHide()){return}}l.deactivate();l.activeId=this.id;i.addClass(o,"activeHeaderTab");i.addClass(n,"activeBodyTab");clearInterval(l.scrollInterval);p=l.list[0].headerElement;if(o.offsetLeft-p.offsetLeft<m.scrollLeft){m.scrollLeft=o.offsetLeft-p.offsetLeft}else{if(o.offsetLeft-p.offsetLeft+o.offsetWidth>m.scrollLeft+m.offsetWidth){m.scrollLeft=o.offsetLeft-p.offsetLeft+o.offsetWidth-m.offsetWidth+40}}l.htmlNodes.tabHeaderCont.inpl_scroll(0);d.UI.WindowTitle.setText(this.title);if(d.UI.UtilLayer&&d.UI.UtilLayer.isShown){d.UI.UtilLayer.hide()}window.scrollTo(0,0);if(typeof this.onAfterOpen==="function"){this.onAfterOpen()}},close:function(){var o,p=l.htmlNodes,m=null,n=l.list;if(n.length>1){o=n.indexOf(this);n.splice(o,1);if(this.id==l.activeId){if(o>0){m=n[o-1]}else{m=n[0]}l.activeId=m.id;m.show()}p.tabBodyCont.removeChild(this.bodyElement);p.tabsHeader.removeChild(this.headerElement)}if(typeof this.onAfterClose==="function"){this.onAfterClose()}l.htmlNodes.tabHeaderCont.inpl_scroll(0)},safeClose:function(){this.close()},setTitle:function(o,m){var n=this.headerElement.getElementsByTagName("span")[0];n.firstChild.nodeValue=f.truncateString(o,k);n.title=o;this.title=o;l.htmlNodes.tabHeaderCont.inpl_scroll(0);d.UI.WindowTitle.setText(m||o)}};l={Tab:c,nextId:1,activeId:e,list:[],getById:function(m){return d.Tabs.list.filter(function(n){return n.id==m})[0]||null},getActiveTab:function(){var m=null;if(l.activeId){m=l.getById(l.activeId)}return m},closeActiveTab:function(){var m=l.getActiveTab();if(m){m.close()}},deactivate:function(){var m;try{m=l.getActiveTab();if(m){i.removeClass(m.headerElement,"activeHeaderTab");i.removeClass(m.bodyElement,"activeBodyTab")}}catch(n){console.log(n)}},htmlNodes:{},init:function(){var m=d.UI.Scrollable,p=l.htmlNodes,o=p.tabsDiv=$("tabs"),n=document.createDocumentFragment();p.tabHeaderCont=$("tabHeaderCont");p.tabsHeader=$("tabsHeader");p.tabBodyCont=$("tabBodyCont");m.apply(p.tabHeaderCont,true,'<span class="scLeft"><a title="'+h("Przewiń w lewo")+'"><b>&#9664;</b></a></span>','<span class="scRight"><a title="'+h("Przewiń w prawo")+'"><b>&#9654;</b></a></span>',m.wrapModes.BEFORE);o.insertBefore(n,o.firstChild)},showExternalTab:function(o,n,m){var p,q;m=m||{};q=b("iframe",{src:n,frameBorder:0,style:{width:"100%",height:m.height||"400px"}});p=new c(o,q);p.show();return p}};return l}());Inpl.Mail.Folders=(function(){var v,n=-1,l=-2,e=2,g=3,y=1,k=-100,d=-101,w=false,j=false,f=Inpl.Mail,b=f.Tools,p=f.DOM,m=f.UI,a=f.Network,s=p.createElement,A=p.addEvent,C=p.removeEvent,B=15,x=21,c="dirArrD",i=false,u=new Gettext({domain:"inpl_mail_folders",locale_data:f.L10n}),E=function(H){return u.gettext(H)},z=[n,l,e,g],h={"-2":E("Spam"),"-1":E("Kopie robocze"),1:E("Odebrane"),2:E("Wysłane"),3:E("Kosz")};function D(I){if(!(this instanceof D)){return new D(I)}this.read=0;this.unread=0;this.incoming=0;this.name=E("(folder bez nazwy)");this.subfolders=null;this.id=null;this.level=0;var H;for(H in I){if(I.hasOwnProperty(H)){if(H==="subfolders"&&I.subfolders.length){this.subfolders=I[H].map(D)}else{if(H==="unread"||H==="read"){this[H]=parseInt(I[H],10)}else{this[H]=I[H]}}}}if(this.id in h){this.name=h[this.id]}}D.prototype={deleteActionUrl:"/html/diropt,o,2,fid,",editActionUrl:"/html/diropt,o,3,fid,",removeActionUrl:"/html/diropt,o,7,fid,",readAllActionUrl:"/html/diropt,o,6,fid,",open:function(J){b.hitGFK();var I,L,K,M=f.MessageList,H=M.mainList;if(this.msgList){this.msgList.refresh(true);this.msgList.tab.show();return true}I={folder:this.id,sort:H.sort,sorder:H.sorder};if(J){H.reset(I);H.tab.setTitle(this.name);K=H.tab.headerElement.getElementsByTagName("b")[0];if(K){K.parentNode.removeChild(K);K=null}H.tab.show()}else{L=new M(I,this.name);L.openInTab()}this.msgList=L;return true},activate:function(){p.removeClass($("fbu_"+v.activeId),"selected");p.removeClass($("fbu_ag"),"selected");v.activeId=this.id;p.addClass("fbu_"+v.activeId,"selected")},updateTitleAttr:function(){var J=$("fil_"+this.id),H=$("fbu_"+this.id),K=this.unread||0,I=this.incoming||0,M=K+I,L=B;if(J){if(M>0){J.innerHTML="(<span>"+M+"</span>)";L=L-(3+String(M).length)}else{J.innerHTML=""}J.style.display=""}H.title=this.name+" ("+M+"/"+(this.read+M)+")"},updateView:function(){var H=$("fbu_"+this.id),I=B,J,K;if(this.overrideNameSize){I=this.overrideNameSize}if(this.unread||this.incoming){I=I-(3+String(this.incoming+this.unread).length)}if(H.firstChild.nodeType==3){J=H.firstChild}else{if(H.firstChild.nextSibling.nodeType==3){J=H.firstChild.nextSibling}else{J=H.firstChild.nextSibling.nextSibling}}J.nodeValue=b.truncateString(this.name,I);this.updateTitleAttr();H.style.display="";if(this.id===g||this.id===l){if(this.unread+this.read+this.incoming>0){K=$("clean_"+this.id);K.style.display=""}}},doRemove:function(H){var L=f.MessageList,J=this,K=this.id,I=this.parentId;f.Network.ajax({url:J.deleteActionUrl+K+",fpid,"+I,onSuccess:function(R,O){var Q,T,U,P,N,S;R=f.Network.parseResponse(R);if(R.status){Q=$("fli_"+K);T=Q.parentNode.parentNode;U=T.relatedFolder;Q.parentNode.removeChild(Q);if(K==v.activeId){L.mainList.reset({folder:1});L.mainList.tab.setTitle(E("Odebrane"));v.getById(1).activate()}L.getListsOfFolder(K).forEach(function(W){W.tab.close()});if(U){for(S=0;S<U.subfolders.length;S++){if(J.id==U.subfolders[S].id){U.subfolders.splice(S,1)}}if(U.subfolders.length==0){P=p.elmsByClass("side-plusminus",T)[0];if(P){var V=document.createElement("span");V.className="folder-icon";P.parentNode.replaceNode(V,P)}N=$("ful_"+U.id);if(N){N.parentNode.removeChild(N)}}}for(S=0;S<v.list;S++){if(J.id==v.list[S].id){v.list.splice(S,1)}}Inpl.Mail.MessageList.instances.forEach(function(W){if(W.folder===g){W.refresh()}})}else{m.showNotice(R.msg)}if(H){H()}var M=$("ful_my");if(!M.childNodes.length){$("dirArr").style.display="none";p.addClass(M,"hide")}}})},remove:function(K,I){var H=this.doRemove.bind(this),J;if(K){H(I)}else{if(this.parentId===d||this.parentId===k){J=E("Usunięcie folderu „%1” spowoduje wyłączenie filtra i przeniesienie wiadomości do kosza. Czy jesteś pewien?")}else{if(this.subfolders&&this.subfolders.length){J=E("Folder „%1” zawiera podfoldery, które również zostaną usunięte. Czy na pewno chcesz usunąć folder z całą jego zawartością?")}else{J=E("Czy chcesz usunąć folder „%1” i przenieść jego zawartość do kosza?")}}m.ModalDialogs.confirm({message:Gettext.strargs(J,b.truncateString(this.name,40)),acceptLabel:E("Tak"),cancelLabel:E("Nie"),onAccept:function(){H(I)}})}},showSubfolderCreatePrompt:function(){$("addDir-parent").value=this.id;v.showCreateFolderForm()},rename:function(H){if(H===this.name){return}H=encodeURIComponent(H);var I=encodeURIComponent(this.name),L=this.id,J=this;f.Network.ajax({url:J.editActionUrl+L+"?name="+H+"&oname="+I,onSuccess:function K(N,P){N=f.Network.parseResponse(N);var M=$("fld-rename-form"),O=N.data;if(M.parentNode&&M.parentNode.removeChild){M.parentNode.removeChild(M)}if(O){J.name=b.decodeEntities(O.name)}J.updateView();if(N.status){if(O.id==v.activeId){f.MessageList.currentList.tab.setTitle(J.name)}m.showNotice(E("Nazwa folderu została zmieniona"),"success")}else{if(N.msg){m.showNotice(N.msg,"error")}else{m.showNotice(E("Nazwa folderu nie została zmieniona"),"error")}}}})},purge:function(M){var I=this.id,K=this,L,H;v.hideRenameBox();if(I==g){L="/html/emptytrash";H=E("Czy usunąć nieodwracalnie całą zawartość Kosza?")}else{if(I==l){L="/html/emptyspam";H=E("Czy usunąć nieodwracalnie całą zawartość folderu Spam?")}else{L=K.removeActionUrl+I+",uid,"+f.env.uid;H=u.strargs(E("Czy na pewno przenieść całą zawartość folderu „%1” do Kosza?"),K.name)}}function J(){function N(S,T){var R,O,U,P=f.MessageList.mainList,Q={folder:1,sort:P.sort,sorder:P.sorder};S=f.Network.parseResponse(S);if(S.status){if(v.activeId==I&&(I==g||I==l)){P.reset(Q);P.tab.setTitle(E("Odebrane"));P.tab.show()}else{if(v.activeId==I){U=f.Folders.getById(g);U.incoming+=K.incoming;U.unread+=K.unread;U.read+=K.read;U.updateTitleAttr();f.FolderCache.invalidateFolder(I);P.refresh()}}K.read=K.unread=K.incoming=0;if(I==g||I==l){R=$("fil_"+I);O=R.getElementsByTagName("span");if(O[0]){R.style.display="none";O[0].innerHTML=0}}m.showNotice(I==g?E("Kosz został opróżniony"):E("Usunięto wiadomości z folderu ")+K.name,"success");K.updateView();K.needsRefresh=true;f.Folders.markAllVFoldersToRefresh();if(v.getById(f.MessageList.currentList.folder) instanceof t){f.MessageList.currentList.refresh()}$("clean_"+I).style.display="none";if(I==g&&v.popTrashBarShown){m.hideNotificationBar()}}else{m.showNotice(u.strargs(E("Błąd %1:",S.code))+" "+S.msg,"error")}}f.Network.ajax({url:L,onSuccess:N})}if(M){J()}else{m.ModalDialogs.confirm({message:H,onAccept:J,acceptLabel:E("Tak"),cancelLabel:E("Nie")})}},readAll:function(){var H=this.id,I=this;function J(K,L){f.FolderCache.invalidateFolder(H);if(v.activeId==H){f.MessageList.mainList.refresh()}I.read+=I.unread;I.unread=0;m.showNotice(E("Wszystkie wiadomości z folderu zostały oznaczone jako przeczytane"));I.updateView();I.needsRefresh=true}f.Network.ajax({url:I.readAllActionUrl+H+",uid,"+f.env.uid,onSuccess:J})},getFolderName:function(){var H=this;if(H.parentId){switch(H.parentId){case d:return"Społeczności";case k:return"Oferty";default:return"Inny folder widokowy"}}else{switch(H.id){case n:return"Kopie robocze";case l:return"Spam";case e:return"Wysłane";case g:return"Kosz";case y:return"Odebrane";default:return"Inny folder"}}},createHtmlLi:function(M){M=parseInt(M,10)||0;var H,N,L,J=B,K=this,I=K.name||"";if(this.overrideNameSize){J=this.overrideNameSize}if(this.unread||this.incoming){J=J-(3+String(this.incoming+this.unread).length)}if(!(this.subfolders&&this.subfolders.length)){L=[s("span",{className:"folder-icon"})]}else{L=[]}L.push(document.createTextNode(b.truncateString(I,J)));if(this.id!=n){L.push(s("span",{className:"il",id:"fil_"+this.id,innerHTML:this.unread+this.incoming>0?"(<span>"+(this.incoming+this.unread)+"</span>)":""}))}if(this.subfolders&&this.subfolders.length){L.unshift(s("span",{className:"side-plusminus",innerHTML:E("Zwiń/rozwiń"),title:E("Zwiń/rozwiń"),onclick:function(O){p.toggleClass(this.parentNode.parentNode,("reveal"));p.stopPropagation(O);return p.preventDefault(O)}}))}if(M){L.unshift(s("span",{className:"folder-tree-branch"}))}N=[s("a",{href:"#",id:"fbu_"+this.id,className:(this.id>g&&this.parentId!==d&&this.parentId!==k)?"user-folder":"",title:this.name+" ("+(this.unread+this.incoming)+"/"+(this.read+this.unread+this.incoming)+")",relatedFolder:this,childNodes:L})];if(this.id>g){N.push(s("span",{className:"ils",innerHTML:'<button title="'+E("Wyświetl opcje folderu")+'" class="folder-action fld-mv menu-activator"><span class=folder-action-icon></span><b>'+E("Opcje folderu")+"</b></button>"}))}H=s("li",{id:"fli_"+this.id,onmousedown:(function(O){return function(P){if(!P){P=event}if(P.altKey&&O>g){v.showRenameBox("fbu_"+O);return false}return true}}(this.id)),relatedFolder:this,childNodes:N});if(Inpl.Mail.browser.supports.dnd){m.DnD.makeDraggable(H.childNodes[0])}if(this.id<4){H.className="sysfld folder-a"}if(this.parentId===d||this.parentId===k){i=true}if(this.parentId===d){p.addClass(H,"so-folder view-folder");f.Views.updateBodyClass(f.Views.ViewTypes.SOCIAL,true)}else{if(this.parentId===k){p.addClass(H,"sh-folder view-folder");f.Views.updateBodyClass(f.Views.ViewTypes.SHOPPING,true)}}m.DnD.makeDropTarget(H.childNodes[0],function(Q){if(Q.relatedItem){_gaq.push(["b._trackEvent","Drag and drop","Przeniesienie wiadomości ("+f.MessageList.currentList.itemsCheckedVerbalCount()+") do folderu",K.getFolderName()]);b.hitGFK();var P=Q.relatedItem.folderId===l||f.Prefs.get("isQuickFiltersDisabled"),O=f.MessageList.currentList.getSelection(false);if(K.id===-2){f.MessageList.currentList.msgOperations("setSpam",{muteNotice:true})}else{f.MessageList.currentList.msgOperations("move",{folder:K,muteNotice:!P});if(!P&&!f.MessageList.currentList.isMailingInSelection(O)&&f.Folders.getById(f.MessageList.currentList.folder)&&!(f.Folders.getById(f.MessageList.currentList.folder).parentId===d||f.Folders.getById(f.MessageList.currentList.folder).parentId===k)){f.QuickFilters.showFilterPrompt(f.MessageList.currentList.getSenderFromSelection(O),K.id)}}}});H.className+=" folder-a fld-level"+M;H.setAttribute("data-level",M);if(this.subfolders){H.appendChild(r(this.subfolders,this.id,M+1))}return H}};function t(H){D.apply(this,[H])}t.prototype=new D();t.prototype.deleteActionUrl="/html/diropt,o,4,fid,";t.prototype.editActionUrl="/html/diropt,o,5,fid,";t.prototype.remove=function(I){var H=this.doRemove.bind(this);if(I){H()}else{m.ModalDialogs.confirm({message:Gettext.strargs(E("Czy na pewno chcesz usunąć folder wyszukiwania „%1”?"),b.truncateString(this.name,40)),acceptLabel:E("Tak"),cancelLabel:E("Nie"),onAccept:H})}};t.prototype.updateTitleAttr=function(){var H=$("fbu_"+this.id);H.title=this.name};t.prototype.open=function(){var I,J=f.MessageList,H=J.mainList;if(this.msgList&&this.msgList.htmlNodes){this.msgList.refresh();this.msgList.tab.show();return true}this.msgList=I=new J({folder:this.id,sort:H.sort,sorder:H.sorder,search:this.search},this.name);I.openInTab();I.tab;return true};t.prototype.createHtmlLi=function(I){var H,K,J=this.name||"";I=I||13;K=[s("a",{href:"#",id:"fbu_"+this.id,className:"user-folder virtual-folder",title:J,relatedFolder:this,childNodes:[document.createTextNode(J.length>I?b.truncateString(J,I):J),s("b",{className:"virtual-folder-icon"}),s("span",{className:"il",id:"fil_"+this.id,innerHTML:this.unread>0?"(<span>"+this.unread+"</span>)":""})]}),s("span",{className:"ils",innerHTML:'<button title="'+E("Wyświetl opcje folderu")+'" class="folder-action fld-mv menu-activator"><span class=folder-action-icon></span><b>'+E("Opcje folderu")+"</b></button>"})];H=s("li",{id:"fli_"+this.id,className:"folder-a fld-level0 virtual-folder-li",relatedFolder:this,onmousedown:(function(L){return function(M){if(!M){M=event}if(M.altKey&&L>g){v.showRenameBox("fbu_"+L);return false}return true}}(this.id)),childNodes:K});if(Inpl.Mail.browser.supports.dnd){f.UI.DnD.makeDraggable(H.childNodes[0])}return H};function r(I,M,L){L=L||0;var N=s("ul",{id:"ful_"+M}),K=[],J,H=Math.ceil(B-1.5*L);I.forEach(function(P){var O;if((P.id>g||P instanceof t)&&(P.parentId!==d&&P.parentId!==k)){P.overrideNameSize=H;O=P.createHtmlLi(L);if(/^Odzyskane \d{1,2}\/\d{1,2}\/\d{4}$/.test(P.name)){K.unshift(O)}else{N.appendChild(O)}}});for(J=0;J<K.length;J++){if(N.hasChildNodes()){N.insertBefore(K[J],N.firstChild)}else{N.appendChild(K[J])}}N.className=(N.childNodes.length===0||(M==="my"&&c==="dirArrU"))?"hide":"";return N}function o(L){var Q=s("ul",{className:"folders"}),K,M,R,P,S,H,J;function O(U){var T=v.getById(this.id.split("_")[1]);T.purge();p.preventDefault(U);_gaq.push(["b._trackEvent","Menu boczne",T.getFolderName(),"Opróżnij"]);f.Tools.hitGFK()}for(M=0;M<=4;M++){if(!L[M]){continue}L[M].overrideNameSize=x;R=L[M].createHtmlLi();Q.appendChild(R);if(L[M].id==g||L[M].id==l){P=s("button",{id:"clean_"+L[M].id,className:"cleanDir sideBtn",innerHTML:E("opróżnij")+"&nbsp;»",title:L[M].id===g?E("Usuń wszystkie wiadomości z Kosza"):E("Usuń wszystkie wiadomości ze Spamu")});A(P,"click",O);R.appendChild(P);if(L[M].read+L[M].unread===0){P.style.display="none"}else{P.style.display=""}}if(L[M].id==l){if(!f.Prefs.get("useSpamFilter")){P.style.display=P.previousSibling.lastChild.style.display="none";S=s("button",{id:"actSpam",className:"cleanDir sideBtn",innerHTML:E("włącz ochronę »"),title:E("Włącz ochronę antyspamową"),onclick:v.activateSpamProtection});R.appendChild(S)}}}var I;for(M=0;M<L.length;M++){if(!L[M]){continue}if(L[M+1]&&(L[M].parentId===k||L[M+1].parentId===d)){var N=L[M];L[M]=L[M+1];L[M+1]=N}if(L[M].parentId===d||L[M].parentId===k){L[M].overrideNameSize=x;R=L[M].createHtmlLi();Q.insertBefore(R,Q.firstChild.nextSibling)}}Q.appendChild(s("li",{id:"fli_ag",childNodes:[s("a",{id:"fbu_ag",innerHTML:'<span class="folder-icon"></span>'+E("Załączniki"),onclick:function(){Inpl.LoadableModules.require("Inpl.Mail.AttachmentGallery",function(){f.AttachmentGallery.show()});_gaq.push(["b._trackEvent","Menu boczne","Załączniki","Otwarcie"])}})]}));K=s("li",{id:"fli_my",innerHTML:'<a href="javascript:void(0)" accesskey=m id=fbu_my title="'+E("Wyświetl/ukryj listę folderów użytkownika")+'"><span class=folder-icon></span>'+E("Moje foldery")+" <span "+(L.length<=5?"style='display: none' ":"")+' id=dirArr class="'+c+'">&nbsp;&nbsp;</span></a><button id=addDir class=sideBtn title="'+E("Załóż nowy folder")+'">'+E("nowy")+'&nbsp;»</button> <form method=POST action=/ id=addDirDiv class=addDirDiv><input id=addDir-parent type=hidden value="0"><input id=dirName name=dirName><br><button type=submit id=addDirButton class=sideBtn><span>'+E("Utwórz")+"&nbsp;»</span></button><button id=remDir class=sideBtn><span>"+E("Anuluj")+"&nbsp;»</span></button></form>",childNodes:[r(L,"my")]});Q.appendChild(K);return Q}function q(I,H){v.contextMenu.show(H.parentNode.parentNode.firstChild,I,"side-ctx-menu",(H.offsetLeft+H.offsetWidth)+"px",(H.offsetTop-$("ful_my").scrollTop)+"px")}function F(I){I=I||event;var H=I.target||I.srcElement;if(H.nodeName.toLowerCase()==="button"){if(H.className.indexOf("folder-action")>=0){if(v.contextMenu.isShown&&v.contextMenu.contextNode===H.parentNode.parentNode.firstChild){v.contextMenu.hide()}else{q(I,H)}}return false}while(H!==v.foldersUl){if(H.relatedFolder){break}H=H.parentNode}if(H&&H.relatedFolder){p.preventDefault(I);H.relatedFolder.open(!I.ctrlKey&&!I.metaKey);v.hideRenameBox();_gaq.push(["b._trackEvent","Menu boczne",H.relatedFolder.getFolderName(),"Otwarcie"]);if(H.relatedFolder.getFolderName()=="Oferty"){b.hitIWA(["html","foldery","klik","oferty"])}else{if(H.relatedFolder.getFolderName()=="Społeczności"){b.hitIWA(["html","foldery","klik","spolecznosci"])}}}return false}function G(N,L){var J,H,K=null,I=null,M=null;for(J=0,H=L.length;J<H;J++){I=L[J];if(I.id==N){K=I;break}if(I.subfolders&&I.subfolders.length){M=G(N,I.subfolders);if(M instanceof D){K=M;break}}}return K}v={Folder:D,VirtualFolder:t,activeId:null,list:null,getById:function(H){return G(H,this.list)},retrieveAndMark:function(H){v.retrieve(function(){H.forEach(function(I){var J=v.getById(I);if(J){J.needsRefresh=true}})})},retrieve:function(K,J,H){var I=$("ful_my"),M=(I)?I.scrollTop:0;c=f.Prefs.get("folderViewDetailed")?"dirArrD":"dirArrU";function L(O){var T,P,Z,aa,U,Q,X;P=$("side-folders");while(P.hasChildNodes()){P.removeChild(P.firstChild)}Z=typeof O==="string"?f.Network.parseResponse(O):O;for(U=Z.length,T=0;T<U;T++){aa=Z[T];if(aa.hasOwnProperty("searchQuery")){aa.search=aa.searchQuery;delete aa.searchQuery;Z[T]=new t(aa)}else{Z[T]=new D(aa)}}if(!Z||!Z.length){f.UI.showNotice(E("Błąd połączenia. Trwa rozwiązywanie problemu."),"error",999999);return}v.list=Z;v.foldersUl=P.appendChild(o(Z));X=$("ful_my");if(!v.activeId){v.activeId=1}if(i&&(p.hasClass(document.body,"shv-enabled")||p.hasClass(document.body,"sov-enabled"))){if(f.Prefs.get("viewsBubbleCnt")>0||f.Prefs.get("viewsBubbleCnt")===null){v.switchMyFolders(true)}}A($("fbu_my"),"click",function(ab){p.preventDefault(ab);if(v.list.length<=5){this.blur();return}v.switchMyFolders()});function W(ac){var ab=ac.parentNode;return((p.hasClass(ab,"sh-folder")||p.hasClass(ac,"sh-folder"))&&p.hasClass(document.body,"shv-enabled"))||((p.hasClass(ab,"so-folder")||p.hasClass(ac,"so-folder"))&&p.hasClass(document.body,"sov-enabled"))}function N(ab){return !W(ab)}function Y(ab){return ab.id==="fbu_my"||ab.id==="fbu_ag"||p.hasClass(ab,"sysfld")||W(ab)}function S(ab){return p.hasClass(ab,"virtual-folder")||p.hasClass(ab,"virtual-folder-li")}function R(ab){return S(ab)||Y(ab)||W(ab)}function V(ab){return p.hasClass(ab,"sysfld")}v.contextMenu=new m.AttachableCtxMenu([{label:E("Otwórz w osobnej karcie…"),cmd:function(){this.contextNode.relatedFolder.open()},disabled:function(ab){return ab.id==="fbu_my"||ab.id==="fbu_ag"}},{separator:true,ommit:function(ab){Y(ab)&&!W(ab)}},{label:E("Zmień nazwę"),cmd:function(){v.showRenameBox("fbu_"+this.contextNode.relatedFolder.id)},ommit:Y},{label:E("Dodaj podfolder"),cmd:function(){this.contextNode.relatedFolder.showSubfolderCreatePrompt()},ommit:R},{label:E("Usuń"),cmd:function(){var ab=this.contextNode.relatedFolder;ab.remove(null,function(){if(ab.parentId===d){f.Views.updateBodyClass(f.Views.ViewTypes.SOCIAL,false)}else{if(ab.parentId===k){f.Views.updateBodyClass(f.Views.ViewTypes.SHOPPING,false)}}})},ommit:function(ab){return Y(ab)&&!W(ab)}},{label:E("Wyłącz filtr"),cmd:function(){f.Views.disableViewByParentId(this.contextNode.relatedFolder.parentId);_gaq.push(["b._trackEvent","Powiadomienia","Wyłącz filtr","z menu kontekstowego"])},ommit:N},{label:E("Zarządzaj listą powiadomień"),cmd:function(){f.Views.openNewsletterTab();_gaq.push(["b._trackEvent","Powiadomienia","Menu kontekstowe-zarządzaj listą powiadomień","klik"])},ommit:N},{separator:true,ommit:S},{label:E("Oznacz jako przeczytane"),cmd:function(){this.contextNode.relatedFolder.readAll()},ommit:S,disabled:function(ab){return ab.relatedFolder?!(ab.relatedFolder.incoming+ab.relatedFolder.unread):true}},{label:E("Usuń wszystkie wiadomości"),cmd:function(){this.contextNode.relatedFolder.purge();_gaq.push(["b._trackEvent","Usuń wszystkie wiadomości",this.contextNode.relatedFolder.getFolderName()])},ommit:S,disabled:function(ac){var ab=ac.relatedFolder;return ab?ab.unread+ab.incoming+ab.read===0:true}},{label:E("Przywróć maile skasowane przez POP3"),cmd:function(){f.Folders.restorePopMessages()},ommit:function(ac){var ab=ac.relatedFolder,ad=null;if(ac.relatedFolder&&ac.relatedFolder.hasOwnProperty("id")){ad=ac.relatedFolder.id}return ad!=3},disabled:function(){return !f.Folders.popTrashMsgCount}}],$("side-folders"),".folder-a","side-ctx-menu");v.contextMenu.afterHide=function(){Array.forEach(p.elmsByClass("side-ctx-menu-plug"),function(ab){ab.parentNode.removeChild(ab)})};A($("addDir"),"click",function(){v.showCreateFolderForm();_gaq.push(["b._trackEvent","Menu boczne","Moje foldery","Nowy - klik"])});A($("remDir"),"click",function(ab){$("addDirDiv").style.display="none";$("addDir").style.display="block";$("dirName").value="";v.hideRenameBox();p.preventDefault(ab)});A($("addDirDiv"),"submit",v.handleAddDirSubmit);v.getById(v.activeId).activate();if(M&&!p.hasClass(X,"hide")){X.scrollTop=M}A(X,"mouseover",function(ab){v.toggleFolderHoverEffects(ab,true)});A(X,"mouseout",function(ab){v.toggleFolderHoverEffects(ab,false)});if(typeof K==="function"){K()}}if(!J){f.Network.ajax({url:"/html/getfolders,auto,"+(H?1:0),onSuccess:L})}else{L(J)}},toggleFolderHoverEffects:function(H,J){var I=H.target||H.srcElement;while(I.className.indexOf("folder-a ")==-1){I=I.parentNode;if(I.className===undefined){return}}if(J){p.elmsByClass("ils",I)[0].style.visibility="visible";p.addClass(p.elmsByClass("user-folder",I)[0],"js-hover")}else{p.elmsByClass("ils",I)[0].style.visibility="hidden";p.removeClass(p.elmsByClass("user-folder",I)[0],"js-hover")}},createFolder:function(I,H){H=H||{};var J=H.parentFolder;f.Network.ajax({url:"/html/diropt,o,1?n="+encodeURIComponent(I)+(J?"&p="+J.id:""),onSuccess:function(M){var O,K,Q,P=0,N,L;M=f.Network.parseResponse(M);if(M.status&&M.data){m.showNotice(Gettext.strargs(E("Folder „%1” został dodany"),I),"success");O=new D({id:Number(M.data.id),name:I,read:0,unread:0,subfolders:false,system:false});if(J){Q=$("fli_"+J.id);P=parseInt(Q.getAttribute("data-level"),10)||0;J.subfolders=J.subfolders||[];J.subfolders.push(O);K=J.createHtmlLi(P);p.addClass(K,"reveal");Q.parentNode.replaceChild(K,Q)}else{v.list.push(O);K=O.createHtmlLi();$("ful_my").appendChild(K)}if(H.okCallback){H.okCallback(O)}}else{m.showNotice(M.msg,"error");if(H.failCallback){H.failCallback(O)}}}})},handleAddDirSubmit:function(I){var H=$("dirName"),J=H.value,L=parseInt($("addDir-parent").value,10),K;if(L){K=v.getById(L)}if(!J){m.showNotice(E("Brak nazwy folderu"),"error");H.focus();p.preventDefault(I);return false}v.createFolder(J,{parentFolder:K,okCallback:function(){H.value="";H.style.display="inline";$("dirArr").style.display="";$("ful_my").className="";$("addDirDiv").style.display="none";$("addDir").style.display="block";$("addDir-parent").value=0;v.hideRenameBox()}});p.preventDefault(I)},switchMyFolders:function(H){var I=$("ful_my");$("dirArr").style.display="";if(H===undefined){H=!!p.hasClass(I,"hide")}if(H){if(I.childNodes.length){p.removeClass(I,"hide");$("dirArr").className="dirArrD";c="dirArrD";_gaq.push(["b._trackEvent","Menu boczne","Moje foldery","Otwarcie"])}}else{p.addClass(I,"hide");$("dirArr").className="dirArrU";c="dirArrU";v.hideRenameBox()}f.Prefs.set("folderViewDetailed",H)},getSystemFolders:function(){return this.list.filter(function(H){return H.id<=g})},getUserFolders:function(){return this.list.filter(function(H){return H.id>g})},getVirtualFolders:function(){return this.list.filter(function(H){return H instanceof t})},markAllVFoldersToRefresh:function(){this.getVirtualFolders().forEach(function(H){H.needsRefresh=true})},chooseFolder:function(ae,aa,K,Q,J,ac){var X=[],R=v.activeId,P=v.list,T=s("div",{className:"overlay"}),Y,S,af,O,I,W,N=false,M,L,Z,H,V,ad;if(!Q){throw new Error("chooseFolder requires onAccept argument")}T.appendChild(s("h2",{innerHTML:ae}));T.appendChild(document.createTextNode(aa));T.appendChild(s("br"));function U(aj,al,ak){var ag,ai,ah;for(ai=0;ai<aj.length;ai++){ah=aj[ai];if(ah instanceof t){continue}if(ah.id!==R){ag={folder:ah,label:ah.name,indentLevel:al};if(ah.id>g){if(!ak){X[X.length]="-";ak=true}}else{ag.indentLevel=-1}ag.disabled=false;X[X.length]=ag;if(ah.subfolders){U(ah.subfolders,al+1,true)}}}}U(P,0);Y=s("select",{className:"folderchooser widerCreateQuickFilter",size:X.length>12?12:X.length,onchange:function(){if(L){if(Y.options[Y.selectedIndex].folder.id===l){I.style.display="none"}else{I.style.display="block";L.innerHTML="Zastosuj do wszystkich nowych wiadomości od tego nadawcy "}}}});S=s("div",{className:"overlayButtons toolbar"});af=s("button",{className:"moveMsg act",onclick:function(){if(Y.selectedIndex>-1&&typeof Y.options[Y.selectedIndex].className!=="folderchooser-separator"){Q(Y.options[Y.selectedIndex].folder);if(N){f.QuickFilters.filterOperation({folderMode:f.QuickFilters.FolderModes.EXISTING,sender:ac,folderId:Y.options[Y.selectedIndex].folder.id})}m.hideOverlay()}else{m.showNotice(E("Wybierz folder!"))}if(M){M.close()}},innerHTML:K});O=s("button",{className:"cancelBtn act",onclick:function(){m.hideOverlay();if(M){M.close()}return false},innerHTML:E("Anuluj")});function ab(){af.click()}X.forEach(function(ag){if(ag!=="-"){Y.appendChild(H=s("option",{folder:ag.folder,className:"folderchooser-folder folderchooser-fld-"+ag.indentLevel,title:ag.label,ondblclick:ab,childNodes:[document.createTextNode(ag.label)]}));if(ag.folder){if(ag.folder.parentId===d){ad=H}else{if(ag.folder.parentId===k){V=H}}}if(J&&(ag.folder.id==J)){Y.lastChild.disabled="disabled"}}else{Z=Y.appendChild(s("option",{disabled:"disabled",className:"folderchooser-separator",innerHTML:f.browser.gecko?" ":"————————————————————————————"}))}});if(ad&&Z.nextSibling&&Z.nextSibling!==ad){Y.insertBefore(ad,Z.nextSibling)}if(V&&Z.nextSibling&&Z.nextSibling!==V){Y.insertBefore(V,Z.nextSibling)}T.appendChild(Y);if(ac){I=s("label",{className:"createQuickFilter widerCreateQuickFilter",childNodes:[W=s("input",{type:"checkbox",id:"createQuickFilter",onchange:function(){N=p.elmById("createQuickFilter").checked}}),L=s("span",{innerHTML:u.strargs(E("Zastosuj do wszystkich nowych wiadomości od tego nadawcy "))})]});T.appendChild(I);f.PromotionQueue.insert(function(){f.promotions.bubble.quickFilters(W)},f.PromotionQueue.TYPE.BUBBLE)}S.appendChild(af);S.appendChild(O);T.appendChild(S);m.showOverlay(T)},showRenameBox:function(H){v.hideRenameBox();var O=H.substr(4),J=v.getById(O),N=$("fli_"+O),L=$(H),M,K,P;L.style.display="none";K=s("input",{name:"newName",className:"user-folder",value:J.name});K.onclick=function(Q){Q=Q||event;f.DOM.stopPropagation(Q)};M=s("form",{id:"fld-rename-form",name:"fR_"+O,method:"post",action:"#",childNodes:[K]});P=$("fbu_"+O);p.removeClass(P,"over");$("fil_"+O).style.display="none";function I(R){if(!R){R=event}var Q=J.name;if(Q!==K.value&&K.value.length>0){v.getById(O).rename(K.value)}else{if(K.value.length===0){m.showNotice(E("Nazwa folderu nie może być pusta!"),"error")}v.hideRenameBox()}p.preventDefault(R);C(M,"submit",I);C(K,"blur",I);return false}A(M,"submit",I);A(K,"blur",I);A(K,"keypress",function(Q){if(Q.keyCode===27){v.hideRenameBox()}});N.insertBefore(M,N.firstChild);K.focus()},hideRenameBox:function(){var H=$("fld-rename-form"),I;if(H){I=H.name.substr(3);$("fbu_"+I).style.display="block";$("fil_"+I).style.display="";H.parentNode.removeChild(H)}},showCreateFolderForm:function(H){if(H){p.preventDefault(H)}$("addDirDiv").style.display="block";$("addDir").style.display="none";v.hideRenameBox();$("dirName").focus()},activateSpamProtection:function(){function H(I){var K,L,J;I=f.Network.parseResponse(I);if(I.status){m.showNotice(E("Ochrona została włączona. Aby ją wyłączyć lub skonfigurować, przejdź do ustawień."),"info");K=$("actSpam");K.parentNode.removeChild(K);J=v.getById(l);if(J&&J.unread+J.incoming+J.read>0){L=$("clean_"+l);L.style.display=L.previousSibling.style.display="block"}}else{m.showNotice(E("Nie udało się aktywować ochrony przed spamem"),"error")}}f.Prefs.set("useSpamFilter",true,true,H)},checkForNew:function(){f.FolderCache.invalidateAll();a.ajax({isSilent:true,url:"/html/checknew",onSuccess:function(L){var J,I,H,K;L=f.Network.parseResponse(L);if(L.status){J=L.data;v.incomingCount=0;for(H in J){if(J.hasOwnProperty(H)){H=parseInt(H,10);if(J.hasOwnProperty(H)){if(z.indexOf(H)<0&&z.indexOf(String(H))<0){v.incomingCount+=J[H]}I=f.Folders.getById(H);K=J[H];if(I){I.needsRefresh=true}I.incoming=K;I.updateView();if(f.MessageList.currentList.folder===H){f.MessageList.currentList.refresh(undefined,I.incoming)}}}}if(v.incomingCount>0){m.showNotice(Gettext.strargs(u.ngettext("Pobrano %1 nową wiadomość","Pobrano %1 nowych wiadomości",v.incomingCount),v.incomingCount));v.incomingCount=0}else{m.showNotice(E("Brak nowych wiadomości"))}}else{m.showNotice(E("Błąd serwera podczas próby pobrania informacji o nowych wiadomościach"),"error")}}})},deactivate:function(){p.removeClass($("fbu_"+v.activeId),"selected");v.activeId=null},cleanUp:function(){function H(I){m.DnD.unmakeDropTarget(I);m.DnD.unmakeDraggable(I);I.relatedFolder=I.events=I.onmouseover=I.onmouseout=I.onclick=null}Array.forEach(v.foldersUl.getElementsByTagName("li"),H);Array.forEach(v.foldersUl.getElementsByTagName("a"),H)},msgNotifQueueListener:function(H){var I;try{I=v.getById(Number(H.folderId))}catch(J){}if(I){I.unread+=1;I.updateView()}},init:function(I){var H=$("msg-search-field");if(!f.browser.supports.placeholder){p.addPlaceholderSupport(H)}p.selectOnFocus(H);v.retrieve(null,I);A($("side-folders"),"click",F);A($("ful_my"),"scroll",v.contextMenu.hide.bind(v.contextMenu));f.MessageNotifQueue.addPushListener(this.msgNotifQueueListener)},showPopTrashBar:function(){var I=document.createDocumentFragment();v.popTrashBarShown=true;function H(){m.hideNotificationBar();v.popTrashBarShown=false}I.appendChild(s("button",{className:"notif-close",innerHTML:"<span>"+E("Zamknij")+"</span>",onclick:H}));I.appendChild(s("ul",{className:"notif-options notif-right",childNodes:[s("li",{childNodes:[s("a",{href:"#",innerHTML:E("Przywróć wiadomości z Kosza"),onclick:function(){f.Folders.restorePopMessages();H();return false}})]})]}));I.appendChild(s("p",{innerHTML:E('W konfiguracji klienta pocztowego (np. Outlook lub Thunderbird) nie zaznaczyłeś opcji "Pozostaw wiadomości na serwerze". Aby uchronić Cię przed przypadkową utratą maili, zamiast usuwać je definitywnie przenieśliśmy je do kosza.')}));I.appendChild(s("p",{childNodes:[s("input",{type:"checkbox",id:"dontShowPopTrashBar",onchange:function(){var J=p.elmById("dontShowPopTrashBar").checked;f.Prefs.set("dontShowPopTrashBar",(J?1:0))}}),s("label",{innerHTML:E("Nie informuj mnie więcej"),htmlFor:"dontShowPopTrashBar"})]}));m.showNotificationBar(I)},restorePopMessages:function(){f.Network.ajax({url:"/html/restorepopped",onSuccess:function(H){H=f.Network.parseResponse(H);if(H.status){f.Folders.popTrashMsgCount=0;f.FolderCache.invalidateAll();f.MessageList.refreshAll();v.retrieve();f.UI.showNotice(E("Przywrócono wiadomości usunięte przez POP3"))}else{f.UI.showNotice(E("Błąd podczas próby przywrócenia wiadomości usuniętych przez POP3: "+H.msg),"error")}}})},getOfferFolderId:function(){if(w!=false){return w}for(var H=0;H<Inpl.Mail.Folders.list.length;H++){if(Inpl.Mail.Folders.list[H].parentId==k){w=Inpl.Mail.Folders.list[H].id;return w}}return false},getSocialFolderId:function(){if(j!=false){return j}for(var H=0;H<Inpl.Mail.Folders.list.length;H++){if(Inpl.Mail.Folders.list[H].parentId==d){j=Inpl.Mail.Folders.list[H].id;return j}}return false},openShop:function(){Inpl.Mail.Folders.getById(this.getOfferFolderId()).open()}};return v}());(function(){var b=Inpl.Mail,e=b.DOM,c=b.Tools,a=e.createElement,k=function(m){return document.createTextNode(m)},h={};function l(m){var p=["content","buttonText","linkURL","onClick","viewGemius","clickGemius","id"],n=this;n.content="InfoBox dummy content";n.buttonText="Sprawdź";n.linkURL="http://info.poczta.interia.pl/";n.id=null;n.viewGemius=null;n.clickGemius=null;n.onClick=null;n.isViewGemiusSent=false,p.forEach(function(q){if(m.hasOwnProperty(q)){this[q]=m[q]}},n);if(n.onClick){try{n.onClick=new Function(n.onClick)}catch(o){n.onClick=null}}}function g(m){return m.replace(/@NEW@/g,"<span class=inplNewFeature></span>")}c.augment(l.prototype,{getLinkURL:function(){if(this.linkURL){if(this.clickGemius){return"http://interia.hit.gemius.pl/hitredir/id="+this.clickGemius+"/url="+this.linkURL}else{return this.linkURL}}else{return"#"}},show:function f(n){var m=a("a",{href:this.getLinkURL(),target:"_blank",id:"additionalNavLink",childNodes:[a("span",{className:"adNavLeft",innerHTML:g(this.content)}),a("span",{className:"adNavLinkButton",innerHTML:this.buttonText,childNodes:[a("span",{className:"adNavRaquo",innerHTML:" »"})]})]});if(this.onClick){m.onclick=(function(){this.onClick.apply(n||this);c.hitGemius(this.clickGemius);return false}).bind(this)}if(this.viewGemius&&!this.isViewGemiusSent){c.hitGemius(this.viewGemius);this.isViewGemiusSent=true}l.hide();$("navigation").appendChild(m)}});l.load=function j(n){var o,m;if(!Array.isArray(n)){return false}for(o=n.length;o--;){m=new l(n[o]);if(m.id in h){throw new Error("id already in use: "+m.id)}else{h[m.id]=m;Inpl.Ad.set(m.id,m)}}return true};l.showById=function i(n,m){Inpl.Ad.get(n,function(o){if(o){o.show(m)}})};l.hide=function d(){var m=$("additionalNavLink");if(m){m.parentNode.removeChild(m)}};b.InfoBox=l}());(function(){var c=[1],b=Inpl.Mail,d,a={};function e(){this.items=[];this.isValid=false;this.cachedDate=null}e.prototype={getItems:function(f){f(JSON.parse(this.items))},setItems:function(g,f){this.items=typeof g==="string"?g:JSON.stringify(g);this.isValid=true;this.cachedDate=new Date();if(typeof f==="function"){f()}},invalidate:function(){this.isValid=false}};c.forEach(function(f){a[f]=new e(f)});d={items:a,invalidateAll:function(){Object.keys(a).forEach(function(f){a[f].invalidate()})},invalidateFolder:function(g){var f=this.get(parseInt(g,10));if(f){f.invalidate()}},get:function(f){return a[f]||null}};b.FolderCache=d}());(function(){var f="/html/getmails",s="ch",i=-100,e=-101,h=Inpl.Mail,l=h.UI,q=l.ModalDialogs,p=h.DOM,r=p.createElement,v=p.addEvent,w=p.removeEvent,c=h.Tools,k=h.Folders,a=h.Message,b=h.Thread,A=h.ContactList,y=0,t=new Gettext({domain:"inpl_mail_msglist",locale_data:h.L10n}),x=function(B){return t.gettext(B)},m={u:x("Nieprzeczytane"),r:x("Przeczytane"),a:x("Z załącznikami"),ph:x("Priorytet wysoki"),pn:x("Priorytet normalny"),pl:x("Priorytet niski"),fg:x("Flaga zielona"),fr:x("Flaga czerwona"),fb:x("Flaga niebieska"),f0:x("Bez flagi")};function o(){var B="";if(location.hash.indexOf("#inpltesterad")===0){B=location.hash}return h.env.accountType===0?location.protocol+"//"+location.host+"/mailads"+B:"about:blank"}function n(B){return B.relatedItem instanceof b}function u(B){return B.relatedItem instanceof a}function d(B){return B.filter(function(C){return C.parentThread}).map(function(C){return C.parentThread.id})}function j(C){var B;if(C.parentThread){B=C.parentThread}else{if(C.type==="thread"){B=C}}return B}function g(E,B){var C={f:{label:"Od",asc:"od A do Z",desc:"od Z do A"},t:{label:"Do",asc:"od A do Z",desc:"od Z do A"},s:{label:"Temat",asc:"od A do Z",desc:"od Z do A"},a:{label:"Data",asc:"od najstarszych",desc:"od najnowszych"},l:{label:"Rozmiar",asc:"rosnąco",desc:"malejąco"},x:{label:"Flaga",asc:"do flagi",desc:"od flagi"}},D=C[E];if(D){_gaq.push(["b._trackEvent","Sortowanie wiadomości",D.label,D[B]])}}function z(D,B,E){var C;y+=1;this.id=y;this.name=B||x("(bez nazwy)");this.items=null;this.tab=null;this.isPreviewShown=true;this.isPermanent=!!E;this.folder=null;this.sort="a";this.sorder="desc";this.page=1;this.search=null;this.searchf=null;this.filter=null;this.isThreaded=Inpl.Mail.Prefs.get("threadedView")||0;for(C in D){if(D.hasOwnProperty(C)){this[C]=D[C]}}if(!this.items&&this.list){this.items=this.list}this.pager=new h.UI.Pager({currentPage:-1,pagesCount:-1,onPageChange:(function(F){this.page=F;this.refresh(true)}).bind(this),containerElement:null});this.meta=null;this.htmlNodes={};z.instances.push(this)}Inpl.Mail.MessageList=z;z.instances=[];z.prototype={msgListHeight:"230px",cleanUp:function(){if(this.items){this.items.forEach(function(B){if(B.relatedNode){B.relatedNode.relatedItem=null;h.UI.DnD.unmakeDraggable(B.relatedNode)}B.relatedNode=null})}},destroy:function(){var C,B=h.Folders.getById(this.folder);if(this.htmlNodes.mailFrame&&this.htmlNodes.mailFrame.message){try{delete this.htmlNodes.mailFrame.message}catch(D){}}if(B&&B.hasOwnProperty("msgList")){delete B.msgList}this.cleanUp();for(C in this){if(this.hasOwnProperty(C)){delete this[C]}}z.instances.splice(z.instances.indexOf(this),1);return null},showDefaultContent:function(){var C=this.htmlNodes,E=C.mailHeaderDiv,D=C.mailFooterDiv,B=C.mailFrame;B.messageId=null;B.src=o();B.style.height="220px";D.innerHTML=E.innerHTML="";p.addClass(E,"hide");p.addClass(D,"hide");c.hideBottomAd()},isCachable:function(){var B=this.getQueryPostData()===null;if([1].indexOf(parseInt(this.folder,10))>=-1&&this.sort==="a"&&this.sorder==="desc"&&this.page===1&&!this.filter){return true}return false},isSingleMessageInSelection:function(){var B=this.getSelection(false);return !B.threads.length&&B.messages.length===1},getQueryPostData:function(){if(this.search){return{search:this.search}}else{if(this.searchf){return{searchf:this.searchf}}else{return null}}},getQueryUrl:function(){var B=f,C,D=Inpl.Mail.MessageList.mainList.getActiveRows();["folder","sort","sorder","filter","thread"].forEach(function(E){if(this[E]!==null&&this[E]!==undefined){B+=","+E+","+encodeURIComponent(this[E])}},this);if(h.Prefs.get("threadedView")){B+=",type,thread"}else{B+=",type,list"}if(this.isOrderChanged&&D.length===1){C=D[0].relatedItem;if(C instanceof h.Message){if(this.isThreaded){B+=",thid,"+C.threadId}else{B+=",mid,"+C.id}}else{B+=",thid,"+C.id}delete this.isOrderChanged}else{B+=",page,"+this.page}return B},getMessageById:function(F){var D,B,E;function C(G){return G.id===F}E=this.items.filter(C)[0];if(!E&&h.Prefs.get("threadedView")){D=this.items.filter(n);for(B=0;B<D.length;B+=1){E=D[B].list.filter(C);if(E.length){E=E[0];break}}}return E},processResults:function(D,B){var E=this,F=D.data,G,C;if(!D.status){if(D.msg){l.showNotice(D.msg,"error")}else{l.showNotice(x("Nie udało się pobrać listy wiadomości: serwer zwrócił pustą odpowiedź"),"error")}return}C=E.items=F.items||F.list;G=E.meta={all:F.all,unread:F.unread,pack:F.pack,size:F.size};if(typeof F.pack==="number"){E.page=G.pack;if(E.pager&&E.pager.containerElement){E.pager.currentPage=E.page}}C.forEach(function(J,I,H){if(J.type==="thread"){J.folderId=E.folder;H[I]=new b(J)}else{H[I]=new a(J)}});if(typeof B==="function"){B()}},isMailingInSelection:function(B){return B.messages.length===1&&B.threads.length===0&&B.messages[0].isMailing},isOnlyMailingInSelection:function(C){var B,D=C.messages,E=D.length;if(C.threads.length===0&&D.length>0){for(B=0;B<E;B++){if(!D[B].isMailing){return false}}}else{return false}return true},showRemoveMailingNotice:function(){var B=800;h.Network.ajax({url:"/next/infoBoard",post:{id:B,isTrigger:1,cacheTime:Date.now()},onSuccess:function(C){C=JSON.parse(C);if(C&&C.data&&C.data.id){_gaq.push(["b._trackEvent","plansza_bez_reklam","wyswietlenie planszy","html_USUN"]);var D=q.createModalDialog({title:x("Wyłącz reklamy na stałe"),message:x("Dzięki wiadomościom reklamowym od Interii, Twoja poczta jest darmowa.<br/>Nie chcesz reklam - dowiedz się jak je wyłączyć."),onCancel:function(){_gaq.push(["b._trackEvent","plansza_bez_reklam","klik - ANULUJ","html_USUN"]);return true},onBeforeAccept:function(){_gaq.push(["b._trackEvent","plansza_bez_reklam","klik - OK","html_USUN"]);window.location.href="https://ustawienia.interia.pl/poczta/bez-reklam#iwa_source=plansza_bez_reklam";return true},acceptLabel:"Wyłącz reklamy",cancelLabel:"Nie, dziękuję",hideIcons:true},q.prototypes.richConfirmationDialog);D.enqueue();h.Network.ajax({url:"/html/infoBoard",post:{id:B,state:1,svalue:1},onSuccess:function(){},headers:{"X-HTTP-Method-Override":"PUT","X-XSRF-TOKEN":h.env.uid}})}},headers:{"X-HTTP-Method-Override":"GET","X-XSRF-TOKEN":h.env.uid}})},showSpamMailingNotice:function(){var B=801;h.Network.ajax({url:"/next/infoBoard",post:{id:B,isTrigger:1,cacheTime:Date.now()},onSuccess:function(C){C=JSON.parse(C);if(C&&C.data&&C.data.id){_gaq.push(["b._trackEvent","plansza_bez_reklam","wyswietlenie planszy","html_SPAM"]);var D=q.createModalDialog({title:x("Zablokuj reklamy na stałe"),message:x("Dzięki reklamom od Interii, Twoja poczta jest darmowa.<br/>Możesz jednak uniknąć reklam - skorzytaj z Poczty Premium."),onCancel:function(){_gaq.push(["b._trackEvent","plansza_bez_reklam","klik - ANULUJ","html_SPAM"]);return true},onBeforeAccept:function(){_gaq.push(["b._trackEvent","plansza_bez_reklam","klik - OK","html_SPAM"]);window.location.href="https://ustawienia.interia.pl/poczta/bez-reklam#iwa_source=plansza_bez_reklam";return true},acceptLabel:"Zablokuj reklamy",cancelLabel:"Nie blokuj reklam",hideIcons:true},q.prototypes.richConfirmationDialog);D.enqueue();h.Network.ajax({url:"/html/infoBoard",post:{id:B,state:1,svalue:1},onSuccess:function(){},headers:{"X-HTTP-Method-Override":"PUT","X-XSRF-TOKEN":h.env.uid}})}},headers:{"X-HTTP-Method-Override":"GET","X-XSRF-TOKEN":h.env.uid}})},isRemoveMailingNoticeEnabled:function(C){var B,D=this;B=h.env.accountType===0&&!h.Prefs.get("mailingSpamNoticeDisabled")&&D.isOnlyMailingInSelection(C);return B},showMailingBlockNotice:function(){var B=q.createModalDialog({title:x("Nie można dodać adresu do listy zablokowanych nadawców"),message:x("Jeśli nie chcesz otrzymywać reklam od INTERIA.PL, aktywuj <b>Pocztę bez reklam</b> już dziś - tylko <b>1zł</b> miesięcznie!"),onCancel:function(){return true},onBeforeAccept:function(){window.location.href="https://ustawienia.interia.pl/poczta/bez-reklam";return true},acceptLabel:'Aktywuj "Pocztę bez reklam"',cancelLabel:"Anuluj"},q.prototypes.richConfirmationDialog);B.show()},fetch:function(B){var G=this,F=this.getQueryUrl(),D=this.getQueryPostData(),C=G.folder,E=h.FolderCache.get(this.folder);try{G.deactivateAllItems(true)}catch(H){}function I(J){G.cleanUp();G.processResults(J,B);return true}if(E&&this.isCachable()&&E.isValid){E.getItems(I)}else{h.Network.ajax({url:F,post:D,onSuccess:function(K){if(C!==G.folder){return false}var J=h.Network.parseResponse(K);if(E&&G.isCachable()){E.setItems(K)}return I(J)},timeout:60000,onError:function(){l.showNotice(x("Operacja nie może zostać wykonana z powodów technicznych. Prosimy o ponowienie próby za kilka minut."),"error",undefined,2)},onTimeout:function(){l.showNotice(x("Operacja nie została wykonana z powodu obciążenia systemu. Prosimy o ponowienie próby za kilka minut."),"error",undefined,2)}})}return true},changeOrder:function(E){var D="asc",C="desc",H=this.htmlNodes,G={f:H.msgListHeaderNameA,t:H.msgListHeaderNameA,s:H.msgListHeaderSubjectA,a:H.msgListHeaderDateA,l:H.msgListHeaderSizeA},F=this.sort,B=this.sorder;E=E||F;h.FolderCache.invalidateFolder(this.folder);this.isOrderChanged=true;if(this.folder===2&&E==="f"){E="t"}if(F===E){this.sorder=B===D?C:D}else{this.sorder=(E==="a"||E==="x")?C:D;this.sort=E}Object.keys(G).forEach(function(I){G[I].className=""});if(G[E]!==undefined){G[E].className="selected "+this.sorder}if(this.getActiveRows().length!==1){this.page=1}g(this.sort,this.sorder);this.refresh();return false},openInTab:function(F,C){var E=this;function D(){E.createTab(F);if(typeof C==="function"){C()}}if(E.prefetched&&E.prefetched.status!==undefined){var B=h.FolderCache.get(this.folder);if(B){B.setItems(E.prefetched)}E.processResults(E.prefetched,D);delete E.prefetched}else{E.fetch(D)}},getTabClass:function(){return"mailList msglist-fld_"+this.folder},createTab:function(C){var ab=this,af=typeof window.innerHeight!=="undefined"?window.innerHeight:document.documentElement.offsetHeight,aj=25,V=Inpl.Mail.Tools.getCookie("inpl_mail_list_height"),ak,X,al,E,R,B=null,am,ae,F,Z,D,S,Q,aa,ac,ag,ao,W,ai,T,P,ad,an,L,ah,G,N,J,K=[],M=h.Prefs.get("previewShown"),Y="clear";if(this.tab){this.tab.close()}if(V){V=parseInt(V,10)}else{if(af-750>0){V=Math.floor((af-520)/aj)*aj}else{V=8*aj}}D=r("a",{className:"thread-mode-switcher",href:"#",onclick:function(){ab.switchThreadMode();if(h.Prefs.get("threadedView")){h.Tools.hitGemius(h.Tools.getGemiusByAlias("MSGLIST","ENABLE_THREADING"))}else{h.Tools.hitGemius(h.Tools.getGemiusByAlias("MSGLIST","DISABLE_THREADING"))}return false},innerHTML:h.Prefs.get("threadedView")?x("wyłącz"):x("włącz"),title:h.Prefs.get("threadedView")?x("Wyłącz wątkowanie"):x("Włącz wątkowanie")});am=r("a",{href:"#",onclick:function(){ab.switchPreview();return false},innerHTML:x("wyłącz"),title:x("Wyłącz podgląd wiadomości")});J=x("Podgląd wiadomości:");if(J==="Podgląd wiadomości:"){J="Podgląd:"}ae=r("div",{className:"msgListSub msgListSub-right",childNodes:[r("span",{innerHTML:J+"&nbsp;"}),am]});if(Inpl.Mail.env.allowThreads&&!this.search&&!this.searchf){K=[r("span",{className:"thread-mode-switcher",innerHTML:x("Wątkowanie:")+"&nbsp;"}),D]}if(this.search&&!this.folder){S=r("a",{href:"#",onclick:function(){ab.saveAsFolder();h.Tools.hitGemius(h.Tools.getGemiusByAlias("MSGLIST","SAVE_AS_SEARCH_FOLDER"));return false},innerHTML:x("Zapisz jako folder wyszukiwania"),title:x("Zapisz listę wiadomości jako folder wyszukiwania")});K=S}Q=r("div",{className:"msgListSub msgListSub-left",childNodes:K});F=r("div",{className:"slideCr",innerHTML:"<div></div>"});Z=r("div",{className:"packs-container"});an=r("table",{className:"mTable",id:"mailsTable_"+this.id,childNodes:[r("tbody",{id:"mailsTbBody_"+this.id})]});aa=r("div",{className:"mails-container",id:"mailsTbContainer_"+this.id,childNodes:[an]});function U(at){at=at||event;var ap,ar=at.target||at.srcElement,aq=ar.nodeName.toLowerCase();while(!p.hasClass(ar,"mTable")&&!p.hasClass(ar,"mails-container")){aq=ar.nodeName.toLowerCase();if(aq==="td"&&p.hasClass(ar,"msglist-check")){ar.getElementsByTagName("input")[0].click();break}if(aq==="td"&&(p.hasClass(ar,"check")||p.hasClass(ar,"msglist-flag"))){break}if(aq==="tr"){if(B===ar){return false}if(ar.relatedItem){ar.relatedItem.onMsgListRowClick(ab,at)}if(ab.pulledDownThread&&ar.relatedItem instanceof a&&!ar.relatedItem.parentThread){ap=ab.getMessageById(ab.pulledDownThread);ap.pullUp(ab,null,true)}break}ar=ar.parentNode}return false}function I(ar){ar=ar||event;var aq=ar.target||ar.srcElement,ap=aq.nodeName.toLowerCase();function at(){B=null}while(!p.hasClass(aq,"mTable")&&!p.hasClass(aq,"mails-container")){ap=aq.nodeName.toLowerCase();if(ap==="td"&&(p.hasClass(aq,"check")||p.hasClass(aq,"msglist-flag"))){break}if(ap==="tr"){if(B===aq){return false}aq.relatedItem.onMsgListRowDblClick();B=aq;setTimeout(at,1500);break}aq=aq.parentNode}}v(aa,"click",function(ap){var aq=h.browser.ie;if(aq&&aq<=8){ap={target:event.target,srcElement:event.srcElement,shiftKey:event.shiftKey,ctrlKey:event.ctrlKey}}if(Y==="clear"){Y=setTimeout(function(){Y="clear";U(ap)},150)}});v(aa,"dblclick",function(ap){clearTimeout(Y);Y="clear";I(ap)});ag=r("iframe",{name:"mail-frame-"+this.id,id:"mail-frame-"+this.id});c.prepareFrameCheck(ag);ag.className="mail-frame";ag.frameBorder=0;ag.src=o();G=r("div",{className:"mails-headerscontainer hide"});N=r("div",{className:"hide"});ao=r("div",{className:"mails-framecontainer",childNodes:[G,ag,N]});L=r("a",{href:"#",innerHTML:"<span>"+x("Data")+"</span><i></i>",title:x("Posortuj wiadomości po dacie"),className:"selected",onclick:ab.changeOrder.bind(ab,"a")});ah=r("a",{href:"#",innerHTML:"<span>"+x("Rozmiar")+"</span><i></i>",title:x("Posortuj wiadomości po rozmiarze"),onclick:ab.changeOrder.bind(ab,"l")});ac=r("a",{className:"filter-chooser",href:"#",innerHTML:"<b></b>",title:x("Filtruj wiadomości")});ac.onclick=function(){ab.chooseFilter(this);return false};W=r("div",{className:"msglist-header",childNodes:[r("div",{className:"floatedColumnHeader",childNodes:[r("div",{className:"msglist-head-date",childNodes:[L]}),r("div",{className:"msglist-head-size",childNodes:[ah]}),r("div",{className:"filter-chooser-container",childNodes:[ac]})]})]});T=r("input",{id:"checkAll_"+ab.id,type:"checkbox",title:x("Zaznacz/odznacz wszystkie"),onclick:function(){ab.checkAll(this)}});W.appendChild(r("div",{className:"msglist-head-check",childNodes:[T]}));ai=r("a",{href:"#",innerHTML:"<b class='filter-icon filter-icon-fb'>&nbsp;</b>",title:x("Posortuj wiadomości wg flag"),onclick:ab.changeOrder.bind(ab,"x")});W.appendChild(r("div",{className:"msglist-head-flag",childNodes:[ai]}));P=r("a",{href:"#",innerHTML:"<span>"+((this.search===null&&this.searchf===null)?((ab.folder===2||ab.folder===-1)?x("Do"):x("Od")):x("Od/Do"))+"</span><i></i>",title:x("Posortuj wiadomości alfabetycznie"),onclick:ab.changeOrder.bind(ab,"f")});W.appendChild(r("div",{className:"msglist-head-from",childNodes:[P]}));ad=r("a",{href:"#",innerHTML:"<span>"+x("Temat")+"</span><i></i>",title:x("Posortuj wiadomości alfabetycznie"),onclick:ab.changeOrder.bind(ab,"s")});W.appendChild(r("div",{className:"msglist-head-subject",childNodes:[ad]}));al=r("div",{id:"outMails_"+this.id,className:"outMails",childNodes:[W,aa,Z,Q,ae,F,ao]});function O(){var ap=h.Folders.getById(ab.folder);if(ab.needsRefresh||(ap&&ap.needsRefresh)){ab.refresh()}z.currentList=ab;if(ab.search||ab.searchf){k.deactivate()}else{k.getById(ab.folder).activate()}ab.updateToolbars();ab.updateWinTitle();try{X=ab.htmlNodes.mailFrame.contentWindow.location.href}catch(aq){X=""}if(ab.isPreviewShown&&ab.htmlNodes&&ab.htmlNodes.mailFrame&&X!==o()){h.Tools.showBottomAd()}}function H(){w(aa,"click",U);w(aa,"dblclick",I);ab=ab.destroy()}ak=new h.Tabs.Tab(this.name,r("div",{id:"msglist_"+this.id,className:this.getTabClass(),childNodes:[al]}),O,H,{isPermanent:C});ak.msgList=ab;ak.onBeforeHide=function(){h.Tools.hideBottomAd();return true};ak.show();G.id="emHead_"+ak.id;N.id="emFoot_"+ak.id;R=Inpl.Mail.Tools.getCookie("inpl_mail_list_height");if(!R){(function(){try{var ap=l.Theme.currentTheme.id==="g"?30:20;E=Math.max(150,document.documentElement.clientHeight-(h.DOM.findPos(W)[1]+W.offsetHeight+Z.offsetHeight+F.offsetHeight+ag.offsetHeight+$("bottIco").offsetHeight+$("bottomContent").offsetHeight+$("footer").offsetHeight+ap))}catch(aq){E=150}}())}else{E=R}aa.style.height=E+"px";if(this.search||this.searchf){p.addClass(ak.headerElement,"searchResults");p.addClass(ak.bodyElement,"searchResults");p.addClass(ak.bodyElement,"msglist-head-wider-cols")}else{if(this.thread){p.addClass(ak.headerElement,"threadList");p.addClass(ak.bodyElement,"threadList");p.addClass(ak.bodyElement,"msglist-head-wider-cols")}}l.makeResizer(F,aa,ao,true,null,null,"inpl_mail_list_height");this.htmlNodes={threadSwitcherA:D,previewSwitcherA:am,msgListSubRight:ae,saveAsFolderA:S,msgListSubLeft:Q,sliderDiv:F,packsDiv:Z,packsDivInner:Z.appendChild(r("div",{className:"packs"})),mailsTable:an,mailsTbDiv:aa,mailFrame:ag,mailFrameDiv:ao,msgListHeaderDiv:W,msgListHeaderFlagA:ai,msgListHeaderNameA:P,msgListHeaderSubjectA:ad,msgListHeaderDateA:L,msgListHeaderSizeA:ah,msgListHeaderCheckAll:T,mailHeaderDiv:G,mailFooterDiv:N};if(!M){am.innerHTML=x("włącz");am.title=x("Włącz podgląd wiadomości");ao.style.display="none";F.style.display="none";aa.style.height="auto";aa.style.minHeight=this.msgListHeight;p.addClass(aa,"mails-container-full");p.addClass(W,"msglist-header-full")}this.isPreviewShown=M;this.updateView();this.tab=ak;return ak},reset:function(C){var B;this.folder=null;this.sort="a";this.sorder="desc";this.page=1;this.search=null;this.searchf=null;this.filter=null;this.meta=null;this.pulledDownThread=null;for(B in C){if(C.hasOwnProperty(B)){this[B]=C[B]}}this.refresh(true)},chooseFilter:function(D){var G=this,C=["-","u","r","-","a","-","ph","pn","pl","-","fg","fr","fb","f0"],E=[];function F(J){var H={u:"Nieprzeczytane",r:"Przeczytane",a:"Z załącznikami",ph:"Priorytet wysoki",pn:"Priorytet normalny",pl:"Priorytet niski",fg:"Flaga zielona",fr:"Flaga czerwona",fb:"Flaga niebieska",f0:"Bez flagi"},I=H[J]||"wszystkie",K;_gaq.push(["b._trackEvent","Filtrowanie wiadomości",I]);K=c.escapeDiacritics(I.replace(" ","_"));if(h.Folders.getOfferFolderId()==G.folder){c.hitIWA(["html","oferty","-","filtrowanie",K])}else{if(h.Folders.getSocialFolderId()==G.folder){c.hitIWA(["html","spolecznosci","-","filtrowanie",K])}}}function B(H){return function(){G.filter=H;G.page=1;G.refresh(true);var I=G.tab.headerElement.getElementsByTagName("span")[0],J=I.getElementsByTagName("b")[0];if(H){if(!J){J=r("b");I.appendChild(J)}J.title=m[H];J.className="filter-icon filter-icon-"+H}else{if(J){I.removeChild(J)}}F(H)}}E=[{label:x("Wszystkie"),cmd:B(null),disabled:!this.filter,className:"filter-none",beforeContent:r("b",{innerHTML:"&bull; ",className:"filter-icon filter-icon-none"})}];C.forEach(function(H){if(H==="-"){E.push("-")}else{E.push({label:m[H],cmd:B(H),disabled:this.filter===H,className:"filter-"+H,beforeContent:r("b",{className:"filter-icon filter-icon-"+H})})}});(new h.UI.PopupMenu(E,"filter-menu")).show(D)},updateWinTitle:function(){var B=h.Folders.getById(this.folder);if(B&&!this.search&&!this.searchf){h.UI.WindowTitle.setText(B.name+(B.unread?" ("+B.unread+")":""))}},updateToolbars:function(){var J=this.getSelection(),L,F=J.messages.length+J.threads.length,M,I=this,H,E,D=this.folder===-1,K=this.folder===-2,B=!I.search&&!I.searchf,G=F>1,C;M=h.Prefs.get("threadedView")&&J.messages.some(function(N){return !!N.parentThread});if(I.thread&&!J.messages.length){L={threads:[I.thread],messages:[]}}else{if(M){L={threads:[J.messages[0].parentThread],messages:[]}}}if(!D){H=[{ident:"responseT",label:x("Odpowiedz"),title:x("Odpowiedz nadawcy"),cmd:function(){I.msgOperations("res");_gaq.push(["b._trackEvent","Lista wiadomości",this.id.indexOf("_nav1")!==-1?"górne buttony":"dolne buttony","Odpowiedz"]);if(h.env.accountType!==0){_gaq.push(["b._trackEvent","Lista wiadomości",this.id.indexOf("_nav1")!==-1?"górne buttony":"dolne buttony","Odpowiedz (konto płatne)"])}if(h.Folders.getOfferFolderId()==I.folder){c.hitIWA(["html","oferty","-","odpowiedz","-"])}else{if(h.Folders.getSocialFolderId()==I.folder){c.hitIWA(["html","spolecznosci","-","odpowiedz","-"])}}},disabled:G||J.threads.length>0},{ident:"responseAllT",label:x("Odp. wszystkim"),title:x("Odpowiedz wszystkim"),cmd:function(){I.msgOperations("resAll");_gaq.push(["b._trackEvent","Lista wiadomości",this.id.indexOf("_nav1")!==-1?"górne buttony":"dolne buttony","Odp. wszystkim"]);if(h.env.accountType!==0){_gaq.push(["b._trackEvent","Lista wiadomości",this.id.indexOf("_nav1")!==-1?"górne buttony":"dolne buttony","Odp. wszystkim (konto płatne)"])}},disabled:G||J.threads.length>0},{ident:"forwardT",label:x("Prześlij dalej"),title:x("Prześlij dalej"),cmd:function(){I.msgOperations("forw");_gaq.push(["b._trackEvent","Lista wiadomości",this.id.indexOf("_nav1")!==-1?"górne buttony":"dolne buttony","Prześlij dalej"]);if(h.env.accountType!==0){_gaq.push(["b._trackEvent","Lista wiadomości",this.id.indexOf("_nav1")!==-1?"górne buttony":"dolne buttony","Prześlij dalej (konto płatne)"])}}},"|",{ident:"moveMsg",label:x("Przenieś"),title:x("Przenieś wiadomości"),cmd:function(){h.Folders.chooseFolder(x("Przenieś wybrane wiadomości"),x("Przenieś wiadomości do folderu:"),x("Przenieś"),function(O){if(O.id===-2){I.msgOperations("setSpam",{muteNotice:true});var P=false;var Q=false;for(var N=0;N<J.messages.length;N++){if(J.messages[N].fUnsubscribable){P=true}if(J.messages[N].isMailing){Q=true}}if(P){I.msgOperations("unsubscribe","",J)}if(Q){I.showSpamMailingNotice()}}else{if(O.id===3){var Q=false;for(var N=0;N<J.messages.length;N++){if(J.messages[N].isMailing){Q=true}}if(Q){I.showRemoveMailingNotice()}}I.msgOperations("move",{folder:O})}},B&&I.folder,(h.Folders.getById(I.folder)&&I.isSingleMessageInSelection()&&!I.isMailingInSelection(I.getSelection(false))?I.getSenderFromSelection(I.getSelection(false)):null));_gaq.push(["b._trackEvent","Lista wiadomości",this.id.indexOf("_nav1")!==-1?"górne buttony":"dolne buttony","Przenieś"]);if(h.env.accountType!==0){_gaq.push(["b._trackEvent","Lista wiadomości",this.id.indexOf("_nav1")!==-1?"górne buttony":"dolne buttony","Przenieś (konto płatne)"])}c.hitGFK()}},{ident:"removeBtn",label:x("Usuń"),title:x("Usuń wiadomości"),cmd:function(){var N=I.isRemoveMailingNoticeEnabled(J);I.msgOperations("delete",{muteNotice:N});if(!K&&N){I.showRemoveMailingNotice()}_gaq.push(["b._trackEvent","Lista wiadomości",this.id.indexOf("_nav1")!==-1?"górne buttony":"dolne buttony","Usuń ("+I.itemsCheckedVerbalCount()+")"]);if(h.env.accountType!==0){_gaq.push(["b._trackEvent","Lista wiadomości",this.id.indexOf("_nav1")!==-1?"górne buttony":"dolne buttony","Usuń ("+I.itemsCheckedVerbalCount()+") (konto płatne)"])}c.hitGFK();var O="pojedynczy_mail";if(I.selectionCount()>1){var O="wszystkie_zaz"}if(h.Folders.getOfferFolderId()==I.folder){c.hitIWA(["html","oferty","-","przenies",O,"kosz"])}else{if(h.Folders.getSocialFolderId()==I.folder){c.hitIWA(["html","spolecznosci","-","przenies",O,"kosz"])}}}},{ident:K?"noSpamT":"spamT",label:K?x("To nie jest spam"):x("Uznaj za spam"),title:K?x("Oznacz jako pożądana"):x("Przenieś wiadomość do Spamu"),cmd:function(){var S=I.getSenderFromSelection(I.getSelection(false)),R=I.isRemoveMailingNoticeEnabled(J),N=!!S&&!h.QuickFilters.DISABLE_FOR_MOVING_TO_SPAM&&!h.Prefs.get("isQuickFiltersDisabled")&&!R;var Q=false;var T=false;for(var O=0;O<J.messages.length;O++){if(J.messages[O].isOffer||J.messages[O].isVoucher){J.messages.splice(O,1);O--;Q=true}if(J.messages[O]&&J.messages[O].fUnsubscribable){T=true}}if(Q){var P=r("div",{className:"notice--offerSpamInfo",childNodes:[r("span",{innerHTML:"Ta wiadomość nie jest spamem.<br>Możesz wyłączyć folder Oferty w "}),r("a",{innerHTML:"Ustawieniach",href:"https://ustawienia.interia.pl/poczta/filtry",target:"_blank"})]});h.UI.showNotice(P,"error",5000,true)}if(!K){I.msgOperations("setSpam",{muteNotice:R||N},J);if(R){I.showSpamMailingNotice()}}else{I.msgOperations("notSpam",{muteNotice:N})}if(N){h.QuickFilters.showFilterPrompt(S,K?1:-2)}if(T&&!K){I.msgOperations("unsubscribe","",J)}_gaq.push(["b._trackEvent","Lista wiadomości",this.id.indexOf("_nav1")!==-1?"górne buttony":"dolne buttony","Uznaj za spam"]);if(h.env.accountType!==0){_gaq.push(["b._trackEvent","Lista wiadomości",this.id.indexOf("_nav1")!==-1?"górne buttony":"dolne buttony","Uznaj za spam (konto płatne)"])}var U="pojedynczy_mail";if(I.selectionCount()>1){var U="wszystkie_zaz"}if(h.Folders.getOfferFolderId()==I.folder){c.hitIWA(["html","oferty","-","przenies",U,"spam"])}else{if(h.Folders.getSocialFolderId()==I.folder){c.hitIWA(["html","spolecznosci","-","przenies",U,"spam"])}}c.hitGFK()}},"|",{ident:"printBtn",label:x("Drukuj"),title:x("Drukuj wiadomość"),cmd:function(){I.msgOperations("print");_gaq.push(["b._trackEvent","Lista wiadomości",this.id.indexOf("_nav1")!==-1?"górne buttony":"dolne buttony","Drukuj"]);if(h.env.accountType!==0){_gaq.push(["b._trackEvent","Lista wiadomości",this.id.indexOf("_nav1")!==-1?"górne buttony":"dolne buttony","Drukuj (konto płatne)"])}},disabled:G}]}else{H=[{ident:"editT",label:x("Edytuj"),cmd:I.msgOperations.bind(I,"edit")},{ident:"moveMsg",label:x("Przenieś"),cmd:function(){h.Folders.chooseFolder(x("Przenieś wybrane wiadomości"),x("Przenieś wiadomości do folderu:"),x("Przenieś"),function(N){if(N.id===-2){I.msgOperations("setSpam",{muteNotice:true})}else{I.msgOperations("move",{folder:N})}},B&&I.folder,I.isSingleMessageInSelection()&&!I.isMailingInSelection(I.getSelection(false))?I.getSenderFromSelection(I.getSelection(false)):null)}},{ident:"removeBtn",label:x("Usuń"),cmd:I.msgOperations.bind(I,"delete")},"|",{ident:"printBtn",label:x("Drukuj"),cmd:I.msgOperations.bind(I,"print")}]}E=H.map(function(N){if(N==="|"){return"|"}else{return{ident:N.ident,label:N.label,disabled:true}}});if(this.isPreviewShown&&this.htmlNodes&&this.htmlNodes.mailFrame){C=this.htmlNodes.mailFrame.contentDocument?this.htmlNodes.mailFrame.contentDocument.location:this.htmlNodes.mailFrame.contentWindow.location}if(!this.tab||this.tab.id===h.Tabs.activeId){h.InfoBox.showById("msglist");if(F>0){l.injectButtons(H,"nav1");l.injectButtons(H,"bottIco")}else{l.injectButtons(E,"nav1");l.injectButtons(null,"bottIco")}}},getCheckboxClickHandler:function(){var B=this;return function C(F){F=F||event;var E=this.parentNode.parentNode,D=E.relatedItem;h.DOM.stopPropagation(F);if(this.checked){B.activate(E,false);if(D.onMsgListCheckboxChecked){D.onMsgListCheckboxChecked(B)}}else{B.deactivate(E);if(D.onMsgListCheckboxUnchecked){D.onMsgListCheckboxUnchecked(B)}}}},getMsgItemsDragHandler:function(){var B=this;if(!B.msgItemsDragHandler){B.msgItemsDragHandler=function(){var C,D,E=B.getActiveRows();if(E.length&&E.indexOf(this)>=0){C=E.map(function(F){return F.cloneNode(true)})}else{B.deactivateAllItems();B.activate(this,true);C=[this.cloneNode(true)]}D=r("table",{id:"dnd",className:"mTable",childNodes:[r("tbody",{childNodes:C})],style:{width:(B.htmlNodes.mailsTable.offsetWidth||600)+"px"}});return D}}return B.msgItemsDragHandler},selectionCount:function(){var C=this,B=C.getSelection();return B.messages.length+B.threads.length},updateView:function(B,N){B=!!B;var V=this,S,X,ak,ag,R=this.items,ac,M=function(ao){var an;if(ao.relatedItem.type==="thread"){an=ao.relatedItem}else{if(ao.relatedItem.parentThread){an=ao.relatedItem.parentThread}}if(!an){return true}return !an.attachments},K=this.folder===-1,J=!K,P=this.folder===-2,W=!P,L=this.folder===2,G=this.getCheckboxClickHandler(),C=Inpl.Mail.Prefs.get("useSpamFilter"),ah=h.Folders.getById(this.folder),D=this.htmlNodes.mailsTbDiv.parentNode,T,af,al=Number(this.folder),U,E=Math.round(new Date().getTime()/1000),ae=h.Prefs.get("view100"),ad=h.Prefs.get("view101"),Q=false,am=false,ab;if(ae!==null){Q=ae+86400<E}if(ad!==null){am=ad+86400<E}function H(ao){var an;if(ao.relatedItem.type==="thread"){an=ao.relatedItem}else{if(ao.relatedItem.parentThread){an=ao.relatedItem.parentThread}}return !an}function aa(an){return an.relatedItem.type==="thread"}function Z(){var an=V.getActiveRows();if(an){return h.Blacklist.checkEmail(an[0].relatedItem.fromEmail)}return false}if(this.search||this.searchf||this.thread){K=function(an){return an.relatedItem.folderId===-1};J=function(an){return an.relatedItem.folderId!==-1};P=function(an){return an.relatedItem.folderId===-2};W=function(an){return an.relatedItem.folderId!==-2};L=function(an){return an.relatedItem.folderId===2}}if(!this.search&&!this.searchf&&!this.filter&&!this.thread){ah.all=this.meta.all-this.meta.unread;ah.unread=this.meta.unread;ah.incoming=0;ah.updateView()}this.htmlNodes.msgListHeaderNameA.innerHTML="<span>"+((this.search===null&&this.searchf===null)?((V.folder===2||V.folder===-1)?x("Do"):x("Od")):x("Od / Do"))+"</span><i></i>";if(!this.htmlNodes.mailsTable){return false}S=r("table",{className:"mTable",id:"mailsTable_"+this.id});X=r("tbody",{id:"mailsTbBody_"+this.id});if(R.length){for(ag=0;ag<R.length;ag+=1){if(R[ag]){ak=R[ag].createMsgListTableRow(ag,this,"",!!V.search||!!V.searchf||!!V.thread,G);if(ag===R.length-1){p.addClass(ak,"last")}if(ag===0){p.addClass(ak,"first")}R[ag].relatedNode=ak;l.DnD.makeDraggable(ak,this.getMsgItemsDragHandler());X.appendChild(ak)}}this.htmlNodes.msgListHeaderCheckAll.disabled=false}else{if(this.page>1&&R.length===0){this.page-=1;this.refresh(true)}else{if(this.searchf){ac=x("Brak korespondencji z tym kontaktem")}else{if(this.search){ac=x("Nie znaleziono wyników pasujących do zapytania.")}else{ac=x("Folder nie zawiera żadnych wiadomości")}}if(this.search){if(this.search.indexOf("mail:")===0){ac+=" "+x("Zmodyfikuj wyszukiwaną frazę.")}else{ac=[ac," ",r("a",{innerHTML:x("Przeszukaj dodatkowo treść wiadomości"),href:"#",onclick:this.refreshDetailedSearch.bind(this)})]}}X.appendChild(r("tr",{childNodes:[r("td",{className:"mailTableMessage",childNodes:ac})]}));this.htmlNodes.msgListHeaderCheckAll.disabled=true}}S.appendChild(X);this.updatePacks();this.htmlNodes.mailsTable.parentNode.replaceChild(S,this.htmlNodes.mailsTable);this.htmlNodes.mailsTable=S;if(p.hasClass(D.childNodes[1],"msglist-notice")){Array.forEach(p.elmsByClass("msglist-notice",D),function(an){D.removeChild(an)})}if(ah&&(ah.parentId||ah.parentId===0)){if(ah.parentId===e){af=h.promotions.message_list_stripe.social();h.PromotionQueue.insert(af,h.PromotionQueue.TYPE.MESSAGE_LIST_STRIPE)}else{if(ah.id===1&&h.env.migrateNextPromotionStripeVisible){if(h.env.accountType===0){ab=h.promotions.message_list_stripe.move_to_premium();_gaq.push(["b._trackEvent","html_zolta_belka","wyswietlenie","posprzataj_poczte"])}else{ab=h.promotions.message_list_stripe.next_promotion()}h.PromotionQueue.insert(ab,h.PromotionQueue.TYPE.MESSAGE_LIST_STRIPE,h.PromotionQueue.PRIORITY.HIGH)}}}if((al===-2&&h.Prefs.get("useSpamFilter"))||(al===3&&(h.env.accountType===0))){T=h.promotions.message_list_stripe.spam(al);h.PromotionQueue.insert(T,h.PromotionQueue.TYPE.MESSAGE_LIST_STRIPE)}if(this.search&&(this.search.indexOf("mail:")!==0)&&R.length){af=h.promotions.message_list_stripe.search(this.refreshDetailedSearch.bind(this));h.PromotionQueue.insert(af,h.PromotionQueue.TYPE.MESSAGE_LIST_STRIPE)}var Y=h.PromotionQueue.extract(h.PromotionQueue.TYPE.MESSAGE_LIST_STRIPE);if(typeof Y!=="function"){D.insertBefore(Y,this.htmlNodes.mailsTbDiv)}function aj(){return V.getActiveRows().length>1}function O(){var ao=V.getActiveRows();for(var an=0;an<ao.length;an++){if(h.DOM.hasClass(ao[an],s)){return false}}return true}function I(){var ao=V.getActiveRows();for(var an=0;an<ao.length;an++){if(!h.DOM.hasClass(ao[an],s)){return false}}return true}function ai(){return h.Folders.getById(V.folder)&&(h.Folders.getById(V.folder).parentId===e||h.Folders.getById(V.folder).parentId===i)}this.contextMenu=new l.CtxMenu([{label:x("Otwórz w nowej karcie…"),cmd:function(){V.msgOperations("open",this);_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Otwórz w nowej karcie"]);if(h.env.accountType!==0){_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Otwórz w nowej karcie (konto płatne)"])}}},"-",{label:x("Odpowiedz…"),cmd:function(){V.msgOperations("res",this);_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Odpowiedz"]);if(h.env.accountType!==0){_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Odpowiedz (konto płatne)"])}if(h.Folders.getOfferFolderId()==V.folder){c.hitIWA(["html","oferty","-","odpowiedz","-"])}else{if((h.Folders.getSocialFolderId()==V.folder)){c.hitIWA(["html","spolecznosci","-","odpowiedz","-"])}}},ommit:K,disabled:[aj,aa]},{label:x("Odpowiedz wszystkim…"),cmd:function(){V.msgOperations("resAll",this);_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Odpowiedz wszystkim"]);if(h.env.accountType!==0){_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Odpowiedz wszystkim (konto płatne)"])}},ommit:K,disabled:[aj,aa]},{label:x("Prześlij dalej…"),cmd:function(){V.msgOperations("forw",this);_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Prześlij dalej"]);if(h.env.accountType!==0){_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Prześlij dalej (konto płatne)"])}},ommit:K},{label:x("Edytuj…"),cmd:function(){V.msgOperations("edit",this)},ommit:J},{separator:true,ommit:K},{label:x("Usuń"),cmd:function(){var an=V.isRemoveMailingNoticeEnabled(V.getSelection(false));if(an){V.msgOperations("delete",{muteNotice:an});V.showRemoveMailingNotice()}else{V.msgOperations("delete")}_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Usuń ("+V.itemsCheckedVerbalCount()+")"]);if(h.env.accountType!==0){_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Usuń ("+V.itemsCheckedVerbalCount()+") (konto płatne)"])}}},{label:x("To nie jest spam"),cmd:function(){V.msgOperations("notSpam")},ommit:W,disabled:!C},{label:x("Uznaj za spam"),cmd:function(){var aq=V.getSelection(false),au=V.getSenderFromSelection(aq),at=V.isRemoveMailingNoticeEnabled(aq),an=!!au&&!h.QuickFilters.DISABLE_FOR_MOVING_TO_SPAM&&!h.Prefs.get("isQuickFiltersDisabled")&&!at;var ar=false;for(var ao=0;ao<aq.messages.length;ao++){if(aq.messages[ao].isOffer||aq.messages[ao].isVoucher){aq.messages.splice(ao,1);ao--;ar=true}}if(ar){var ap=r("div",{className:"notice--offerSpamInfo",childNodes:[r("span",{innerHTML:"Ta wiadomość nie jest spamem.<br>Możesz wyłączyć folder Oferty w "}),r("a",{innerHTML:"Ustawieniach",href:"https://ustawienia.interia.pl/poczta/filtry",target:"_blank"})]});h.UI.showNotice(ap,"error",5000,true)}V.msgOperations("setSpam",{muteNotice:at||an},aq);if(at){V.showSpamMailingNotice()}if(an){h.QuickFilters.showFilterPrompt(au,-2)}_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Uznaj za spam"]);if(h.env.accountType!==0){_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Uznaj za spam (konto płatne)"])}},ommit:[P,K,L],disabled:!C},{label:x("Przenieś…"),cmd:function(){h.Folders.chooseFolder(x("Przenieś wybrane wiadomości"),x("Przenieś wiadomości do folderu:"),x("Przenieś"),function(an){if(an.id===-2){V.msgOperations("setSpam",{muteNotice:true})}else{V.msgOperations("move",{folder:an})}},(!V.search&&!V.searchf)&&V.folder,(V.isSingleMessageInSelection()&&!V.isMailingInSelection(V.getSelection(false))?V.getSelection(false).messages[0].fromEmail:null));_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Przenieś"]);if(h.env.accountType!==0){_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Przenieś (konto płatne)"])}}},{label:x("Porządkuj…"),cmd:function(){h.QuickFilters.showCustomFilterPrompt(V.getSelection().messages[0].fromEmail,function(){var ao=p.elmsByClass("msg-cnt-quickfilter",""),an;for(an=0;an<ao.length;an++){ao[an].innerHTML="<span></span><b>"+x("Usuń filtr")+"</b>"}},function(an){V.msgOperations("move",{folder:an})});_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Porządkuj"]);if(h.env.accountType!==0){_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Porządkuj (konto płatne)"])}},ommit:[L,K,P,aj,aa,function(){return !!h.QuickFilters.getFilterNumber(V.getSelection(false).messages[0].fromEmail)||V.getSelection(false).messages[0].isMailing}]},{label:x("Usuń filtr…"),cmd:function(){h.QuickFilters.showDeleteFilterPrompt(V.getSelection().messages[0].fromEmail,function(){var ao=p.elmsByClass("msg-cnt-quickfilter",""),an;for(an=0;an<ao.length;an++){ao[an].innerHTML="<span></span><b>"+x("Porządkuj")+"</b>"}});_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Usuń filtr"]);if(h.env.accountType!==0){_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Usuń filtr (konto płatne)"])}},ommit:[L,K,aj,aa,ai,function(){return !h.QuickFilters.getFilterNumber(V.getSelection(false).messages[0].fromEmail)||V.getSelection(false).messages[0].isMailing}]},{separator:true,ommit:[L,K]},{label:x("Oznacz jako przeczytaną"),cmd:function(){V.msgOperations("setRead");_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Oznacz jako przeczytaną"]);if(h.env.accountType!==0){_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Oznacz jako przeczytaną (konto płatne)"])}var an="pojedynczy_mail";if(V.selectionCount()>1){an="wszystkie_zaz"}if(h.Folders.getOfferFolderId()==V.folder){c.hitIWA(["html","oferty","-","oznacz_przeczytane",an])}else{if(h.Folders.getSocialFolderId()==V.folder){c.hitIWA(["html","spolecznosci","-","oznacz_przeczytane",an])}}},disabled:function(an){if(aj()){return O()}return !h.DOM.hasClass(an,s)},ommit:[L,K]},{label:x("Oznacz jako nieprzeczytaną"),cmd:function(){V.msgOperations("setUnread");_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Oznacz jako nieprzeczytaną"]);if(h.env.accountType!==0){_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Oznacz jako nieprzeczytaną (konto płatne)"])}var an="pojedynczy_mail";if(V.selectionCount()>1){an="wszystkie_zaz"}if(h.Folders.getOfferFolderId()==V.folder){c.hitIWA(["html","oferty","-","oznacz_nieprzeczytane",an])}else{if(h.Folders.getSocialFolderId()==V.folder){c.hitIWA(["html","spolecznosci","-","oznacz_nieprzeczytane",an])}}},disabled:function(an){if(aj()){return I()}return h.DOM.hasClass(an,s)},ommit:[L,K]},{separator:true,ommit:[L,K]},{label:x("Dodaj do kontaktów"),cmd:function(){V.msgOperations("add2Cnt");_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Dodaj do kontaktów"]);if(h.env.accountType!==0){_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Dodaj do kontaktów (konto płatne)"])}},ommit:[L,K],disabled:[aj,aa]},{label:x("Odblokuj nadawcę"),cmd:function(){V.msgOperations("removeFromBlacklist");_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Odblokuj nadawcę"]);if(h.env.accountType!==0){_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Odblokuj nadawcę (konto płatne)"])}},ommit:function(){var an;if(L||K){return true}else{an=V.getActiveRows();if(an){return !h.Blacklist.checkEmail(an[0].relatedItem.fromEmail)}return false}},disabled:[aj,aa]},{label:x("Zablokuj nadawcę"),cmd:function(){if(V.isMailingInSelection(V.getSelection(false))&&h.env.accountType===0){V.showMailingBlockNotice()}else{V.msgOperations("blacklist")}_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Zablokuj nadawcę"]);if(h.env.accountType!==0){_gaq.push(["b._trackEvent","Menu kontekstowe","Lista maili","Zablokuj nadawcę (konto płatne)"])}},ommit:[L,K,Z],disabled:[aj,aa]},{separator:true,ommit:H},{label:x("Zapisz wszystkie załączniki z wątku"),cmd:function(){var an=j(this.contextNode.relatedItem);if(an||V.thread){h.Thread.prototype.saveAllAttachments.call(an||{id:V.thread,subject:V.tab.title})}},ommit:H,disabled:M}],S,"tr");this.contextMenu.beforeShow=function(ao){var an=ao.target||ao.srcElement;if(an.nodeName.toLowerCase()!=="tr"){while(an!==document.body){an=an.parentNode;if(an.relatedItem){break}}}if(an.relatedItem&&!p.hasClass(an,"active")){V.activate(an,true)}};this.htmlNodes.mailsTbDiv.scrollTop=0;if(this.tab){if(this.filter){p.addClass(this.tab.headerElement,"searchResults");p.addClass(this.tab.bodyElement,"searchResults")}else{if(!this.search&&!this.searchf){p.removeClass(this.tab.headerElement,"searchResults");p.removeClass(this.tab.bodyElement,"searchResults")}}this.tab.bodyElement.firstChild.className=this.getTabClass()}if(h.browser.ie&&Math.abs(X.offsetWidth-S.offsetWidth)>20){S.style.display="none";setTimeout(function(){S.style.display=""},50)}if(V.lastScrollPos){V.htmlNodes.mailsTbDiv.scrollTop=V.lastScrollPos+(N||0)*V.items[0].relatedNode.offsetHeight;delete V.lastScrollPos}if(!B){V.setSelection(V.recentSelection);if(V.recentSelection){if(V.recentSelection.messages.length||V.recentSelection.threads.length){var F=this.getMessageById(V.recentSelection.messages[0]||V.recentSelection.threads[0]);if(F){this.htmlNodes.mailsTbDiv.scrollTop=F.relatedNode.offsetTop}}}delete V.recentSelection}else{V.htmlNodes.mailsTbDiv.scrollTop=0}return true},refreshDetailedSearch:function(){var B=this,C=B.search.split(":")[0];if(["from","all","to","cc","bcc","subject","body","header","size","after","after"].indexOf(C)>=0){B.search=B.search.replace(C+":","mail:")}else{B.search="mail:"+B.search}B.refresh();return false},updatePacks:function(){var B=this.pager;B.containerElement=this.htmlNodes.packsDivInner;B.pagesCount=Math.ceil(this.meta.all/this.meta.size);B.currentPage=this.page;this.pager.render();return},activate:function(C,B){if(B){this.deactivateAllItems(true)}p.addClass(C,"active");C.firstChild.firstChild.checked=true;this.prevActivated=C;if(this.getActiveRows().length!==1){this.showDefaultContent()}this.updateToolbars()},deactivate:function(D,B,C){p.removeClass(D,"active");D.firstChild.firstChild.checked=false;if(this.getActiveRows().length!==1&&!C){this.showDefaultContent()}if(!B){this.updateToolbars()}},isAllItemsChecked:function(){return p.nodeListToArray(this.htmlNodes.mailsTable.getElementsByTagName("tr")).every(function(B){return B.firstChild.firstChild.checked})},isSomeItemsChecked:function(){var B=0;return Array.some(this.htmlNodes.mailsTable.getElementsByTagName("tr"),function(C){if(C.firstChild.firstChild.checked&&++B>1){return true}else{return false}})},isAnyItemsChecked:function(){return Array.some(this.htmlNodes.mailsTable.getElementsByTagName("tr"),function(B){return B.firstChild.firstChild.checked})},itemsCheckedVerbalCount:function(){if(this.isAllItemsChecked()){return"wszystkie"}else{if(this.isSomeItemsChecked()){return"kilka"}else{if(this.isAnyItemsChecked()){return"pojedyncza"}else{return"brak"}}}},activateAllItems:function(){Array.forEach(this.htmlNodes.mailsTable.getElementsByTagName("tr"),function(B){p.addClass(B,"active");B.firstChild.firstChild.checked=true});this.updateToolbars()},deactivateAllItems:function(B){this.htmlNodes.msgListHeaderCheckAll.checked=false;this.getActiveRows().forEach(function(C){p.removeClass(C,"active");C.firstChild.firstChild.checked=false});this.prevActivated=null;if(!B){this.updateToolbars()}},activateMultiple:function(D){var E,F,B,C=this.prevActivated;if(!C){this.activate(D,true);return}this.deactivateAllItems();if(C.inpl_index<D.inpl_index){F=C;B=D}else{F=D;B=C}E=F;this.activate(E);do{E=E.nextSibling;this.activate(E,false)}while(E!==B)},checkAll:function(B){if(B.checked){this.activateAllItems()}else{this.deactivateAllItems()}},refresh:function(E,B){var C=h.Folders.getById(this.folder),D=this;if(C&&C.needsRefresh){delete C.needsRefresh}if(this.needsRefresh){this.needsRefresh=false}if(!E){D.recentSelection=D.getSelection(true)}D.lastScrollPos=this.htmlNodes.mailsTbDiv.scrollTop;D.fetch(function(){var G,H,F;D.updateView(E,B);scrollTo(0,0);D.updateWinTitle();if(window.opera){H=D.htmlNodes.mailsTable.style;H.display="none";setTimeout(function(){H.display=""},10)}G=D.getSelection();if(G.messages.length+G.threads.length===0){D.showDefaultContent()}if(D.pulledDownThread){F=D.getMessageById(D.pulledDownThread);if(F&&F instanceof h.Thread){F.pullDown(D,F.relatedNode)}}});D.updateToolbars()},saveAsFolder:function(){var C=this,D=false,B=this.search;h.Folders.list.forEach(function(E){if(E.name==B){D=true}});if(!D){h.Network.ajax({url:"savesearch?terms="+encodeURIComponent(this.search),onSuccess:function(F){F=Inpl.Mail.Network.parseResponse(F);if(F&&F.status){var E=new h.Folders.VirtualFolder({id:"v"+F.data.vid,name:F.data.name,search:C.search});h.Folders.list.push(E);$("ful_my").appendChild(E.createHtmlLi());h.Folders.switchMyFolders(true);h.UI.showNotice(t.strargs(x('Zapisano folder wyszukiwania "%1"'),[F.data.name]))}else{h.UI.showNotice(F.msg,"error")}}})}else{h.UI.showNotice(t.strargs(x('Nie udało się zapisać folderu wyszukiwania - folder "%1" już istnieje'),[B]),"error")}},getActiveRows:function(){var B=this.htmlNodes.mailsTable;return B?p.nodeListToArray(p.elmsByClass("active",B)):[]},getSelection:function(C){var G=[],F=[],H=this.getActiveRows();function B(I){return I.relatedItem}function E(I){return I.id}function D(I){return !(F.some(function(J){return J.list.indexOf(I)>=0}))}if(H.length){F=H.filter(n).map(B);G=H.filter(u).map(B);G=G.filter(D)}if(C){G=G.map(E);F=F.map(E)}return{messages:G,threads:F}},setSelection:function(C){var E=this,B,D=true;if(C){if(C.messages&&C.threads){B=C.messages.concat(C.threads)}else{if(Array.isArray(C)){B=C}}}else{B=[]}if(typeof B[0]==="string"||typeof B[0]==="number"){B=B.map(function(F){return E.getMessageById(F)})}B.forEach(function(G){try{var F=G.relatedNode;E.activate(F,D);D=false}catch(H){}})},switchThreadMode:function(B){h.FolderCache.invalidateFolder(this.folder);var E=this.isThreaded=!this.isThreaded,D=this.htmlNodes,C=D.threadSwitcherA;if(C){if(E){if(this.page>375){this.page=1}C.innerHTML=x("wyłącz")}else{C.innerHTML=x("włącz")}}if(!B){z.instances.forEach(function(F){if(F!==this){F.switchThreadMode(true);F.needsRefresh=true}},this);h.FolderCache.invalidateAll();h.Prefs.set("threadedView",E?1:0,true,this.refresh.bind(this))}},switchPreview:function(C){var G=this.htmlNodes,D=G.previewSwitcherA,F=G.sliderDiv,E=G.mailsTbDiv,B=G.mailFrameDiv;this.isPreviewShown=!this.isPreviewShown;if(this.isPreviewShown){D.innerHTML=x("wyłącz");D.title=x("Wyłącz podgląd wiadomości");B.style.display="block";F.style.display="block";E.style.height=this.msgListHeight;p.removeClass(G.mailsTbDiv,"mails-container-full");p.removeClass(G.msgListHeaderDiv,"msglist-header-full");h.Tools.hitGemius(h.Tools.getGemiusByAlias("MSGLIST","ENABLE_MESSAGE_PREVIEW"))}else{D.innerHTML=x("włącz");D.title=x("Włącz podgląd wiadomości");B.style.display="none";F.style.display="none";this.msgListHeight=p.getStyle(E,"height");E.style.height="auto";E.style.minHeight=this.msgListHeight;p.addClass(G.mailsTbDiv,"mails-container-full");p.addClass(G.msgListHeaderDiv,"msglist-header-full");h.Tools.hitGemius(h.Tools.getGemiusByAlias("MSGLIST","DISABLE_MESSAGE_PREVIEW"))}if(!C){z.instances.forEach(function(H){if(H!==this){H.switchPreview(true)}},this);h.Prefs.set("previewShown",this.isPreviewShown)}},msgOperations:function(N,P,U){U=U||this.getSelection();h.FolderCache.invalidateAll();var I=this,H=U.messages,T=U.threads,B=H.concat(T),K=x("Operacja zakończona powodzeniem"),D=null,O=0,S=0,E=0,L,G,F,Q={};if(B.length===0){return false}L=T.map(function(V){return V.id}).join("*");switch(N){case"open":B.forEach(function(V){if(V.openTab){V.openTab()}else{V.open()}});return true;case"forw":if(B.length===1){B[0].edit(N,I)}else{h.Composition.composeNew({forwardMessages:B.filter(function(V){return V instanceof a}),forwardThreads:B.filter(function(V){return V instanceof b})})}return true;case"edit":case"resAll":case"res":B.forEach(function(V){try{V.edit(N,I)}catch(W){console.log("Can't call item.edit",W,V)}});return true;case"print":B.forEach(function(V){V.print()});return true;case"add2Cnt":A.addContactSimple(B[0].fromEmail,B[0].fromName);return true;case"blacklist":A.addEmailToBlackList(B[0].fromEmail);return true;case"removeFromBlacklist":A.removeEmailFromBlackList(B[0].fromEmail);return true;case"printThread":H.forEach(function(V){if(V.parentThread){V.parentThread.print()}});return true}if(N.indexOf("Thread")>0){L=d(H);N=N.replace("Thread","")}if(N==="unsubscribe"){for(var R=0;R<H.length;R++){if(!H[R].fUnsubscribable){H.splice(R,1);R--}}}G=H.map(function(V){return V.id+"|"+V.folderId}).join("*");S=H.filter(function(V){return Number(V.folderId)===3}).length;E=H.filter(function(V){return Number(V.folderId)===-2}).length;O=E+S;switch(N){case"setRead":case"setUnread":N=N.toLowerCase();h.Network.ajax({url:"/html/opermail",post:{oper:N,folder:this.folder,param:G,threads:L},onSuccess:function(Y){var W,X=B.length,V=N==="setread";Y=Inpl.Mail.Network.parseResponse(Y);if(Y.status){if(X){B.filter(function(Z){return Z.type==="thread"}).forEach(function(Z){Z.list.forEach(function(aa){aa.seen=V;p[V?"removeClass":"addClass"](aa.relatedNode,s)})})}if(V){for(W=0;W<X;W+=1){p.removeClass(B[W].relatedNode,s);B[W].seen=true;if(B[W].parentThread){B[W].parentThread.updateReadStatus()}}}else{for(W=0;W<X;W+=1){p.addClass(B[W].relatedNode,s);B[W].seen=false;if(B[W].parentThread){B[W].parentThread.updateReadStatus()}}}}else{l.showNotice(Y.msg,"error")}h.Folders.retrieve(function(){I.updateWinTitle()});I.deactivateAllItems()}});return true;case"move":F="/html/movemesg";Q={srcfolder:this.folder,dstfolder:P.folder.id,mesg:G,threads:L};var M="pojedynczy_mail";if(I.selectionCount()>1){var M="wszystkie_zaz"}if(h.Folders.getOfferFolderId()==Q.srcfolder){c.hitIWA(["html","oferty","-","przenies",M,P.folder.name])}else{if(h.Folders.getSocialFolderId()==Q.srcfolder){c.hitIWA(["html","spolecznosci","-","przenies",M,P.folder.name])}}if(L){K=Gettext.strargs(t.ngettext("Wątek został przeniesiony","Przeniesiono %1 wątków",B.length),B.length)}else{K=Gettext.strargs(t.ngettext("Wiadomość została przeniesiona","Przeniesiono %1 wiadomości",B.length),B.length)}K+=" "+(P.folder.id===3?x("do kosza"):t.strargs(x('do folderu "%1"'),P.folder.name));break;case"delete":if(O>0){G="";var J="";for(var R=0;R<H.length;R++){if(H[R].folderId==3||H[R].folderId==-2){J+=H[R].id+"|"+H[R].folderId+"*"}else{G+=H[R].id+"|"+H[R].folderId+"*"}}if(J.slice(-1)=="*"){J=J.substring(0,J.length-1)}if(G.slice(-1)=="*"){G=G.substring(0,G.length-1)}}F="delmail";Q={param:G,threads:L};if(O==0){if(L){K=Gettext.strargs(t.ngettext("Wątek został przeniesiony do kosza","Przeniesiono %1 wątków do kosza",B.length),B.length)}else{K=Gettext.strargs(t.ngettext("Wiadomość została przeniesiona do kosza","Przeniesiono %1 wiadomości do kosza",B.length),B.length)}}break;case"setSpam":F="/html/setspam";Q={param:G,threads:L};if(L){K=Gettext.strargs(t.ngettext("Wątek został oznaczony jako spam","%1 wątków oznaczono jako spam",B.length),B.length)}else{K=Gettext.strargs(t.ngettext("Wiadomość została oznaczona jako spam","%1 wiadomości oznaczono jako spam",B.length),B.length)}break;case"notSpam":F="/html/notspam";Q={param:G,threads:L};if(L){K=Gettext.strargs(t.ngettext("Usunięto oznaczenie wątku jako spam","Usunięto oznaczenie %1 wątków jako spam",B.length),B.length)}else{K=Gettext.strargs(t.ngettext("Usunięto oznaczenie wiadomości jako spam","Usunięto oznaczenie %1 wiadomości jako spam",B.length),B.length)}break;case"unsubscribe":F="/html/unsubscribe";Q={param:G};break;default:l.alert(x("Nieznana operacja: ")+N,"error");return false}function C(){Q.folder=I.folder;I.updateToolbars();h.Folders.markAllVFoldersToRefresh();h.Network.ajax({url:F,post:Q,onSuccess:function(V){var W=true;V=h.Network.parseResponse(V);if(V.status){if(!P||!P.muteNotice){l.showNotice(K)}}else{if(V.code==1017){l.showNotice(V.msg,"error",5000,false,true)}else{l.showNotice(V.msg,"error")}}h.FolderCache.invalidateAll();h.Folders.retrieve(I.updateWinTitle.bind(I));if(W){if(I.search||I.searchf){z.refreshAll()}else{I.refresh()}}}})}if(N==="setSpam"){h.ContactsWarnList.loadItems(function(){var V=h.ContactsWarnList;if(B.length===1){V.doAction(B[0].fromEmail,x("Czy w dalszym ciągu chcesz przenieść tę wiadomość do folderu Spam?"),C)}else{V.doAction(B.map(function(W){return W.fromEmail}),x("Czy chcesz przenieść wszystkie zaznaczone wiadomości do folderu Spam?"),C,x("<p>Jedna z zaznaczonych wiadomości pochodzi od %1, ponieważ jesteś użytkownikiem tego serwisu.</p><p>Jeśli nie chcesz już otrzymywać takich maili, <a href='%2' target=_blank>zmień ustawienia powiadomień</a> w ramach swojego konta w %1 lub zapoznaj się z informacjami, które mogą być zawarte w tej wiadomości.</p>"))}})}else{if(N==="unsubscribe"){l.ModalDialogs.richConfirm({title:"Zgłoszenie niechcianej wiadomości ",message:"Ten nadawca umożliwia automatyczne wypisanie się z listy adresatów, dzięki temu nie będziesz otrzymywać od niego tego typu wiadomości. <a href='http://pomoc.poczta.interia.pl/news-szybkie-wypisywanie-sie-z-list-mailingowych,nId,2281538/' target='_blank'>Dowiedz się więcej <span class='adNavRaquo'>»</span></a> <br/>Czy chcesz skorzystać z tej opcji?",acceptLabel:'<span class="bolder">TAK</span> (wypisz mnie)',cancelLabel:'<span class="bolder">NIE</span> (nie wypisuj mnie z subskrybcji)',onAccept:C})}else{if(!D){if(N!="delete"||L||G){C()}}else{l.ModalDialogs.confirm({message:D,onAccept:C})}}}if(O>0&&N=="delete"){F+=",real,1";Q={param:J,threads:L};if(S>0&&E===0){D=Gettext.strargs(t.ngettext("Czy usunąć nieodwracalnie tę wiadomość z kosza?","Czy usunąć nieodwracalnie %1 wiadomości z kosza?",S),S)}else{if(E>0&&S===0){D=Gettext.strargs(t.ngettext("Czy usunąć nieodwracalnie tę wiadomość z folderu Spam?","Czy usunąć nieodwracalnie %1 wiadomości z folderu Spam?",E),E)}else{D=Gettext.strargs(t.ngettext("Czy usunąć nieodwracalnie tę wiadomość?","Czy usunąć nieodwracalnie %1 wiadomości?",O),O)}}if(L){K=Gettext.strargs(t.ngettext("Wątek został usunięty","Usunięto %1 wątków",O),O)}else{K=Gettext.strargs(t.ngettext("Wiadomość została usunięta","Usunięto %1 wiadomości",O),O)}l.ModalDialogs.confirm({message:D,onAccept:C})}return true},getSenderFromSelection:function(B){if(B.threads.length||B.messages.length!=1){return null}else{return B.messages[0].fromEmail}}};z.search=function(D){D=D||{};var C,B=$("msg-search-field"),E=D.query||(B?B.value:"");if(E.length>=3&&B.value!==x("Szukaj wiadomości…")){C=new z({folder:0,search:E},Gettext.strargs(x('Szukasz: "%1"'),c.truncateString(B.value,10)));C.openInTab();_gaq.push(["b._trackEvent","Menu boczne","Wyszukiwarka","Otwarcie zakładki z wynikiem wyszukiwania"])}else{if(E.length>0){l.showNotice(x("Minimalna długość szukanego tekstu to 3 znaki."),"error");B.focus()}else{l.showNotice(x("Proszę wypełnić pole wyszukiwania."),"error");B.focus()}}return false};z.getMessageFromAll=function(C){var D,B=[];this.instances.forEach(function(E){D=E.getMessageById(C);if(D){B.push(D)}});return B};z.getListsOfFolder=function(B){return this.instances.filter(function(C){return Number(C.folder)===Number(B)})};z.refreshAll=function(){z.instances.forEach(function(B){B.needsRefresh=true});z.currentList.refresh()}}());(function(){var a=Inpl.Mail,b=a.Tools,d=50,e=b.augment,c=b.ns("Inpl.Mail.VideoPlayers");function f(g){throw new TypeError("AbstractVideo can't be instantiated")}e(f.prototype,{getPlayerHTML:function(){if(this.metadata){return this.metadata.html}else{throw new Error("no metadata.html")}},registerThumbnailElement:function(h,g){this.thumbnailElements.push([h,g])},removeFailedThumbnail:function(i){var j=this,h=i[0],g=i[1];h.parentNode.removeChild(h)}});e(f,{getResourceCache:function(g){if(f.resourceCache){return f.resourceCache}else{return f.resourceCache=new a.ArrayCache(d)}},parseREResults:function(g){return{movieId:g[1]}},secondsToMinutes:function(h){var g=parseInt(h/60,10),i=h%60;if(isNaN(g)){return"??:??"}if(i<10){i="0"+i}return g+":"+i}});c.AbstractVideo=f}());(function(){var a=Inpl.Mail,b=a.Tools,f=b.extendPrototype,g=(window.postMessage?a.Network.sandboxedJsonp:a.Network.jsonp).bind(a.Network),c=b.ns("Inpl.Mail.VideoPlayers"),e=c.AbstractVideo;function d(){throw new TypeError("AbstractOEmbedVideo can't be instantiated")}f(d,e,{isMetaDataLoaded:false,getMetaDataURL:function(){var h=window.innerWidth||document.documentElement.offsetWidth,j=window.innerHeight||document.documentElement.offsetHeight,i=this.url+(this.url.indexOf("?")>=0?"&":"?")+"url="+escape(this.getMovieURL())+"&maxwidth="+(Math.max(h-20,300))+"&maxheight="+Math.max(parseInt(0.6*j,10),200);return i},getMovieURL:function(){return this.url},getTitle:function(){return this.metadata.title},fetchMetaData:function(h){var l=this,i,j,k=e.getResourceCache(this);if(l.metadata){l.thumbnailElements.forEach(l.updateThumbnailElement.bind(l));if(h){h(l.metadata)}return}i=this.getMetaDataURL();function m(n){l.metadata=n;l.thumbnailElements.forEach(l.updateThumbnailElement.bind(l));l.isMetaDataLoaded=true;if(h){h(n)}}j=k.getByField("url",i);if(j){m(j.response)}else{g({url:i.replace(/^https?:/i,location.protocol),onSuccess:function(n){k.add({url:i,response:n});m(n)},timeout:10000,onTimeout:function(n){l.thumbnailElements.forEach(l.removeFailedThumbnail.bind(l))}})}},getWidth:function(){return this.metadata.width},getHeight:function(){return this.metadata.height},updateThumbnailElement:function(k){var l=this,i=l.metadata,j=k[0],h=k[1];j.innerHTML="";j.appendChild(h(i.thumbnail_url||i.thumbnail,l.getMovieURL(),i.title,e.secondsToMinutes(parseInt(i.duration,10))))}});c.AbstractOEmbedVideo=d}());(function(){var e=Inpl.Mail,f=e.Tools,i=f.augment,h=f.extendPrototype,g=Array.prototype.filter,j=((e.browser.supports.nativeJSON&&window.postMessage)?e.Network.sandboxedJsonp:e.Network.jsonp).bind(e.Network),d=f.ns("Inpl.Mail.VideoPlayers"),a=d.AbstractVideo;function c(k){this.thumbnailElements=[];i(this,k)}h(c,a,{isMetaDataLoaded:false,serviceName:"YouTube",formatDurationTime:function(k){return k.replace(/H(\d)M/,"H0$1M").replace(/M(\d)S/,"M0$1S").replace(/[HM]/g,":").replace(/[^\d\:]/g,"")},getMovieURL:function(){return"https://www.youtube.com/watch?v="+this.metadata.items[0].id},getPlayerHTML:function(){return this.metadata.items[0].player.embedHtml},getWidth:function(){return 640},getHeight:function(){return 385},getTitle:function(){return this.metadata.items[0].snippet.title},fetchMetaData:function(k){var o=this,l,m,n=a.getResourceCache(this);if(o.metadata){o.thumbnailElements.forEach(o.updateThumbnailElement.bind(o));if(k){k(o.metadata)}return}l="https://www.googleapis.com/youtube/v3/videos?part=snippet,player,contentDetails&id="+this.movieId+"&key=AIzaSyCfCCQsyehWuEt8RmAEG5d1Qtd8houD_Zs";function p(q){o.metadata=q;o.thumbnailElements.forEach(o.updateThumbnailElement.bind(o));o.isMetaDataLoaded=true;if(k){k(q)}}m=n.getByField("url",l);if(m){p(m.response)}else{j({url:l,onSuccess:function(q){n.add({url:l,response:q});p(q)},timeout:10000,onTimeout:function(q){o.thumbnailElements.forEach(o.removeFailedThumbnail.bind(o))}})}},updateThumbnailElement:function(n){var p=this,m=n[0],k=n[1],l=p.metadata,o=l.items[0],q;if(!o||!o.snippet||!o.snippet.thumbnails||!o.snippet.thumbnails["default"]||!o.snippet.thumbnails["default"].url){m.innerHTML="error";return}q=o.snippet.thumbnails["default"].url;m.innerHTML="";if(location.protocol==="https:"){q=q.replace("http:","https:")}m.appendChild(k(q,this.getMovieURL(),this.getTitle(),this.formatDurationTime(o.contentDetails.duration)))}});i(c,{regexp:/youtube\.com\/watch\?v\=([a-zA-Z0-9_\-]*)/g});function b(k){this.movieId=null;this.thumbnailElements=[];i(this,k)}h(b,c);i(b,{regexp:/youtu\.be\/([a-zA-Z0-9_\-]*)/g});d.YouTube=c;d.YouTubeShort=b}());(function(){var a=Inpl.Mail,b=a.Tools,d=b.augment,e=b.extendPrototype,c=b.ns("Inpl.Mail.VideoPlayers");function f(g){this.thumbnailElements=[];d(this,g)}e(f,c.AbstractOEmbedVideo,{serviceName:"Vimeo",url:"http://vimeo.com/api/oembed.json",getMovieURL:function(){return"http://vimeo.com/"+this.movieId}});d(f,{regexp:/vimeo\.com\/([0-9]+)/g});c.Vimeo=f}());(function(){var a=Inpl.Mail,b=a.Tools,e=b.augment,f=b.extendPrototype,d=b.ns("Inpl.Mail.VideoPlayers");function c(g){this.thumbnailElements=[];e(this,g)}f(c,d.AbstractOEmbedVideo,{serviceName:"DailyMotion",url:"http://www.dailymotion.com/services/oembed?format=json",getMovieURL:function(){return"http://www.dailymotion.com/video/"+this.movieId}});e(c,{regexp:/dailymotion\.[a-z]{2,5}\/video\/(.*)/g});d.DailyMotion=c}());(function(){var a=Inpl.Mail,b=a.Tools,d=b.augment,f=b.extendPrototype,c=b.ns("Inpl.Mail.VideoPlayers");function e(g){this.thumbnailElements=[];d(this,g)}f(e,c.AbstractOEmbedVideo,{serviceName:"Video INTERIA.PL",url:"http://video.interia.pl/api/oembed?mode=embed&format=jsonp",getMovieURL:function(){return"http://video.interia.pl/obejrzyj,film,"+this.movieId}});d(e,{regexp:/video\.interia\.pl\/obejrzyj\,film\,([0-9]*)/g});c.VideoInteria=e}());(function(){var a=Inpl.Mail,b=a.Tools,d=b.augment,f=b.extendPrototype,c=b.ns("Inpl.Mail.VideoPlayers");function e(g){this.thumbnailElements=[];d(this,g)}f(e,c.AbstractOEmbedVideo,{serviceName:"SlideShare",url:"http://www.slideshare.net/api/oembed/1/?format=json",getMovieURL:function(){return"http://slideshare.net/"+this.movieId},getPlayerHTML:function(){return this.metadata.html.replace(/.*<object/g,"<object").replace(/<\/object>.*/g,"</object>")}});d(e,{regexp:/slideshare.net\/([a-zA-Z0-9\-]*\/[a-zA-Z0-9\-]*)/g});c.SlideShare=e}());(function(){var g=Inpl.Mail,h=g.Tools,k=g.DOM,e=k.createElement,f=g.VideoPlayers,m,l,i,b=window.postMessage&&g.browser.supports.nativeJSON,c=new Gettext({domain:"inpl_mail_videopreview",locale_data:g.L10n}),j=function(n){return c.gettext(n)},d=20,a=["YouTube","YouTubeShort","VideoInteria"];l={fromREResults:function(o,p){var n=o.parseREResults||f.AbstractVideo.parseREResults;return new o(n(p))}};i={forMessageView:function(q,n,p,o){return e("span",{className:"attachments-images-list-item-inner",childNodes:[e("span",{className:"att-img-ctr-span",childNodes:[e("a",{href:n,target:"_blank",className:"att-img-link",innerHTML:"<i class=ie7-valign-fix></i><img style='max-width:160px' src='"+q+"'>"}),e("span",{className:"video-play-icon"})]}),e("span",{className:"attachment-name-inner",childNodes:[document.createTextNode(p)]}),e("br"),e("span",{className:"attachment-size",innerHTML:"("+o+")"}),e("ul",{className:"attachment-operations",childNodes:[e("li",{className:"att-send",childNodes:e("a",{innerHTML:j("Odtwórz"),href:n})})]})]})},forVideoLayer:function(q,n,p,o){return e("a",{href:n,childNodes:[e("img",{src:q,title:p+"; "+o,alt:p})]})}};m={thumbnailMappers:i,createThumbnailBar:function(o){var q,p,r,n=this.findVideos(o.contentWindow.document);if(!n.length){return}n=n.slice(0,d);q=e("div",{className:"attachments-section",childNodes:e("ul",{className:"attachments-images-list",childNodes:n.map(function(s,t){var u=e("li",{className:"attachments-images-list-item",innerHTML:'<span class="attachments-images-list-item-inner"><span class="att-img-ctr-span"><a href="#" class="att-img-link"><i class="ie7-valign-fix"></i><img src="'+g.env.staticUrl+'/image-loader.gif" style="max-width:160px"></a></span><span class="attachment-name-inner">&nbsp;</span><br><span class="attachment-size">&nbsp;</span><ul class="attachment-operations"><li class="att-send">&nbsp;</li></ul></span>'});s.registerThumbnailElement(u,i.forMessageView);u.onclick=function(v){v=v||event;k.preventDefault(v);Inpl.LoadableModules.require("Inpl.Mail.VideoLayer",function(){Inpl.Mail.VideoLayer.open(n,t)});return false};return u})})});r=document.createDocumentFragment();r.appendChild(e("hr"));r.appendChild(q);p=o.nextSibling;if(p.childNodes.length>0){p.insertBefore(r,p.firstChild)}else{p.appendChild(r)}p.style.display="block";n.forEach(function(s){s.fetchMetaData()});return q},findVideos:function(x){var t,r,z=k.nodeListToArray(x.getElementsByTagName("a")),w,y,p,q,o,n,v,u,s=[];p=b?Object.keys(f):a;p=p.filter(function(A){return A.indexOf("Abstract")<0}).map(function(A){return f[A]});q=p.length;w=h.unique(z.map(function(A){return A.href}));y=w.length;for(t=0;t<y;t+=1){n=w[t];forJ:for(r=0;r<q;r+=1){o=p[r];u=o.regexp;if(u.global){u.lastIndex=0}v=u.exec(n.split("#")[0]);if(v){s.push(l.fromREResults(o,v));break forJ}}}return s}};g.VideoPreview=m;g.VideoFactory=l}());Inpl.Mail.PromotionQueue=(function(){var b={},a=100;return{PRIORITY:{LOW:0,MEDIUM:100,HIGH:200,IMPORTANT:300},TYPE:{BUBBLE:"bubble",BOARD:"board",MESSAGE_LIST_STRIPE:"message-list-stripe"},insert:function(e,d,c){if(!d){throw new Error("Type of object was not specified !")}if(b[d]===undefined){b[d]={}}c=c||this.PRIORITY.LOW;if(b[d][c]===undefined){b[d][c]=[]}b[d][c].push(e);return this},extract:function(d){if(!d){throw new Error("Type of object was not specified !")}if(b[d]!==undefined){for(var c=this.PRIORITY.IMPORTANT;c>=this.PRIORITY.LOW;c-=a){if(b[d][c]!==undefined&&b[d][c].length>0){return b[d][c].shift()}}}return function(){}},extractAllAsArray:function(e){if(!e){throw new Error("Type of object was not specified !")}var c=[];if(b[e]!==undefined){for(var d=this.PRIORITY.IMPORTANT;d>=this.PRIORITY.LOW;d-=a){if(b[e][d]!==undefined){c=c.concat(b[e][d])}}}return c}}}());Inpl.Mail.Stationery=(function(){var o=new Gettext({domain:"inpl_mail_stationery",locale_data:Inpl.Mail.L10n}),h=[["img","src"],["td","background"],["body","background"]],t=function(v){return o.gettext(v)},d=Inpl.Mail,j=d.DOM,i=d.UI,b=d.Composition,a=d.Network,n=j.createElement,c=-1,q=["background-color","background-image","color","font-family","font-size","link","font-style"];function s(w,v){var x=String(v.getAttribute(w));if(x.indexOf(d.env.staticUrl+"/st/")===0){v.setAttribute("data-inpl-stationery",x.split(d.env.staticUrl+"/st/")[1])}}function e(v){h.forEach(function(w){Array.forEach(v.getElementsByTagName(w[0]),s.bind(null,w[1]))})}function f(A){A=A||event;var x=A.target||A.srcElement,y,C,z,B=0,v=0,w=0;for(w=0;x.tagName.toUpperCase()!=="LI"&&w<2;w++){x=x.parentNode}for(w=0,y=x;!j.hasClass(y,"stationery-chooser")&&w<2;w++){y=y.parentNode}y=x.parentNode.parentNode;z=parseInt(j.getStyle(x,"margin-left"),10)||0;C=parseInt(j.getStyle(y.parentNode,"padding-left"),10)||40;if(d.browser.ie<8&&d.browser.ie!==0){C=0}B=C+z+y.scrollLeft-x.offsetLeft;v=x.offsetLeft+x.clientWidth-y.scrollLeft-y.clientWidth-C;if(v>0||B>0){y.scrollLeft=y.scrollLeft+((v>0)?v:-B)}}function k(v){this.message=v}k.prototype=new Error();function l(v){v=v||{};this.id=v.id||null;this.template=v.template||"%MAIL_BODY%";this.name=v.name||t("Brak");this.thumbnail=v.thumbnail||"";this.bodyStyle=v.bodyStyle||{}}l.prototype.apply=function m(B){if(!B||!(B instanceof b)){throw new k("Stationery.apply requires a valid Composition argument")}if(B.type!==b.MSG_TYPE.HTML){throw new k("Stationery.apply called with a composition that is not an HTML composition")}var x=B.editor,y=x.getBody(),A=x.getDoc().documentElement,z=this.id,v=x.relatedComposition.stationery,C,w;C=x.getContent();x.getIfr().tabIndex=1;if(z!==-1){if(v){j.removeClass(y,"inpl-mail-template_"+v.id);j.removeClass(A,"inpl-mail-template_"+v.id)}if(!j.hasClass(y,"stationery")){j.addClass(y,"stationery")}j.addClass(y,"inpl-mail-template_"+z);j.addClass(A,"inpl-mail-template_"+z);x.relatedComposition.stationery=this}else{if(v){j.removeClass(A,"inpl-mail-template_"+v.id);j.removeClass(y,"stationery");j.removeClass(y,"inpl-mail-template_"+v.id)}x.relatedComposition.stationery=null}x.setContent(C);w=x.getDoc().getElementById("inpl-mail-stationery-maincontent");if(w){w.setAttribute("id","");w.removeAttribute("id")}if(z!==-1){d.Stationery.setBodyHeight(x)}e(x.getDoc());B.setFocusToMailBody()};l.applyBeforeSend=function(w,z){var y=w.template,v="",B="",A,x;q.forEach(function(C){if(C in w.bodyStyle){x=w.bodyStyle[C];if(C==="background-image"){B+=' background="'+x.replace(/\%STATIC_URL\%/g,d.env.staticUrl).replace("url(","").replace(")","")+'"'}else{if(C==="link"){B+=' alink="'+x+'" link="'+x+'" vlink="'+x+'"'}else{if(C==="color"){B+=' text="'+x+'"';v+=" color:"+x+";"}else{v+=" "+C+":"+x.replace(/\%STATIC_URL\%/g,d.env.staticUrl)+";"}}}}},this);if(!w.bodyStyle["font-style"]){v+="font-style:normal;"}y=y.replace(/style='/g,"style='"+v).replace(/\%MAIL_BODY\%/g,z.body.innerHTML).replace(/\%STATIC_URL\%/g,d.env.staticUrl);A='<body marginwidth="0" marginheight="0" topmargin="0" leftmargin="0" rightmargin="0" bottommargin="0" '+B+' style="padding:0px;margin:0px'+v+'">'+y+"</body>";return A};l.setBodyHeight=function(z){var C=0,B,y,A=z.getDoc(),x=A.body,D,E=parseInt(z.getIfr().style.height,10),w=parseInt(j.getStyle(x,"padding-top",A),10),v=parseInt(j.getStyle(x,"padding-bottom",A),10);y=z.getDoc().getElementById("ieCheat");if(y){y.parentNode.removeChild(y)}x.style.minHeight="";D=parseInt(j.getStyle(x,"min-height",A),10);if(j.hasClass(x,"stationery")){B=E-w-v;if(D<B){C=B;C=((C>10)?C:30)}else{C=D}x.style.minHeight=C+"px";if(d.browser.ie<8){x.style.overflow="auto"}if(d.browser.ie){if(j.hasClass(x,"stationery")&&!A.getElementById("ieCheat")&&D>0){x.appendChild(n("div",{disabled:"disabled",unselectable:"on",id:"ieCheat",style:{height:(B>C)?B:C+"px"},ownerDocument:A}))}}}};l.InvalidCompositionException=k;l.loadThumbnails=function r(y,x,w,v){l.getList(function(A){var z=n("ul",{className:"stationery-list",childNodes:[l.blankStationery].concat(A).map(function(B){var C;C=n("li",{childNodes:n("a",{href:"#apply-stationery_"+B.id,childNodes:[n("img",{alt:"",src:d.env.staticUrl+"/"+B.thumbnail,width:60,height:45,title:B.name})]})});j.addEvent(C,"click",f);return C})});j.addEvent(z,"click",w);y.appendChild(z);j.addClass(z.firstChild,"first-child");j.addClass(z.lastChild,"last-child");if(typeof v==="function"){v()}},x)};l.getList=function p(v,w){w=parseInt(w,10)||0;a.ajax({url:"/html/stationerylist,category,"+w,onSuccess:function(x){x=d.Network.parseResponse(x);if(x.status===true){v(x.data)}else{i.showNotice(t("Błąd podczas pobierania listy papeterii: ")+x.msg,"error")}}})};l.getStationery=function u(w,v){w=parseInt(w,10);if(w===c){v(l.blankStationery)}else{a.ajax({url:"/html/stationery,stid,"+w,onSuccess:function(y){var x;y=d.Network.parseResponse(y);if(y.status===true){x=y.data;v(new l(x))}else{i.showNotice(t("Błąd podczas pobierania papeterii: ")+y.msg,"error")}}})}};l.showPopupMenu=function g(F,C){var A=[t("Wszystkie"),t("Okolicznościowe"),t("Dla Niej i Dla Niego"),t("Inne")],E,B,x=punymce.Event,v=C.relatedComposition,z=$("inpl_stationery_menu");if(v.stationeryBubble){v.stationeryBubble.close();v.stationeryBubble=null}function D(){if(C.hideMenu){delete C.hideMenu}x.remove(document,"click",B);x.remove(C.getDoc(),"click",B);d.UI.PopupMenu.hideAll();return 1}function y(G){setTimeout(function(){D(G)},200);return 1}B=(d.browser.ie&&d.browser<9)?y:D;if(C.hideMenu){return C.hideMenu()}else{C.hideMenu=B}E=A.map(function(H,G){return{label:H,cmd:function(){v.openStationeryChooser(G);B()}}});if(!z){var w=new d.UI.PopupMenu(E,"inpl_stationery_menu");w.show(F);x.add(document,"click",B,C);x.add(C.getDoc(),"click",B,C)}else{B()}};l.blankStationery=new l({id:c,thumbnail:"st/empty.png"});return l}());Inpl.Mail.TaskbarNotifications=(function(){var i,b=Inpl.Mail,h=window.external,a=b.browser.ie,c=(a>8||!a)&&h&&("msIsSiteMode" in h),f=0,e=b.DOM,g={};function d(){setTimeout(i.hideNotification,1000);e.removeEvent(window,"focus",d)}i={init:function(){i.hideNotification();i.logStats();b.MessageNotifQueue.addPushListener(i.onPush)},onPush:function(j){var k=b.Folders.getById(Number(j.folderId));i.showNotification({name:k.name,fldMsg:k.incoming},1)},checkEnabled:function(){return c&&h.msIsSiteMode()},logStats:function(){var k;try{if(h.msIsSiteMode()){k=h.msIsSiteModeFirstRun(false);if(k>0){b.Tools.hitGemius("ncebi3usJJEPgphEEX3nYKcUTBOUwpBVprHJPfQ9zmH.B7")}else{b.Tools.hitGemius("B8M1jeLquatUrO9otDJb4McPTMlk0ZBZRsbpI0QxZmb.77")}}}catch(j){}},showNotification:function(k,m){var j,l;try{if(i.checkEnabled()){f+=m;h.msSiteModeClearJumpList();h.msSiteModeCreateJumpList("Nowe wiadomości ("+f+") poczta.interia.pl: ");for(j in k){if(k.hasOwnProperty(j)){l=g[j];if(l){l.fldMsg+=k[j].fldMsg}else{g[j]=k[j]}h.msSiteModeAddJumpListItem(g[j].name+" - nowych: "+g[j].fldMsg,"/html/pkmail,folder,"+j+",uid,"+b.env.uid,"/favmix.ico","self")}}h.msSiteModeSetIconOverlay(b.env.staticUrl+"/ic_notif2/"+(f>10?11:f)+".ico","");h.msSiteModeActivate();if(document.hasFocus()){setTimeout(i.hideNotification,5000)}else{e.addEvent(window,"focus",d)}}}catch(n){}},hideNotification:function(){try{if(i.checkEnabled()){f=0;h.msSiteModeClearIconOverlay();h.msSiteModeClearJumpList();g={}}}catch(j){}}};return i}());(function(){var j,b=Inpl.Mail,f=b.DOM,a=f.createElement,g=0,d,i;function c(k){var m=k.folderId===-2;if(m){return}if(j.isPlaying){return}var l=document.createElement("bgsound");l.loop=0;l.src=j.getSoundFileURL(g,"mp3");j.isPlaying=true;document.body.appendChild(l);setTimeout(function(){j.isPlaying=false;document.body.removeChild(l)},3000)}function e(){j.isPlaying=false;f.removeEvent(i,"ended",e)}function h(){j.isPlaying=true;f.addEvent(i,"ended",e)}j={isPlaying:false,getSoundFileURL:function(l,k){k=k||"ogg";return d+l+"."+k},notify:function(k){var l=k.folderId===-2;if(l){return}if(!this.isPlaying){i.play()}},init:function(){g=parseInt(b.Prefs.get("audioNotificationId"),10)||0;if(g===0){return false}d=b.env.staticUrl+"/au/";i=a("audio",{childNodes:[a("source",{src:this.getSoundFileURL(g),type:"audio/ogg"}),a("source",{src:this.getSoundFileURL(g,"mp3"),type:"audio/mpeg"})],style:{position:"absolute",top:"-20px",left:"0",width:"5px",height:"5px",overflow:"hidden"}});if(typeof i.play!=="function"){if(b.browser.ie){j.notify=c;b.MessageNotifQueue.addPushListener(this.notify.bind(this));return true}return false}f.addEvent(i,"play",h);b.MessageNotifQueue.addPushListener(this.notify.bind(this));document.body.appendChild(i);return true}};b.AudioNotifications=j}());(function(){var b=Inpl.Mail,f=b.DOM,h=f.createElement,g=b.UI.ModalDialogs,c=b.Folders,t,e,j={},p,o,d=1,q=-2,m=new Gettext({domain:"inpl_mail_quickfilters",locale_data:b.L10n}),r=function(i){return m.gettext(i)};e={add:function(i,v){if(i&&v){j[i]=v}},removeBySender:function(i){if(i){delete j[i]}},removeByFilterNumber:function(v){if(v){var i;for(i in j){if(j[i]===v){delete j[i];break}}}},purge:function(){j={}},get:function(i){return j[i]||null},isInCache:function(i){return !!j[i]},refreshFilterCache:function(v){var w,x;b.Network.ajax({url:"/html/qfsget",onSuccess:function(i){i=b.Network.parseResponse(i);if(i&&i.status){e.purge();if(i.data&&i.data.filters){x=i.data.filters;for(w=0;w<x.length;w++){e.add(x[w].address,x[w].id)}}if(v){v()}}}})}};function a(w,i,v){b.Network.ajax({url:"/html/qfadd",post:{fldid:i,em:w},onSuccess:function(x){x=b.Network.parseResponse(x);if(x&&x.data&&x.data.success&&x.data.filterNumber){e.add(w,x.data.filterNumber);b.UI.showNotice("Filtr został dodany");if(v){v()}}else{if(x&&x.data&&x.data.isLimitReached){p=g.createModalDialog({title:r("Dodaj filtr"),message:r("Limit ilości filtrów został przekorczony. Czy chcesz przejść do listy filtrów i usunąć nieużywane aby móc dodawać nowe filtry?"),onBeforeAccept:function(){window.location.href="//ustawienia.interia.pl/poczta/filtry";return true}},g.prototypes.richConfirmationDialog);p.show()}else{b.UI.showNotice("Nie udało się dodać filtra")}}},onError:function(){b.UI.showNotice("Nie udało się dodać filtra")}})}function u(y,w,i,v,x){b.Network.ajax({url:"/html/qfupdate",post:{fltn:y,fldid:i,em:w},onSuccess:function(z){z=b.Network.parseResponse(z);if(z&&z.data){if(!z.data.isFilterDesync){b.UI.showNotice("Zaktualizowano filtr");if(v){v()}}else{if(!x){e.refreshFilterCache(function(){y=e.get(w);if(y){u(y,w,i,v,true)}else{a(w,i,v)}})}else{b.UI.showNotice("Nie udało się usunąć filtra - filtry zdesynchronizowane")}}}else{b.UI.showNotice("Nie udało się zaktualizować filtra")}},onError:function(){b.UI.showNotice("Nie udało się zaktualizować filtra")}})}function k(i){if(!i||!i.sender||!i.folderId){return}i.callbackFn=i.callbackFn||null;i.filterNumber=i.filterNumber||t.getFilterNumber(i.sender);if(i.filterNumber){u(i.filterNumber,i.sender,i.folderId,i.callbackFn)}else{a(i.sender,i.folderId,i.callbackFn)}}function n(y,v,i,x){if(!y||!v){b.UI.showNotice("Nie udało się usunąć filtra")}var w=true;b.Network.ajax({url:"/html/qfdelete",post:{fltn:y,em:v},onSuccess:function(z){z=b.Network.parseResponse(z);if(z&&z.data){if(!z.data.isFilterDesync){e.removeByFilterNumber(y);b.UI.showNotice("Filtr został usunięty");if(i){i()}}else{if(!x){e.refreshFilterCache(function(){w=false;y=e.get(v);if(y){n(y,v,i,true)}else{b.UI.showNotice("Filtr już nie istnieje");if(i){i()}}})}else{b.UI.showNotice("Nie udało się usunąć filtra - filtry zdesynchronizowane")}}}else{b.UI.showNotice("Nie udało się usunąć filtra")}},onError:function(z){b.UI.showNotice("Nie udało się usunąć filtra")}})}function l(v,i){if(i.checked){f.addClass(v,"existingFolder");f.removeClass(v,"newFolder")}else{f.removeClass(v,"existingFolder");f.addClass(v,"newFolder")}}function s(v,w,i){setTimeout(function(){if(w.value==q&&i.checked){v.innerHTML='Nadawca zostanie dodany do listy <a target="_blank" href="//ustawienia.interia.pl/poczta/antyspam">zablokowanych</a>'}else{v.innerHTML=""}},50)}t={DISABLE_FOR_MOVING_TO_SPAM:true,FolderModes:{EXISTING:1,NEW:2},getFilterNumber:function(i){if(i&&e.isInCache(i)){return e.get(i)}return null},filterOperation:function(i){if(i.folderMode===this.FolderModes.EXISTING){k(i)}else{c.createFolder(i.folderName,{okCallback:function(v){i.folderId=v.id;if(i.moveMessageCallbackFn){i.moveMessageCallbackFn(Inpl.Mail.Folders.getById(i.folderId))}k(i)}})}},disable:function(){b.Prefs.set("isQuickFiltersDisabled",1,true);b.UI.showNotice(r("Szybkie Filtry nie będą już automatycznie tworzone."))},showDeleteFilterPrompt:function(v,i){p=g.createModalDialog({title:r("Prośba o potwierdzenie"),additionalClass:"message-centered-md",message:r("Czy usunąć ten filtr?"),acceptLabel:r("Tak"),cancelLabel:r("Nie"),onBeforeAccept:function(){n(t.getFilterNumber(v),v,i);return true}},g.prototypes.richConfirmationDialog);p.show()},showFilterPrompt:function(z,i,A){var B=false,w=c.getById(i).name,y,v,x,C;if(!A){A=t.getFilterNumber(z)}y=!!A;v=i===d;x=i===q;if(!z||!i||(v&&!A)){return}if(v){C=r("Usuń filtr")}else{C=r("Dodaj filtr")}p=g.createModalDialog({createFooter:function(){return h("label",{childNodes:[h("input",{type:"checkbox",checked:b.Prefs.get("isQuickFiltersDisabled"),id:"disableQuickFilters",onchange:function(){B=f.elmById("disableQuickFilters").checked}}),h("span",{innerHTML:r("Nie pokazuj więcej tego komunikatu")})]})},title:C,additionalClass:"no-icon-md",message:x?m.strargs(r('Wiadomość została przeniesiona do folderu <b>%1</b>.<br><br>Jeśli nie chcesz otrzymywać wiadomości od tego nadawcy najprościej dodać jego adres do listy <a target="_blank" href="//ustawienia.interia.pl/poczta/antyspam">zablokowanych</a>'),[b.Tools.stripTags(w)]):m.strargs(r("Wiadomość została przeniesiona do folderu <b>%1</b>.<br><br>Czy chcesz aby wszystkie nowe wiadomości od tego nadawcy były przenoszone do tego folderu?"),[b.Tools.stripTags(w)]),acceptLabel:x?r("Zablokuj nadawcę"):r("Tak"),cancelLabel:x?r("Nie blokuj"):r("Nie"),onHide:function(){if(B){t.disable()}},onBeforeAccept:function(){if(v){n(A,z)}else{if(x){if(y){n(A,z)}b.Blacklist.addEmail(z);b.UI.showNotice(m.strargs(r("Dodano adres %1 do listy zablokowanych"),[z]))}else{if(y){t.filterOperation({folderMode:t.FolderModes.EXISTING,folderId:i,sender:z,filterNumber:A})}else{t.filterOperation({folderMode:t.FolderModes.EXISTING,folderId:i,sender:z})}}}return true}},g.prototypes.richConfirmationDialog);p.show()},showCustomFilterPrompt:function(x,B,C){var z=[],w,y,v,E,G,i,F=true,A,D=false;w=c.getSystemFolders();w=w.concat(c.getUserFolders());z.push(h("option",{value:0,innerHTML:"Wybierz folder"}));for(o=0;o<w.length;o++){if(w[o].id!=1&&w[o].id!=2&&w[o].id!=-1){z.push(h("option",{value:w[o].id,innerHTML:w[o].name}))}}p=g.createModalDialog({title:r("Dodaj filtr"),additionalClass:"no-icon-md",acceptLabel:r("Tak"),cancelLabel:r("Nie"),createInnerDiv:function(){i=h("div",{className:"customFilterPrompt",childNodes:[h("p",{innerHTML:r("Przenoś wszystkie nowe wiadomości od tego nadawcy do:")}),h("div",{childNodes:[y=h("input",{type:"radio",name:"folderGroup",value:"radioExistingFolder",checked:true,onchange:function(){l(i,y);s(A,E,y)}}),E=h("select",{childNodes:z,onfocus:function(){y.checked=true;l(i,y);s(A,E,y)},onchange:function(){s(A,E,y)}})]}),h("div",{childNodes:[v=h("input",{type:"radio",name:"folderGroup",value:"radioNewFolder",onchange:function(){l(i,y);s(A,E,y)}}),G=h("input",{type:"text",placeholder:r("Wpisz nazwę nowego folderu"),onfocus:function(){v.checked=true;l(i,y);s(A,E,y)}})]}),h("div",{childNodes:[h("label",{className:"createQuickFilter",childNodes:[h("input",{type:"checkbox",checked:true,id:"moveMessageByFilter",onchange:function(){F=f.elmById("moveMessageByFilter").checked}}),h("span",{innerHTML:m.strargs(r("Przenieś również tą wiadomość "))})]})]}),A=h("p")]});l(i,y);return i},onBeforeAccept:function(){if(v.checked){if(!G.value.length){y.checked=true;l(i,y);s(A,E,y);return false}if(F){t.filterOperation({folderMode:t.FolderModes.NEW,folderName:G.value,sender:x,callbackFn:B,moveMessageCallbackFn:C})}else{t.filterOperation({folderMode:t.FolderModes.NEW,folderName:G.value,sender:x,callbackFn:B})}}else{if(E.value==="0"){b.UI.showNotice(r("Wybierz folder!"));return false}if(E.value==q){b.Blacklist.addEmail(x);b.UI.showNotice(m.strargs(r("Dodano adres %1 do listy zablokowanych"),[x]))}else{t.filterOperation({folderMode:t.FolderModes.EXISTING,folderId:E.value,sender:x,callbackFn:B})}if(C&&F){C(Inpl.Mail.Folders.getById(E.value))}}return true}},g.prototypes.richConfirmationDialog);p.show()},init:function(){e.refreshFilterCache()}};b.QuickFilters=t}());(function(){var e=Inpl.Mail,m=e.DOM,o=m.createElement,n=e.UI.ModalDialogs,l=e.Prefs,h=-100,d=-101,g="viewsSettingsBitmask",w={VIEWS_BAR_HIDDEN:1,NEW_VIEWS_BAR_HIDDEN:8,SHOPPING_BUBBLE_CNT:"shoppingBubbleCnt",SOCIAL_BUBBLE_CNT:"socialBubbleCnt"},s={SHOPPING:1,SOCIAL:2,ALL:3},c={"-100":1,"-101":2},r,q,v,C,y,f,t,i,k,u,j,B,A,x,b,a,p=new Gettext({domain:"inpl_mail_views",locale_data:e.L10n}),z=function(D){return p.gettext(D)};q=(function(){var E,G,F,D,E=function(H){return l.get(w[H])};F=function(H,J,I){l.set(w[H],J,I)};G=function(H){var I=l.get(g);return !!(I&H)};D=function(H,K,I){var J=l.get(g);if(K){l.set(g,H|J,I)}else{l.set(g,~H&J,I)}};return{get:function(H){switch(H){case w.VIEWS_BAR_HIDDEN:case w.NEW_VIEWS_BAR_HIDDEN:return G(H);case w.SHOPPING_BUBBLE_CNT:case w.SOCIAL_BUBBLE_CNT:return E(H)}},set:function(H,I){switch(H){case w.VIEWS_BAR_HIDDEN:case w.NEW_VIEWS_BAR_HIDDEN:D(H,I,true);break;case w.SHOPPING_BUBBLE_CNT:case w.SOCIAL_BUBBLE_CNT:F(H,I,true);break}}}})();A=function(D,E){if(D===s.SHOPPING||D===s.ALL){m.addClass(document.body,E?"shv-enabled":"shv-disabled");m.removeClass(document.body,E?"shv-disabled":"shv-enabled")}if(D===s.SOCIAL||D===s.ALL){m.addClass(document.body,E?"sov-enabled":"sov-disabled");m.removeClass(document.body,E?"sov-disabled":"sov-enabled")}};t=function(D,E){e.Network.ajax({url:"/html/enableviews",post:{viewType:D},onSuccess:function(F){F=e.Network.parseResponse(F);if(F&&F.status&&F.data===true){e.UI.showNotice(D===s.ALL?"Filtry zostały włączone":"Filtr został włączony");e.Folders.retrieve();if(E){E()}}else{e.UI.showNotice(D===s.ALL?"Nie udało się włączyć filtrów":"Nie udało się włączyć filtra")}}})};k=function(D,E){e.Network.ajax({url:"/html/disableview",post:{viewType:D},onSuccess:function(F){F=e.Network.parseResponse(F);if(F&&F.status&&F.data===true){e.UI.showNotice(D===s.ALL?"Filtry zostały wyłączone":"Filtr został wyłączony");e.Folders.retrieve();A(D,false);if(E){E()}}else{e.UI.showNotice(D===s.ALL?"Nie udało się wyłączyć filtrów":"Nie udało się wyłączyć filtra")}}})};u=function(D){e.Network.ajax({url:"/html/getnewsletters",onSuccess:function(E){E=e.Network.parseResponse(E);if(E&&E.status&&E.data){if(D){D(E.data)}}else{e.UI.showNotice("Nie udało się pobrać listy newsletterów")}}})};j=function(E,D){if(E){k(c[""+E],D)}};B=function(D,F){var E=m.hasClass(document.body,"shv-enabled"),G=m.hasClass(document.body,"sov-enabled");if(D===s.SHOPPING||D===s.ALL){if(E){k(s.SHOPPING,F);_gaq.push(["b._trackEvent","Powiadomienia","Zakładka powiadomienia","wyłączenie filtra zakupy"])}else{t(s.SHOPPING,F);_gaq.push(["b._trackEvent","Powiadomienia","Zakładka powiadomienia","włączenie filtra zakupy"])}}if(D===s.SOCIAL||D===s.ALL){if(G){k(s.SOCIAL,F);_gaq.push(["b._trackEvent","Powiadomienia","Zakładka powiadomienia","wyłączenie filtra społeczności"])}else{t(s.SOCIAL,F);_gaq.push(["b._trackEvent","Powiadomienia","Zakładka powiadomienia","włączenie filtra społeczności"])}}};y=function(F,D){var E;switch(D){case"left":E="ta-left";break;case"right":E="ta-right";break;case"top":E="ta-top";break}return o("span",{className:"tooltip-activator "+(E||""),innerHTML:"<b>"+F+"<div></div></b>"})};v=function(){u(function(E){var O=E,H,G,F,L,I,D,M=2592000,J,N,K={enableShopping:z("Tu możesz włączyć automatyczne przenoszenie wiadomości z serwisów zakupowych do folderu Zakupy"),enableSocial:z("Tu możesz włączyć automatyczne przenoszenie wiadomości z serwisów społecznościowych do folderu Społeczności"),sender:z("Serwis, z którego otrzymujesz powiadomienia"),month:z("Informacja czy w ciągu ostatniego miesiąca na konto trafiła wiadomość z danego serwisu"),unsubscribe:z("W tym miejscu masz możliwość zrezygnowania z otrzymywania powiadomień z danego serwisu")};if(!a){a=o("div",{id:"newsletter-tab",childNodes:[o("p",{innerHTML:z("W tym miejscu znajdziesz listę serwisów zakupowych i społecznościowych wraz z informacją który z nich ostatnio do Ciebie napisał.")+"<br>"+z('Jeśli nie jesteś zainteresowany otrzymywaniem takich wiadomości skorzystaj z opcji "Wypisz".')+"<br><br>"+z("Sam decyduj jakie maile mają trafiać na Twoje konto!")})]});F=O.length;for(H=0;H<F;H++){J=(O[H].parent_id===h);a.appendChild(o("div",{className:J?"shopping-view-section":"social-view-section",childNodes:[o("h2",{innerHTML:"Folder "+O[H].name}),o("span",{className:"toggle-button",onclick:(function(P){return function(){B((O[P].parent_id===h)?s.SHOPPING:s.SOCIAL)}})(H),childNodes:[o("i"),o("span",{className:J?"hide-on-shopping-disabled disable-view":"hide-on-social-disabled disable-view",innerHTML:"Wyłącz"}),o("span",{className:J?"hide-on-shopping-enabled enable-view":"hide-on-social-enabled enable-view",innerHTML:"Włącz"})]}),y(J?K.enableShopping:K.enableSocial),o("p",{innerHTML:z(J?"Do tej grupy należą serwisy wysyłające oferty, promocje, okazje oraz inne materiały marketingowe":"Do tej grupy należą serwisy, portale społecznościowe, miejsca w których dzielisz się z innymi swoimi materiałami np. filmy, zdjęcia")}),o("table",{childNodes:[o("thead",{childNodes:[o("td",{innerHTML:"Nadawca",childNodes:[y(K.sender,"left")]}),o("td",{innerHTML:"Dostarczone w ciągu 30 dni",childNodes:[y(K.month)]}),o("td",{innerHTML:"Wypisz mnie",childNodes:[y(K.unsubscribe,"right")]})]}),N=o("tbody")]})]}));D=Math.round(new Date().getTime()/1000);L=O[H].filters.length;for(G=0;G<L;G++){I=O[H].filters[G];N.appendChild(o("tr",{className:(D-I.last_message_timestamp<M)?"row-enabled":"",childNodes:[o("td",{innerHTML:I.filter_name}),o("td",{innerHTML:(D-I.last_message_timestamp<M)?"TAK":"NIE"}),o("td",{childNodes:[o("span",{className:"unsubscribe-button"+(I.last_message_timestamp>0?" u-button-enabled":""),innerHTML:"Wypisz",onclick:(function(P){return function(){if(P.last_message_timestamp>0){C(P.filter_id);_gaq.push(["b._trackEvent","Powiadomienia","Zakładka powiadomienia","Wypisanie"])}}})(I)})]})]}))}}}if(!b){b=new e.Tabs.Tab(z("Powiadomienia"),a,function(){e.UI.injectButtons(null,"nav1");e.UI.injectButtons(null,"bottIco")},function(){b=null})}b.show();_gaq.push(["b._trackEvent","Powiadomienia","Zakładka powiadomienia","wyświetlenie"])})};C=function(D,F,E){e.Network.ajax({url:"/html/getunsubscribeurl",post:{filterId:D},onSuccess:function(G){var H;G=e.Network.parseResponse(G);if(G&&G.status){if(G.data){H=n.confirm({title:z("Zrezygnuj z powiadomień"),acceptLabel:z("Wypisz mnie"),createInnerDiv:function(){if(typeof F==="function"){return o("div",{innerHTML:z("Najlepszym sposobem na pozbycie się niechcianych powiadomień jest wypisanie się z danego serwisu.")+"<br/><br/>"+z('Jeśli nie chcesz skorzystać z takiej możliwości - <span id="views-block-sender"></span>'),style:{width:"375px"},childNodes:[o("a",{innerHTML:z("zablokuj nadawcę"),href:"#",onclick:function(){F();H.hide();return false}})]})}else{return o("div",{innerHTML:z("Serwis wymaga potwierdzenia wypisania się – czy chcesz teraz do niego przejść?")})}},onBeforeAccept:function(){window.open(G.data);return true}});return false}else{if(E){E()}}}else{e.UI.showNotice("Nie udało się wypisać")}}})};x=function(){var H=Math.round(new Date().getTime()/1000),G=false,I=false,F=m.hasClass(document.body,"shv-enabled"),J=m.hasClass(document.body,"sov-enabled"),E=e.Prefs.get("view100"),D=e.Prefs.get("view101");if(E!==null){G=E+86400<H}if(D!==null){I=D+86400<H}if(!e.env.viewsActive){return}if(!F){A(s.SHOPPING,false)}if(!J){A(s.SOCIAL,false)}};r={SHOPPING_PARENT_FOLDER_ID:h,SOCIAL_PARENT_FOLDER_ID:d,openNewsletterTab:v,SettingsKeys:w,ViewsSettings:q,ViewTypes:s,enableView:t,disableView:k,init:x,createTooltip:y,disableViewByParentId:j,afterDisableView:i,afterEnableView:f,updateBodyClass:A,openUnsubscribeDialog:C};e.Views=r}());(function(){var e=Inpl.Mail,h=e.DOM,c=h.createElement,k=e.UI.ModalDialogs,m=e.Prefs,b=new Gettext({domain:"inpl_mail_aliases",locale_data:e.L10n}),i=function(p){return b.gettext(p)},f,l,a,o,n,j,g,d;f={createOptionElement:function(p){return c("option",{value:p,childNodes:p})},createLiElement:function(p){return c("li",{childNodes:p})},validateAlias:function(p){if(p.length>2&&p.length<33){return(/^([a-z][a-z0-9]*)+(?:(\.|_)[a-z0-9]+)*$/i).test(p)}else{return false}},showAliasCreatedConfirmation:function(p){k.alert({title:i("Nazwa konta została zmieniona!"),acceptLabel:i("Zamknij"),additionalClass:"confirm-alias-md",message:c("div",{childNodes:[c("p",{childNodes:[c("span",{childNodes:"Adres "}),c("b",{childNodes:p}),c("span",{childNodes:" jest gotowy do użycia."})]}),c("p",{childNodes:"Od teraz możesz już:"}),c("ul",{childNodes:[c("li",{childNodes:[c("span",{childNodes:"logować się nowym adresem: "}),c("b",{childNodes:p})]}),c("li",{childNodes:[c("b",{childNodes:"wysyłać i odbierać"}),c("span",{childNodes:" z niego wiadomości"})]}),c("li",{childNodes:[c("span",{childNodes:"twoje stare wiadomości, kontakty i ustawienia "}),c("b",{childNodes:"pozostają bez zmian"})]}),c("li",{childNodes:"wiadomości wysłane na stary adres trafią również na nowy"})]}),c("p",{childNodes:"Aby w pełni korzystać ze zmienionego adresu musisz się przelogować:"}),c("ul",{childNodes:[c("li",{childNodes:"użyj tego samego hasła"}),c("li",{childNodes:"nadal możesz logować się na stary adres"})]}),c("a",{className:"alias-logout",childNodes:"Chcę sprawdzić teraz - wyloguj mnie",href:e.env.logoutUrl})]})})},showAliasCreatedConfirmationPromotion:function(q){var p;p=k.confirm({title:null,additionalClass:"aliasWelcomePage "+j,message:[c("div",{className:"aliasLogoutBtn",innerHTML:i("Wyloguj się teraz"),onclick:function(){var r;if(d==1){r="#utm_source=plansza_12_m&utm_medium=wylogowanie&utm_campaign=aliasy"}else{r="#utm_source=plansza_a_moze&utm_medium=wylogowanie&utm_campaign=aliasy"}location.href="http://www.konto.interia.pl/wyloguj?referer=http%3A%2F%2Fpoczta.interia.pl"+r;return false}}),c("a",{className:"alliasCloseLink",href:"#close-layer",onclick:function(){p.hide();_gaq.push(["b._trackEvent","Aliasy",g,"Przejdź do poczty"]);return false}}),c("a",{className:"alliasMoreLink",href:"http://info.poczta.interia.pl/pomoc/artykuly,2001307"}),c("a",{className:"alliasClose",href:"#close-layer",onclick:function(){p.hide();return false}})],createButtons:function(){return[]}})}};l=function(r,t,s,p,u,q){e.Network.ajax({url:"/html/aliasadd",post:{alias:r,domain:t},onSuccess:function(v){v=e.Network.parseResponse(v);if(v.status){if(p){p()}f.showAliasCreatedConfirmation(r+"@"+t);s.hide()}else{if(v.code){switch(v.code){case 10:e.UI.showNotice("Błędny format aliasu");s.hide();break;case 11:e.UI.showNotice("Nieobsługiwana domena");s.hide();break;case -120:if(q){q()}else{e.UI.showNotice("Nie można dodać więcej niż 5 adresów dodatkowych");s.hide()}break;case -105:if(u){u()}else{e.UI.showNotice("Wybrany alias jest już zajęty");s.hide()}break;default:e.UI.showNotice("Nie udało się dodać aliasu");s.hide();break}}else{e.UI.showNotice("Nie udało się dodać aliasu");s.hide()}}},onError:function(){e.UI.showNotice("Nie udało się dodać aliasu");s.hide()}})};a=function(r,t,s,p,u,q){e.Network.ajax({url:"/html/aliasadd",post:{alias:r,domain:t},onSuccess:function(v){v=e.Network.parseResponse(v);if(v.status){if(p){p()}f.showAliasCreatedConfirmationPromotion(r+"@"+t);s.hide()}else{if(v.code){switch(v.code){case 10:e.UI.showNotice("Błędny format aliasu");s.hide();break;case 11:e.UI.showNotice("Nieobsługiwana domena");s.hide();break;case -120:if(q){q()}else{e.UI.showNotice("Nie można dodać więcej niż 5 adresów dodatkowych");s.hide()}break;case -105:if(u){u()}else{e.UI.showNotice("Wybrany alias jest już zajęty");s.hide()}break;default:e.UI.showNotice("Nie udało się dodać aliasu");s.hide();break}}else{e.UI.showNotice("Nie udało się dodać aliasu");s.hide()}}},onError:function(){e.UI.showNotice("Nie udało się dodać aliasu");s.hide()}})};o=function(q,s,r,t,p){e.Network.ajax({url:"/html/aliascheck",post:{alias:q,domain:s},onSuccess:function(u){u=e.Network.parseResponse(u);if(u.status){h.addClass(r.message[0],"valid-ok");h.addClass(r.message[1],"hideButton");h.addClass(r.message[2],"showButton")}else{if(u.code){switch(u.code){case 10:e.UI.showNotice("Błędny format aliasu");r.hide();break;case 11:e.UI.showNotice("Nieobsługiwana domena");r.hide();break;case -105:if(t){t()}else{e.UI.showNotice("Wybrany alias jest już zajęty");r.hide()}break;default:e.UI.showNotice("Nie udało się sprawdzić aliasu");r.hide();break}}else{e.UI.showNotice("Nie udało się sprawdzić aliasu");r.hide()}}},onError:function(){e.UI.showNotice("Nie udało się sprawdzić aliasu");r.hide()}})};e.Aliases={getAliasPromotionEnabled:function(){var p=e.env.aliasPromotionEnabled;if(localStorage&&localStorage.getItem("aliasPromotionEnabled")){p=(localStorage.getItem("aliasPromotionEnabled")==="true"||localStorage.getItem("aliasPromotionEnabled")===true)}return p},showNewAliasDialog:function(){var q,p,s,r;r=k.confirm({title:i("Zmień nazwę konta"),acceptLabel:i("Zapisz"),additionalClass:"no-icon-md alias-md",message:[c("p",{childNodes:i("Wybierz nową nazwę dla Twojego konta:")}),s=c("div",{id:"alias-inputs",childNodes:[q=c("input",{type:"text",onkeypress:function(){h.removeClass(s,"error");h.removeClass(s,"error-alias-taken");h.removeClass(s,"error-alias-limit-exceeded");h.removeClass(s,"error-validation")}}),c("b",{childNodes:i("@")}),p=c("select",{childNodes:e.env.aliasesDomains.map(f.createOptionElement)}),c("div",{className:"error-message",childNodes:[i("Poprawna nazwa konta"),c("ul",{childNodes:[c("li",{childNodes:[i("może składać się z:"),c("ul",{childNodes:[c("li",{childNodes:i("liter a-z (bez polskich znaków)")}),c("li",{childNodes:i("cyfr 0-9")}),c("li",{childNodes:i('znaków kropki "." i podkreślenia "_"')})]})]}),c("li",{childNodes:i("musi zaczynać się od litery")}),c("li",{childNodes:i("może zawierać od 3 do 32 znaków")})]})]}),c("div",{className:"alias-taken-message",childNodes:i("Nazwa konta jest zajęta")}),c("div",{className:"alias-limit-exceeded",childNodes:[i("Nie można dodać więcej niż 5 adresów dodatkowych - "),c("a",{href:"https://ustawienia.interia.pl/poczta/konta-zewnetrzne",childNodes:i("zarządzaj listą adresów")})]})]}),c("p",{childNodes:i("PAMIĘTAJ:")}),c("p",{childNodes:i("Twoja stara nazwa konta nadal będzie działać - wszystkie maile wysłane zarówno na stary jak i na nowy adres trafią do Ciebie!")})],onBeforeAccept:function(){var t=q.value,u=p.options[p.selectedIndex].value;if(!f.validateAlias(t)){e.UI.showNotice("Błędny format aliasu");h.addClass(s,"error error-validation");return false}else{l(t,u,r,function(){var v=t+"@"+u;m.set("defaultAccount",v,true);e.env.aliases.push({emailAddress:v,displayName:t})},function(){h.addClass(s,"error error-alias-taken")},function(){h.addClass(s,"error error-alias-limit-exceeded")})}_gaq.push(["b._trackEvent","Aliasy","Plansza-zmień nazwę konta","zapisz - "+u]);return false},onCancel:function(){_gaq.push(["b._trackEvent","Aliasy","Plansza-zmień nazwę konta","anuluj"]);return true}});q.focus();_gaq.push(["b._trackEvent","Aliasy","Plansza-zmień nazwę konta","wyświetlenie"])},promotionNewAliasDialog:function(w){var s,v,t,y,p,r,z,x,q,u="interia.pl";switch(w){case 1:z="aliasWelcomePageB";j="aliasWelcomePageBGrat";g="Plansza -12 milionów kont";d=w;break;case 2:z="aliasWelcomePageC";j="aliasWelcomePageCGrat";g="Plansza -A może nowa nazwa konta";d=w;break}r=k.confirm({title:null,additionalClass:"aliasWelcomePage "+z,message:[y=c("div",{id:"alias-inputs",childNodes:[c("div",{className:"validate-symbol"}),s=c("input",{type:"text",placeholder:"wpisz nazwę",onkeyup:function(){r.removeClass()}}),v=c("input",{className:"selectDomain",readOnly:true,value:e.env.aliasesDomains[0],onclick:function(){h.toggleClass(t,"showDomainBoxSelect")}}),t=c("ul",{className:"domainBoxSelect",value:e.env.aliasesDomains[0],childNodes:e.env.aliasesDomains.map(f.createLiElement),onclick:function(B){var A,C;if(!B){B=window.event}if(B.srcElement){A=B.srcElement}else{if(B.target){A=B.target}}C=A.innerHTML;u=C;if(v.value!=C){r.removeClass()}v.value=C;v.onclick()}}),c("div",{className:"error-message",childNodes:i("Podaj prawidłowy adres e-mail.")}),c("div",{className:"alias-taken-message",childNodes:i("Nazwa konta jest zajęta. Spróbuj innej.")}),c("div",{className:"alias-limit-exceeded",childNodes:[i("Nie można dodać więcej niż 5 adresów dodatkowych - "),c("a",{href:"https://ustawienia.interia.pl/poczta/konta-zewnetrzne",childNodes:i("zarządzaj listą adresów")})]}),c("div",{className:"alias-valid-message",childNodes:i("Proponowana nazwa jest wolna.")})]}),x=c("div",{className:"aliasConfirmBtn",innerHTML:i("Sprawdź dostępność"),onclick:function(){r.removeClass();r.onBeforeAccept(1);_gaq.push(["b._trackEvent","Aliasy",g,'Sprawdź dostępność - "'+u+'"']);return false}}),q=c("div",{className:"aliasChamgeEmailBtn",innerHTML:i("Zmień adres e-mail"),onclick:function(){r.removeClass();r.onBeforeAccept(2);_gaq.push(["b._trackEvent","Aliasy",g,'Zmień adres e-mail - "'+u+'"']);return false}}),c("a",{className:"alliasCloseLink",href:"#close-layer",onclick:function(){r.hide();_gaq.push(["b._trackEvent","Aliasy",g,"Przejdź do poczty"]);return false}}),c("a",{onclick:function(){_gaq.push(["b._trackEvent","Aliasy",g,"Dowiedz się więcej"])},className:"alliasMoreLink",href:"http://info.poczta.interia.pl/pomoc/artykuly,2001307"})],onBeforeAccept:function(B){var A=s.value,C=v.value;if(!f.validateAlias(A)){h.addClass(y,"error error-validation");return false}else{if(B==1){o(A,C,r,function(){h.addClass(y,"error error-alias-taken")},function(){h.addClass(y,"error error-alias-limit-exceeded")})}else{a(A,C,r,function(){var D=A+"@"+C;m.set("defaultAccount",D,true);e.env.aliases.push({emailAddress:D,displayName:A})},function(){h.addClass(y,"error error-alias-taken")},function(){h.addClass(y,"error error-alias-limit-exceeded");_gaq.push(["b._trackEvent","Aliasy",g,"zarządzaj listą adresów - wyświetlenie"])})}}return false},createButtons:function(){return[]},removeClass:function(){h.removeClass(y,"error");h.removeClass(y,"error-alias-taken");h.removeClass(y,"error-alias-limit-exceeded");h.removeClass(y,"error-validation");h.removeClass(y,"valid-ok");h.removeClass(x,"hideButton");h.removeClass(q,"showButton");return true}});e.Prefs.set("aliasWelcomePageSeen",w,true);if(window.location.host.indexOf(".mailv1.")!==-1){e.Tools.setCookie("aliasPromotion","0",-1,".bauermedia.group")}else{e.Tools.setCookie("aliasPromotion","0",-1,".poczta.interia.pl")}_gaq.push(["b._trackEvent","Aliasy",g,"Wyświetlenie"])}}}());(function(){var a=Inpl.Mail;a.Addons=a.Addons||{};function b(c){if(typeof c==="object"&&c.hasOwnProperty("dingCounterValue")){a.UI.WindowTitle.setDingCount(c.dingCounterValue)}}a.Addons.DingIntegration={isObserving:false,observeCounter:function(){if(Inpl.widgets&&Inpl.widgets.manager&&typeof Inpl.widgets.manager.addDingObserver==="function"){Inpl.widgets.manager.addDingObserver(b);this.isObserving=true}return this.isObserving},unobserveCounter:function(){if(Inpl.widgets&&Inpl.widgets.manager&&typeof Inpl.widgets.manager.removeObserver==="function"){Inpl.widgets.manager.removeObserver(b);this.isObserving=false}return this.isObserving},init:function(){this.observeCounter()},uninit:function(){this.unobserveCounter()}}}());var barcode=function(){var b={settings:{barWidth:1,barHeight:22,moduleSize:5,showHRI:!1,addQuietZone:!0,marginHRI:5,bgColor:"#FFFFFF",color:"#000000",fontSize:10,posX:0,posY:0},intval:function(d){var c=typeof d;return"string"==c?(d=d.replace(/[^0-9-.]/g,""),d=parseInt(1*d,10),isNaN(d)||!isFinite(d)?0:d):"number"==c&&isFinite(d)?Math.floor(d):0},code128:{encoding:["11011001100","11001101100","11001100110","10010011000","10010001100","10001001100","10011001000","10011000100","10001100100","11001001000","11001000100","11000100100","10110011100","10011011100","10011001110","10111001100","10011101100","10011100110","11001110010","11001011100","11001001110","11011100100","11001110100","11101101110","11101001100","11100101100","11100100110","11101100100","11100110100","11100110010","11011011000","11011000110","11000110110","10100011000","10001011000","10001000110","10110001000","10001101000","10001100010","11010001000","11000101000","11000100010","10110111000","10110001110","10001101110","10111011000","10111000110","10001110110","11101110110","11010001110","11000101110","11011101000","11011100010","11011101110","11101011000","11101000110","11100010110","11101101000","11101100010","11100011010","11101111010","11001000010","11110001010","10100110000","10100001100","10010110000","10010000110","10000101100","10000100110","10110010000","10110000100","10011010000","10011000010","10000110100","10000110010","11000010010","11001010000","11110111010","11000010100","10001111010","10100111100","10010111100","10010011110","10111100100","10011110100","10011110010","11110100100","11110010100","11110010010","11011011110","11011110110","11110110110","10101111000","10100011110","10001011110","10111101000","10111100010","11110101000","11110100010","10111011110","10111101110","11101011110","11110101110","11010000100","11010010000","11010011100","11000111010"],getDigit:function(q){var j=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",e="",h=0,p=0,m=0,f=0,u=0;for(m=0;m<q.length;m++){if(-1==j.indexOf(q.charAt(m))){return""}}var k=q.length>1,l="";for(m=0;3>m&&m<q.length;m++){l=q.charAt(m),k&=l>="0"&&"9">=l}for(h=k?105:104,e=this.encoding[h],m=0;m<q.length;){if(k){(m==q.length||q.charAt(m)<"0"||q.charAt(m)>"9"||q.charAt(m+1)<"0"||q.charAt(m+1)>"9")&&(k=!1,e+=this.encoding[100],h+=100*++p)}else{for(f=0;m+f<q.length&&q.charAt(m+f)>="0"&&q.charAt(m+f)<="9";){f++}k=f>5||m+f-1==q.length&&f>3,k&&(e+=this.encoding[99],h+=99*++p)}k?(u=b.intval(q.charAt(m)+q.charAt(m+1)),m+=2):(u=j.indexOf(q.charAt(m)),m+=1),e+=this.encoding[u],h+=++p*u}return e+=this.encoding[h%103],e+=this.encoding[106],e+="11"}},bitStringTo2DArray:function(f){var d=[];d[0]=[];for(var c=0;c<f.length;c++){d[0][c]=f.charAt(c)}return d},digitToCssRenderer:function(z,G,q,j,m,D,B){for(var k,H,x,A=q.length,w=q[0].length,y="",p="<div class='w w%s' ></div>",F="<div class='b b%s' ></div>",C=0;A>C;C++){for(k=0,H=q[C][0],x=0;w>x;x++){H==q[C][x]?k++:(y+=("0"==H?p:F).replace("%s",k*m),H=q[C][x],k=1)}k>0&&(y+=("0"==H?p:F).replace("%s",k*m))}G.showHRI&&(y+='<div style="clear:both; width: 100%; background-color: '+G.bgColor+"; color: "+G.color+"; text-align: center; font-size: "+G.fontSize+"px; margin-top: "+G.marginHRI+'px;">'+j+"</div>");var E=document.createElement("DIV");return E.innerHTML=y,E.className="barcode "+B+" clearfix-child",E},digitToCss:function(f,e,g,k,d){var j=b.intval(e.barWidth),h=b.intval(e.barHeight);return this.digitToCssRenderer(f,e,this.bitStringTo2DArray(g),k,j,h,d)}},a=function(v,k,e){var j="",u="",q="",f=!0,w=!1,m=!1;if("string"==typeof v?q=v:"object"==typeof v&&(q="string"==typeof v.code?v.code:"",f="undefined"!=typeof v.crc?v.crc:!0,w="undefined"!=typeof v.rect?v.rect:!1),""==q){return !1}"undefined"==typeof e&&(e=[]);for(var p in b.settings){void 0==e[p]&&(e[p]=b.settings[p])}switch(k){case"std25":case"int25":j=b.i25.getDigit(q,f,k),u=b.i25.compute(q,f,k);break;case"ean8":case"ean13":j=b.ean.getDigit(q,k),u=b.ean.compute(q,k);break;case"upc":j=b.upc.getDigit(q),u=b.upc.compute(q);break;case"code11":j=b.code11.getDigit(q),u=q;break;case"code39":j=b.code39.getDigit(q),u=q;break;case"code93":j=b.code93.getDigit(q,f),u=q;break;case"code128":j=b.code128.getDigit(q),u=q;break;case"codabar":j=b.codabar.getDigit(q),u=q;break;case"msi":j=b.msi.getDigit(q,f),u=b.msi.compute(q,f);break;case"datamatrix":j=b.datamatrix.getDigit(q,w),u=q,m=!0}if(0==j.length){return this}!m&&e.addQuietZone&&(j="0000000000"+j+"0000000000");var l="digitToCss"+(m?"2D":"");return b[l](this,e,j,u,k)};return a}();Inpl.Mail.promotions=(function(){var b=Inpl.Mail,e=b.DOM,d=e.createElement,a=new Gettext({domain:"inpl_mail_msglist",locale_data:b.L10n}),c=function(f){return a.gettext(f)};return{bubble:{quickFilters:function(f){return(new b.UI.Bubble({content:d("div",{innerHTML:"Zaznacz aby wiadomości od tego nadawcy były automatycznie przenoszone do wybranego folderu<br><a href='http://info.poczta.interia.pl/pomoc/artykuly,1907390' target='_blank'>Dowiedz się więcej »</a></div>"}),ownerElement:document.body,prefName:"qfMoveDialogBubbleCnt",hideCheckbox:true})).open(f,"right",false)},quicFiltersSender:function(f){return(new b.UI.Bubble({content:d("div",{innerHTML:"Zbieraj wiadomości od tego nadawcy w jednym miejscu i miej do nich łatwy dostęp.<br><a href='http://info.poczta.interia.pl/pomoc/artykuly,1907390' target='_blank'>Dowiedz się więcej »</a></div>"}),ownerElement:mainSec,prefName:"qfHeaderBubbleCnt",hideCheckbox:true})).open(f,"left",true)},premiumAccount:function(){var f=(new Inpl.Mail.UI.Bubble({content:d("div",{style:{width:"300px"},childNodes:[Inpl.Mail.User.getPremiumEndDate()+" wygaśnie usługa poczty bez reklam.",d("br"),d("a",{target:"_blank",href:"https://ustawienia.interia.pl/poczta/bez-reklam",childNodes:"Przedłuż abonament już teraz!",onclick:function(){}})]}),ownerElement:document.body,hideCheckbox:true})).open(document.querySelector(".uAmail"),"top-right",null,true);Inpl.Mail.Tools.setCookie("isPremiumCloseToExpiry",true,1);return f},freeAccount:function(){return(new Inpl.Mail.UI.Bubble({content:d("div",{style:{width:"180px"},childNodes:["Poczta Premium! ",d("a",{target:"_blank",href:"https://ustawienia.interia.pl/poczta/bez-reklam",childNodes:"Sprawdź »",onclick:function(){_gaq.push(["b._trackEvent","Monetyzacja","Dymek","Sprawdź"])}})]}),onAfterClose:function(){_gaq.push(["b._trackEvent","Monetyzacja","Dymek","zamknij X"])},ownerElement:document.body,prefName:"buyPremiumAccountBubbleCnt",hideCheckbox:true})).open(document.querySelector(".uAmail"),"top-right")},},board:{premium:function(){var g,f=document.createDocumentFragment();[d("a",{className:"premiumWelcomeClose",href:"#close-layer",onclick:function(){g.hide();_gaq.push(["b._trackEvent","Poczta bez reklam -plansza -monetyzacja","klik w X"]);return false}}),d("a",{className:"premiumGoButton",href:"https://ustawienia.interia.pl/poczta/bez-reklam/#utm_source=poczta&utm_medium=plansza&utm_campaign=Monetyzacja_poczta_bez_reklam",onclick:function(){g.hide();_gaq.push(["b._trackEvent","Poczta bez reklam -plansza -monetyzacja","sprawdź"])}}),d("a",{className:"premiumCloseButton",href:"#close-layer",onclick:function(){g.hide();_gaq.push(["b._trackEvent","Poczta bez reklam -plansza -monetyzacja","przejdź do poczty"]);return false}})].forEach(function(h){f.appendChild(h)});g=b.UI.ModalDialogs.createModalDialog({message:f,additionalClass:"newFeaturesAdv premiumWelcomePage",title:null,hideButtons:true});g.enqueue();_gaq.push(["b._trackEvent","Poczta bez reklam -plansza -monetyzacja","wyświetlenie planszy"]);b.Prefs.set("premiumWelcomePageSeen",true,true)},premiumVersion2A:function(){var g,f=document.createDocumentFragment();[d("a",{className:"premiumWelcomeClose",href:"#close-layer",onclick:function(){g.hide();_gaq.push(["b._trackEvent","Poczta bez reklam -plansza NOWA A -monetyzacja","klik w X"]);return false}}),d("a",{className:"premiumGoButton",href:"https://ustawienia.interia.pl/poczta/bez-reklam/#utm_source=poczta&utm_medium=plansza_A&utm_campaign=Monetyzacja_poczta_bez_reklam",onclick:function(){g.hide();_gaq.push(["b._trackEvent","Poczta bez reklam -plansza NOWA A -monetyzacja","sprawdź"])}}),d("a",{className:"premiumCloseButton",href:"#close-layer",onclick:function(){g.hide();_gaq.push(["b._trackEvent","Poczta bez reklam -plansza NOWA A -monetyzacja","przejdź do poczty"]);return false}})].forEach(function(h){f.appendChild(h)});g=b.UI.ModalDialogs.createModalDialog({message:f,additionalClass:"newFeaturesAdv premiumWelcomePageV2 typeA",title:null,hideButtons:true});g.enqueue();_gaq.push(["b._trackEvent","Poczta bez reklam -plansza NOWA A -monetyzacja","wyświetlenie planszy"]);b.Prefs.set("premiumWelcomePageSeenV2",1,true)},premiumVersion2B:function(){var g,f=document.createDocumentFragment();[d("a",{className:"premiumWelcomeClose",href:"#close-layer",onclick:function(){g.hide();_gaq.push(["b._trackEvent","Poczta bez reklam -plansza NOWA B -monetyzacja","klik w X"]);return false}}),d("a",{className:"premiumGoButton",href:"https://ustawienia.interia.pl/poczta/bez-reklam/#utm_source=poczta&utm_medium=plansza_B&utm_campaign=Monetyzacja_poczta_bez_reklam",onclick:function(){g.hide();_gaq.push(["b._trackEvent","Poczta bez reklam -plansza NOWA B -monetyzacja","sprawdź"])}}),d("a",{className:"premiumCloseButton",href:"#close-layer",onclick:function(){g.hide();_gaq.push(["b._trackEvent","Poczta bez reklam -plansza NOWA B -monetyzacja","przejdź do poczty"]);return false}})].forEach(function(h){f.appendChild(h)});g=b.UI.ModalDialogs.createModalDialog({message:f,additionalClass:"newFeaturesAdv premiumWelcomePageV2 typeB",title:null,hideButtons:true});g.enqueue();_gaq.push(["b._trackEvent","Poczta bez reklam -plansza -monetyzacja","wyświetlenie planszy"]);b.Prefs.set("premiumWelcomePageSeenV2",2,true)},nextPromotion:function(f){return function(){var h;var g=document.createDocumentFragment();[d("a",{className:"next-promotion-item next-promotion-item--close",href:"#close-layer",onclick:function(){iwa("trackEvent","Kampania_next_op2","plansza","klik_x_(zamkniecie_planszy)");h.hide();return false}}),d("a",{className:"next-promotion-item next-promotion-item--switch",href:"http://interia.hit.gemius.pl/hitredir/id="+(f===1?"AkhKT67MzzGJvAzcu2uX7rdNP6Jkg27GKWgavAxzxMj.J7":"nAhKsQgQz_gugw1sZuKXRuVDfcCRDocibk_Y5Kn279z.y7")+"/url=https%3A%2F%2Fpoczta.interia.pl%2Fnext%2F"}),d("a",{className:"next-promotion-item next-promotion-item--learn-more",href:"http://interia.hit.gemius.pl/hitredir/id="+(f===1?"AfHldq7qCQzDVBqcag_RR3YZ355Zaa8ZPfREBw7QFDz.Y7":"nF3rsggCZDqOEjLFLfjVM8QMP_hWZ29q_XyUm9.zxL7.67")+"/url=http%3A%2F%2Finfo.poczta.interia.pl%2F%23landing"}),d("a",{className:"next-promotion-item next-promotion-item--ommit",href:"#close-layer",onclick:function(){iwa("trackEvent","Kampania_next_op2","plansza","klik_przejdz_do_poczty");h.hide();return false}})].forEach(function(i){g.appendChild(i)});h=b.UI.ModalDialogs.createModalDialog({message:g,additionalClass:"next-promotion next-promotion--"+(f===1?"a":"b"),title:null,hideButtons:true});h.enqueue();b.Prefs.set("nextPromotionDialogSeen",f,true)}},mobilePromotion:function(){var g,f=document.createDocumentFragment();[d("a",{className:"offerInfoClose",href:"#close-layer",onclick:function(){g.hide();return false}})].forEach(function(h){f.appendChild(h)});g=b.UI.ModalDialogs.createModalDialog({message:f,additionalClass:"newFeaturesAdv mobilePromo",title:null,hideButtons:true});g.enqueue();iwa("trackEvent","Send_to_mobile","Plansza4","view");b.Network.ajax({url:"/html/infoBoard",post:{id:7,state:1,sValue:1},onSuccess:function(){},headers:{"X-HTTP-Method-Override":"PUT","X-XSRF-TOKEN":b.env.uid}})},},message_list_stripe:{social:function(){return d("div",{className:"msglist-notice hide-on-social-disabled",innerHTML:"Na Waszą prośbę dodaliśmy Youtube, Google + i wiele innych serwisów do folderu Społeczności <a href='http://info.poczta.interia.pl/pomoc/artykuly,1968293,do-czego-sluza-foldery-zakupy-i-spolecznosci' target='_blank'>dowiedz się więcej</a> - ",childNodes:[d("a",{href:"#",innerHTML:"Wyłącz filtr",onclick:function(){b.Views.disableView(b.Views.ViewTypes.SOCIAL);_gaq.push(["b._trackEvent","Powiadomienia","Wyłącz filtr","z poziomu folderu(pasek)"])}})]})},premium_account:function(){var g=false,f=null;if(localStorage&&localStorage.getItem("isPremiumExpiryBarHidden")==="yes"){g=true}f=d("div",{className:"views-bar msglist-notice"+(g?" views-bar-hidden":""),childNodes:[d("span",{innerHTML:b.User.getPremiumEndDate()+" wygaśnie usługa poczty bez reklam - "}),d("a",{href:"https://ustawienia.interia.pl/poczta/bez-reklam",innerHTML:c("przedłuż abonament już teraz!"),onclick:function(){}}),d("div",{className:"msglist-notice-hide",onclick:function(h){h=h||event;if(localStorage){localStorage.setItem("isPremiumExpiryBarHidden","yes")}e.addClass(f,"views-bar-hidden");e.stopPropagation(h)}}),d("div",{className:"msglist-notice-show"})],onclick:function(){if(e.hasClass(f,"views-bar-hidden")){if(localStorage){localStorage.setItem("isPremiumExpiryBarHidden","no")}e.removeClass(f,"views-bar-hidden");return true}}});return f},free_account:function(){var g=false,f=null;if(localStorage&&localStorage.getItem("isFreeAccountBarHidden")==="yes"){g=true}f=d("div",{className:"views-bar msglist-notice"+(g?" views-bar-hidden":""),childNodes:[d("span",{innerHTML:"Włącz pocztę bez reklam! "}),d("a",{href:"https://ustawienia.interia.pl/poczta/bez-reklam",innerHTML:c("Dowiedz się więcej")+" &raquo;",onclick:function(){_gaq.push(["b._trackEvent","Monetyzacja","Pasek żółty","Dowiedz się więcej"])}}),d("div",{className:"msglist-notice-hide",onclick:function(h){h=h||event;if(localStorage){localStorage.setItem("isFreeAccountBarHidden","yes")}e.addClass(f,"views-bar-hidden");e.stopPropagation(h);_gaq.push(["b._trackEvent","Monetyzacja","Pasek żółty","zamknij X"])}}),d("div",{className:"msglist-notice-show"})],onclick:function(){if(e.hasClass(f,"views-bar-hidden")){if(localStorage){localStorage.setItem("isFreeAccountBarHidden","no")}e.removeClass(f,"views-bar-hidden");return true}}});return f},spam:function(f){return d("div",{className:"spamInfo msglist-notice",innerHTML:(f===-2)?c("Wiadomości z folderu spam są automatycznie usuwane po 30 dniach"):c("Wiadomości z folderu kosz są automatycznie usuwane po 30 dniach")})},search:function(f){return d("div",{className:"msglist-notice",childNodes:[d("a",{innerHTML:c("Rozszerz wyniki wyszukiwania, szukając również w treści wiadomości"),href:"#",onclick:f})]})},migrate_to_next:function(){return d("div",{className:"msglist-notice",childNodes:[d("span",{innerHTML:"Całkiem nowa poczta Interii – szybka i nowoczesna "}),d("a",{innerHTML:c("Sprawdź &raquo;"),href:"/next/"})]})},next_promotion:function(){return d("div",{className:"msglist-notice",childNodes:[d("span",{className:"",innerHTML:""}),d("a",{innerHTML:c("Nowa poczta dopasuje się do Ciebie - sprawdź! &raquo;"),href:"https://poczta.interia.pl/next/#/folder/1?board=210"})]})},move_to_premium:function(){return d("div",{className:"msglist-notice",childNodes:[d("span",{className:"",innerHTML:""}),d("a",{innerHTML:c("Posprzątaj pocztę &raquo;"),href:"https://ustawienia.interia.pl/poczta/bez-reklam/?utm_source=poczta_html&utm_medium=zolta_belka&utm_campaign=posprzataj_poczte"})]})}},boards:{}}}());(function(){var f=Inpl.Mail,g=f.DOM,d=g.createElement,j=f.UI.ModalDialogs,c=new Gettext({domain:"inpl_mail_datasecurity",locale_data:f.L10n}),h=function(m){return c.gettext(m)},a,e,k,l,b,i;a=function(n,m){f.Network.ajaxApi({url:k+"/v1/personalData/update?uid="+f.Tools.getUid(),post:{newMail:m,mobilePhone:n},callback:function(o){if(o.status==1){f.UI.showNotice("Dane zostały zapisane","");i.hide()}else{f.UI.showNotice(o.msg,"error")}}})};e=function(m,n){f.Network.ajaxApi({url:k+"/v1/personalData/read?uid="+f.Tools.getUid(),callback:function(o){m.value=o.data.mobilePhone;n.value=o.data.recoveryMail}})};l=function(m){if(m.length==9){return/^\d+$/.test(m)}return false};b=function(m){var n=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return n.test(m)};f.dataSecurity={showdialog:function(){if(Inpl.Mail.browser.ie<=9&&Inpl.Mail.browser.ie!=0){return 0}var m,n,o,q,p;k=Inpl.Mail.env.pocztaApiUrl;i=j.confirm({title:h("Poniższe opcje pomogą Ci w odzyskaniu dostępu do konta w sytuacji gdy zapomnisz hasła"),additionalClass:"no-icon-md data-security-md",message:[d("p",{childNodes:h("Sprawdź czy dane są aktualne i prawidłowe:")}),m=d("div",{id:"tel-input-container",childNodes:[d("label",{innerHTML:"Numer telefonu:"}),n=d("input",{type:"text"}),]}),o=d("div",{id:"mail-input-container",childNodes:[d("label",{innerHTML:"Alternatywny adres e-mail:"}),q=d("input",{type:"text"}),]})],onBeforeAccept:function(){var t=n.value,s=q.value,r=0;if(t.length){r++}if(s.length){r++}if(!r){f.UI.showNotice("Wypełnij przynajmniej jedno pole","error");return false}else{if(t.length&&!l(t)){f.UI.showNotice("Błędny format telefonu","error");return false}if(s.length&&!b(s)){f.UI.showNotice("Błędny format adresu e-mail","error");return false}}a(t,s);f.Tools.hitGemius(".WzqwWthvyb5eTgYCPnxd5QJfQWGW4ewsyB4nf09g4T.I7");return false},onCancel:function(){f.Tools.hitGemius("nS1K33u_zvDfisi6OR1BWoXyPzMpZ298pNka2dI.mLT.z7");return true},acceptLabel:h("Zapisz i przejdź do poczty"),cancelLabel:h("Uzupełnię później")});e(n,q);f.Network.ajax({url:"/html/infoBoard",post:{id:601,state:1,sValue:1},onSuccess:function(){},headers:{"X-HTTP-Method-Override":"PUT","X-XSRF-TOKEN":f.env.uid}});f.Tools.hitGemius("B7zgveNI4w4u1fEmDBqd7IXyHPwpZ8e.Df5o2IcmqvT.C7")}}}());(function(){var a=Inpl.Mail,e=a.DOM,c=e.createElement,b=a.UI.ModalDialogs,d=a.Prefs;a.premiumInfo={showdialog:function(){var k,m,n,j,g,f=a.env.premiumEmailData.toEnd,l=Inpl.Mail.env.ownEmail,i=a.env.premiumEmailData.formatEndDate.date,h=a.env.premiumEmailData.formatEndDate.hour;g=b.alert({title:"Szanowny użytkowniku!",additionalClass:"premium-info-md",message:[c("div",{innerHTML:'<p>Za <span class="premium-info-day">'+f+" dni</span> Twoje konto Premium "+l+' wygaśnie!</p><p><span class="premium-info-date">'+i+" o godz. "+h+"</span> stracisz możliwość korzystania z Usług Poczty Premium. Nie zwlekaj, przedłuż swoje konto już teraz.</p><p>Koszt to tylko 1zł + VAT miesięcznie (przy zakupie na 12 miesięcy).</p>"}),c("a",{className:"adNavLinkButton",innerHTML:'Przedłuż konto <span class="adNavRaquo"> »</span>',target:"_blank",href:"https://ustawienia.interia.pl/poczta/bez-reklam",onclick:function(){_gaq.push(["b._trackEvent","Poczta bez reklam  -plansza –konta premium","zamów"]);g.hide()}}),c("a",{className:"premium-info-close",href:"#",onclick:function(){_gaq.push(["b._trackEvent","Poczta bez reklam  -plansza –konta premium","klik w X"]);g.hide()}})]});a.Network.ajax({url:"/html/infoBoard",post:{id:201,state:1,sValue:1},onSuccess:function(){},headers:{"X-HTTP-Method-Override":"PUT","X-XSRF-TOKEN":a.env.uid}});_gaq.push(["b._trackEvent","Poczta bez reklam  -plansza –konta premium","wyświetlenie planszy"])}}}());(function(){var a=Inpl.Mail,f=a.DOM,e=f.createElement,d=a.UI.ModalDialogs,c;var b=function(g){var h=Inpl.Mail.env.pocztaApiUrl;a.Network.ajaxApi({url:h+"/v1/marketingData/updateAdultAgreement?uid="+a.Tools.getUid(),post:{adultAgreement:g},callback:function(i){if(i.status==1){a.UI.showNotice("Dane zostały zapisane","");a.Network.ajax({url:"/html/infoBoard",post:{id:203,state:1,svalue:1},onSuccess:function(){c.hide()},headers:{"X-HTTP-Method-Override":"PUT","X-XSRF-TOKEN":a.env.uid}})}else{a.UI.showNotice(i.msg,"error")}}})};a.adultPermission={showdialog:function(){if(Inpl.Mail.browser.ie<=9&&Inpl.Mail.browser.ie!=0){return 0}c=d.alert({title:"Zgoda na treści dla pełnoletnich",additionalClass:"adult-permission-md",message:[e("div",{className:"content",innerHTML:"Drogi Użytkowniku,<br><br>Na Twoim koncie brakuje informacji o zgodzie na materiały dla osób pełnoletnich (dotyczących napojów alkoholowych lub gier hazardowych).Zależy nam na Twoim wyborze, ponieważ chcemy mieć pewność że wysyłamy wiadomości dopasowane do Twoich potrzeb. <b>Ilość informacji handlowych wysyłanych na Twoje konto pocztowe nie ulegnie zmianie niezależnie od tego czy udzielisz zgody.</b><br><br>Czy wyrażasz zgodę na otrzymywanie materiałów dla osób pełnoletnich?"}),e("div",{className:"option-content",childNodes:[e("label",{innerHTML:"TAK",childNodes:[e("input",{type:"checkbox",value:"1",id:"check_yes",onchange:function(){if(this.checked){document.getElementById("check_no").checked=false}}})]}),e("label",{innerHTML:"NIE",childNodes:[e("input",{type:"checkbox",value:"0",id:"check_no",onchange:function(){if(this.checked){document.getElementById("check_yes").checked=false}}})]})]}),e("a",{className:"adNavLinkButton",innerHTML:'Zapisz <span class="adNavRaquo"> »</span>',onclick:function(){var h=document.getElementById("check_yes").checked,g=document.getElementById("check_no").checked,i;if(h||g){if(h){i=1;iwa("trackEvent","Plansza","Oferty","Pelnoletni","klik","tak")}else{if(g){i=0;iwa("trackEvent","Plansza","Oferty","Pelnoletni","klik","nie")}}b(i)}else{a.UI.showNotice("Zaznacz jedną z opcji.","error")}}})]});iwa("trackEvent","Plansza","Oferty","Pelnoletni","view","-")}}}());